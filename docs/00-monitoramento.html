<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="pt-BR" xml:lang="pt-BR"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-0.9.468">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Números da Lei de Acesso a Informação no Brasil</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>
<style>html{ scroll-behavior: smooth; }</style>
<script async="" src="https://hypothes.is/embed.js"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
<script src="0-monitoramento_files\libs\clipboard\clipboard.min.js"></script><script src="0-monitoramento_files\libs\quarto-html\quarto.js"></script><script src="0-monitoramento_files\libs\quarto-html\popper.min.js"></script><script src="0-monitoramento_files\libs\quarto-html\tippy.umd.min.js"></script><script src="0-monitoramento_files\libs\quarto-html\anchor.min.js"></script><link href="0-monitoramento_files\libs\quarto-html\tippy.css" rel="stylesheet"><link href="0-monitoramento_files\libs\quarto-html\quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><script src="0-monitoramento_files\libs\bootstrap\bootstrap.min.js"></script><link href="0-monitoramento_files\libs\bootstrap\bootstrap-icons.css" rel="stylesheet"><link href="0-monitoramento_files\libs\bootstrap\bootstrap.min.css" rel="stylesheet"></head>
<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc"><h2 id="toc-title">Índice</h2>
   
  <ul>
<li><a href="#total-de-manifesta%C3%A7%C3%B5es-registradas-no-falabr-2012-2022" id="toc-total-de-manifestações-registradas-no-falabr-2012-2022" class="nav-link active" data-scroll-target="#total-de-manifesta%C3%A7%C3%B5es-registradas-no-falabr-2012-2022">Total de manifestações registradas no FalaBr (2012-2022)</a></li>
  <li><a href="#n%C3%BAmero-de-%C3%B3rg%C3%A3os-do-governo-federal-acionados-pela-lai-2012-2022" id="toc-número-de-órgãos-do-governo-federal-acionados-pela-lai-2012-2022" class="nav-link" data-scroll-target="#n%C3%BAmero-de-%C3%B3rg%C3%A3os-do-governo-federal-acionados-pela-lai-2012-2022">Número de órgãos do governo Federal acionados pela LAI (2012-2022)</a></li>
  <li>
<a href="#taxa-de-atendimento-de-pedidos-de-acesso-a-informa%C3%A7%C3%A3o-2012-2022" id="toc-taxa-de-atendimento-de-pedidos-de-acesso-a-informação-2012-2022" class="nav-link" data-scroll-target="#taxa-de-atendimento-de-pedidos-de-acesso-a-informa%C3%A7%C3%A3o-2012-2022">Taxa de atendimento de pedidos de acesso a informação (2012-2022)</a>
  <ul class="collapse">
<li><a href="#taxa-de-acessos-concedidos" id="toc-taxa-de-acessos-concedidos" class="nav-link" data-scroll-target="#taxa-de-acessos-concedidos">Taxa de Acessos Concedidos</a></li>
  <li><a href="#taxa-de-acessos-negados" id="toc-taxa-de-acessos-negados" class="nav-link" data-scroll-target="#taxa-de-acessos-negados">Taxa de Acessos Negados</a></li>
  <li><a href="#taxa-de-acessos-parcialmente-concedido" id="toc-taxa-de-acessos-parcialmente-concedido" class="nav-link" data-scroll-target="#taxa-de-acessos-parcialmente-concedido">Taxa de Acessos Parcialmente Concedido</a></li>
  <li><a href="#taxa-para-a-decis%C3%A3o-%C3%B3rg%C3%A3o-n%C3%A3o-tem-compet%C3%AAncia-para-responder-sobre-o-assunto" id="toc-taxa-para-a-decisão-órgão-não-tem-competência-para-responder-sobre-o-assunto" class="nav-link" data-scroll-target="#taxa-para-a-decis%C3%A3o-%C3%B3rg%C3%A3o-n%C3%A3o-tem-compet%C3%AAncia-para-responder-sobre-o-assunto">Taxa para a decisão “Órgão não tem competência para responder sobre o assunto”</a></li>
  <li><a href="#taxa-de-resposta-de-informa%C3%A7%C3%A3o-inexistente" id="toc-taxa-de-resposta-de-informação-inexistente" class="nav-link" data-scroll-target="#taxa-de-resposta-de-informa%C3%A7%C3%A3o-inexistente">Taxa de resposta de “Informação Inexistente”</a></li>
  </ul>
</li>
  <li><a href="#taxas-de-respostas-por-decis%C3%A3o-de-acesso---mesmo-per%C3%ADodo---2012-2022" id="toc-taxas-de-respostas-por-decisão-de-acesso---mesmo-período---2012-2022" class="nav-link" data-scroll-target="#taxas-de-respostas-por-decis%C3%A3o-de-acesso---mesmo-per%C3%ADodo---2012-2022">Taxas de respostas por decisão de acesso - mesmo período - (2012-2022)</a></li>
  <li>
<a href="#negativas-de-acesso" id="toc-negativas-de-acesso" class="nav-link" data-scroll-target="#negativas-de-acesso">Negativas de acesso</a>
  <ul class="collapse">
<li><a href="#metodologia-taxa-geral-e-interna-de-acessos-negados" id="toc-metodologia-taxa-geral-e-interna-de-acessos-negados" class="nav-link" data-scroll-target="#metodologia-taxa-geral-e-interna-de-acessos-negados">Metodologia (taxa geral e interna de acessos negados)</a></li>
  <li><a href="#%C3%B3rg%C3%A3os-que-mais-negaram-informa%C3%A7%C3%B5es---m%C3%AAs-a-m%C3%AAs-2012-2022" id="toc-órgãos-que-mais-negaram-informações---mês-a-mês-2012-2022" class="nav-link" data-scroll-target="#%C3%B3rg%C3%A3os-que-mais-negaram-informa%C3%A7%C3%B5es---m%C3%AAs-a-m%C3%AAs-2012-2022">Órgãos que mais negaram informações - mês a mês (2012-2022)</a></li>
  <li><a href="#poucos-%C3%B3rg%C3%A3os-s%C3%A3o-respons%C3%A1veis-por-mais-da-metade-das-negativas-do-falabr" id="toc-poucos-órgãos-são-responsáveis-por-mais-da-metade-das-negativas-do-falabr" class="nav-link" data-scroll-target="#poucos-%C3%B3rg%C3%A3os-s%C3%A3o-respons%C3%A1veis-por-mais-da-metade-das-negativas-do-falabr">Poucos órgãos são responsáveis por mais da metade das negativas do FalaBr</a></li>
  <li><a href="#mediana-da-taxa-interna-de-acessos-negados-por-%C3%B3rg%C3%A3o-2012-2022" id="toc-mediana-da-taxa-interna-de-acessos-negados-por-órgão-2012-2022" class="nav-link" data-scroll-target="#mediana-da-taxa-interna-de-acessos-negados-por-%C3%B3rg%C3%A3o-2012-2022">Mediana da taxa interna de acessos negados por órgão (2012-2022)</a></li>
  <li><a href="#distribui%C3%A7%C3%A3o-das-taxas-internas-de-acessos-negados-por-%C3%B3rg%C3%A3o" id="toc-distribuição-das-taxas-internas-de-acessos-negados-por-órgão" class="nav-link" data-scroll-target="#distribui%C3%A7%C3%A3o-das-taxas-internas-de-acessos-negados-por-%C3%B3rg%C3%A3o">Distribuição das taxas internas de acessos negados por órgão</a></li>
  </ul>
</li>
  <li>
<a href="#tempo-de-resposta-dos-pedidos" id="toc-tempo-de-resposta-dos-pedidos" class="nav-link" data-scroll-target="#tempo-de-resposta-dos-pedidos">Tempo de resposta dos pedidos</a>
  <ul class="collapse">
<li><a href="#frequ%C3%AAncia-de-dias-corridos-para-resposta-%C3%A0-lai-2012-2022" id="toc-frequência-de-dias-corridos-para-resposta-à-lai-2012-2022" class="nav-link" data-scroll-target="#frequ%C3%AAncia-de-dias-corridos-para-resposta-%C3%A0-lai-2012-2022">Frequência de dias corridos para resposta à LAI (2012-2022)</a></li>
  <li><a href="#tempo-m%C3%A9dio-de-resposta-por-ano" id="toc-tempo-médio-de-resposta-por-ano" class="nav-link" data-scroll-target="#tempo-m%C3%A9dio-de-resposta-por-ano">Tempo médio de resposta por ano</a></li>
  </ul>
</li>
  <li>
<a href="#recursos" id="toc-recursos" class="nav-link" data-scroll-target="#recursos">Recursos</a>
  <ul class="collapse">
<li><a href="#de-pedidos-que-entraram-ou-n%C3%A3o-com-recurso" id="toc-de-pedidos-que-entraram-ou-não-com-recurso" class="nav-link" data-scroll-target="#de-pedidos-que-entraram-ou-n%C3%A3o-com-recurso">% de pedidos que entraram ou não com recurso</a></li>
  <li><a href="#total-de-pedidos-que-entraram-com-recurso" id="toc-total-de-pedidos-que-entraram-com-recurso" class="nav-link" data-scroll-target="#total-de-pedidos-que-entraram-com-recurso">Total de pedidos que entraram com recurso</a></li>
  <li><a href="#evolu%C3%A7%C3%A3o-do-de-recursos-impetrados-por-ano" id="toc-evolução-do-de-recursos-impetrados-por-ano" class="nav-link" data-scroll-target="#evolu%C3%A7%C3%A3o-do-de-recursos-impetrados-por-ano">Evolução do % de recursos impetrados por ano</a></li>
  <li><a href="#%C3%B3rg%C3%A3os-campe%C3%B5es-de-recursos-impetrados-2012---2022-15-primeiros" id="toc-órgãos-campeões-de-recursos-impetrados-2012---2022-15-primeiros" class="nav-link" data-scroll-target="#%C3%B3rg%C3%A3os-campe%C3%B5es-de-recursos-impetrados-2012---2022-15-primeiros">Órgãos campeões de recursos impetrados (2012 - 2022, 15 primeiros)</a></li>
  <li><a href="#tipo-de-resposta-dada-aos-recursos-em-primeira-inst%C3%A2ncia" id="toc-tipo-de-resposta-dada-aos-recursos-em-primeira-instância" class="nav-link" data-scroll-target="#tipo-de-resposta-dada-aos-recursos-em-primeira-inst%C3%A2ncia">Tipo de resposta dada aos recursos em primeira instância</a></li>
  <li><a href="#tipo-de-resposta-dada-aos-recursos-em-segunda-inst%C3%A2ncia" id="toc-tipo-de-resposta-dada-aos-recursos-em-segunda-instância" class="nav-link" data-scroll-target="#tipo-de-resposta-dada-aos-recursos-em-segunda-inst%C3%A2ncia">Tipo de resposta dada aos recursos em segunda instância</a></li>
  <li><a href="#tipo-de-resposta-dada-aos-recursos-para-a-cmri" id="toc-tipo-de-resposta-dada-aos-recursos-para-a-cmri" class="nav-link" data-scroll-target="#tipo-de-resposta-dada-aos-recursos-para-a-cmri">Tipo de resposta dada aos recursos para a CMRI</a></li>
  <li><a href="#tipo-de-resposta-dada-aos-recursos-para-a-cgu" id="toc-tipo-de-resposta-dada-aos-recursos-para-a-cgu" class="nav-link" data-scroll-target="#tipo-de-resposta-dada-aos-recursos-para-a-cgu">Tipo de resposta dada aos recursos para a CGU</a></li>
  </ul>
</li>
  </ul></nav>
</div>
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Números da Lei de Acesso a Informação no Brasil</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Código</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Mostrar o código</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Esconder o código</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">Ver o código fonte</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header><style>
.nav-tabs .nav-link {
    margin-bottom: -1px;
    background: none;
    border: 1px solid transparent;
    border-top-left-radius: .25rem;
    border-top-right-radius: .25rem;
    color: #fcaa27;
    font-size: 0.875em;
}

.nav-tabs .nav-link.active, .nav-tabs .nav-item.show .nav-link {
    color: #495057;
    background-color: #fff;
    border-color: #dee2e6 #dee2e6 #fff;
    color: #d81755;
    font-size: 1em;
}
</style>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="co">#&gt; ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.1 ──</span></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="co">#&gt; ✔ ggplot2 3.3.6     ✔ purrr   0.3.4</span></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="co">#&gt; ✔ tibble  3.1.8     ✔ dplyr   1.0.9</span></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="co">#&gt; ✔ tidyr   1.2.0     ✔ stringr 1.4.0</span></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="co">#&gt; ✔ readr   2.1.2     ✔ forcats 0.5.1</span></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="co">#&gt; Warning: package 'tibble' was built under R version 4.2.1</span></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="co">#&gt; ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──</span></span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="co">#&gt; ✖ dplyr::filter() masks stats::filter()</span></span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="co">#&gt; ✖ dplyr::lag()    masks stats::lag()</span></span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="fu">library</span>(here)</span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="co">#&gt; here() starts at C:/Users/rauld/Documents/monitoramento-lai</span></span>
<span id="cb1-13"><a href="#cb1-13"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb1-14"><a href="#cb1-14"></a><span class="co">#&gt; </span></span>
<span id="cb1-15"><a href="#cb1-15"></a><span class="co">#&gt; Attaching package: 'lubridate'</span></span>
<span id="cb1-16"><a href="#cb1-16"></a><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span id="cb1-17"><a href="#cb1-17"></a><span class="co">#&gt; </span></span>
<span id="cb1-18"><a href="#cb1-18"></a><span class="co">#&gt;     date, intersect, setdiff, union</span></span>
<span id="cb1-19"><a href="#cb1-19"></a><span class="fu">library</span>(scales)</span>
<span id="cb1-20"><a href="#cb1-20"></a><span class="co">#&gt; </span></span>
<span id="cb1-21"><a href="#cb1-21"></a><span class="co">#&gt; Attaching package: 'scales'</span></span>
<span id="cb1-22"><a href="#cb1-22"></a><span class="co">#&gt; The following object is masked from 'package:purrr':</span></span>
<span id="cb1-23"><a href="#cb1-23"></a><span class="co">#&gt; </span></span>
<span id="cb1-24"><a href="#cb1-24"></a><span class="co">#&gt;     discard</span></span>
<span id="cb1-25"><a href="#cb1-25"></a><span class="co">#&gt; The following object is masked from 'package:readr':</span></span>
<span id="cb1-26"><a href="#cb1-26"></a><span class="co">#&gt; </span></span>
<span id="cb1-27"><a href="#cb1-27"></a><span class="co">#&gt;     col_factor</span></span>
<span id="cb1-28"><a href="#cb1-28"></a><span class="fu">library</span>(hrbrthemes)</span>
<span id="cb1-29"><a href="#cb1-29"></a><span class="co">#&gt; </span><span class="al">NOTE</span><span class="co">: Either Arial Narrow or Roboto Condensed fonts are required to use these themes.</span></span>
<span id="cb1-30"><a href="#cb1-30"></a><span class="co">#&gt;       Please use hrbrthemes::import_roboto_condensed() to install Roboto Condensed and</span></span>
<span id="cb1-31"><a href="#cb1-31"></a><span class="co">#&gt;       if Arial Narrow is not on your system, please see https://bit.ly/arialnarrow</span></span>
<span id="cb1-32"><a href="#cb1-32"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb1-33"><a href="#cb1-33"></a><span class="fu">library</span>(glue)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># aplica identidade visual da TB/AeP:</span></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">"src/0-plot-aesthetics.R"</span>), <span class="at">encoding =</span> <span class="st">"UTF-8"</span>)</span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="co">#&gt; You will likely need to install these fonts on your system as well.</span></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="co">#&gt; </span></span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="co">#&gt; You can find them in [C:/Users/rauld/AppData/Local/R/win-library/4.2/hrbrthemes/fonts/roboto-condensed]</span></span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="co"># helper</span></span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="st">`</span><span class="at">%notin%</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) <span class="sc">!</span>(x <span class="sc">%in%</span> y)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>pedidos_cgu <span class="ot">&lt;-</span> <span class="st">"data/base-cgu.rds"</span> <span class="sc">%&gt;%</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>  <span class="fu">here</span>() <span class="sc">%&gt;%</span></span>
<span id="cb3-3"><a href="#cb3-3"></a>  <span class="fu">readRDS</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb3-4"><a href="#cb3-4"></a>  <span class="fu">filter</span>(base <span class="sc">==</span> <span class="st">"Pedidos"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb3-5"><a href="#cb3-5"></a>  <span class="fu">select</span>(datasets) <span class="sc">%&gt;%</span> </span>
<span id="cb3-6"><a href="#cb3-6"></a>  <span class="fu">unnest</span>(<span class="fu">c</span>(datasets)) <span class="sc">%&gt;%</span></span>
<span id="cb3-7"><a href="#cb3-7"></a>  <span class="fu">filter</span>(</span>
<span id="cb3-8"><a href="#cb3-8"></a>    <span class="sc">!</span><span class="fu">is.na</span>(decisao),</span>
<span id="cb3-9"><a href="#cb3-9"></a>    <span class="sc">!</span><span class="fu">is.na</span>(data_resposta),</span>
<span id="cb3-10"><a href="#cb3-10"></a>    esfera <span class="sc">==</span> <span class="st">"Federal"</span>,</span>
<span id="cb3-11"><a href="#cb3-11"></a>    <span class="sc">!</span><span class="fu">str_detect</span>(orgao, <span class="st">"refeitura|Órgão para Teste"</span>)</span>
<span id="cb3-12"><a href="#cb3-12"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb3-13"><a href="#cb3-13"></a>  <span class="fu">transmute</span>(</span>
<span id="cb3-14"><a href="#cb3-14"></a>    id_pedido,</span>
<span id="cb3-15"><a href="#cb3-15"></a>    <span class="at">mes_pedido =</span> data_registro,</span>
<span id="cb3-16"><a href="#cb3-16"></a>    <span class="at">mes_resposta =</span> data_resposta,</span>
<span id="cb3-17"><a href="#cb3-17"></a>    <span class="at">data_pedido =</span> <span class="fu">dmy</span>(ts_registro),</span>
<span id="cb3-18"><a href="#cb3-18"></a>    <span class="at">data_resposta =</span> <span class="fu">dmy</span>(ts_resposta),</span>
<span id="cb3-19"><a href="#cb3-19"></a>    <span class="at">prazo =</span> <span class="fu">dmy</span>(prazo),</span>
<span id="cb3-20"><a href="#cb3-20"></a>    decisao,</span>
<span id="cb3-21"><a href="#cb3-21"></a>    orgao</span>
<span id="cb3-22"><a href="#cb3-22"></a>  )</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>recursos_cgu <span class="ot">&lt;-</span> <span class="st">"data/base-cgu.rds"</span> <span class="sc">%&gt;%</span></span>
<span id="cb4-2"><a href="#cb4-2"></a>  <span class="fu">here</span>() <span class="sc">%&gt;%</span></span>
<span id="cb4-3"><a href="#cb4-3"></a>  <span class="fu">readRDS</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb4-4"><a href="#cb4-4"></a>  <span class="fu">filter</span>(base <span class="sc">==</span> <span class="st">"Recursos"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-5"><a href="#cb4-5"></a>  <span class="fu">select</span>(datasets) <span class="sc">%&gt;%</span> </span>
<span id="cb4-6"><a href="#cb4-6"></a>  <span class="fu">unnest</span>(<span class="fu">c</span>(datasets)) <span class="sc">%&gt;%</span></span>
<span id="cb4-7"><a href="#cb4-7"></a>  <span class="fu">filter</span>(</span>
<span id="cb4-8"><a href="#cb4-8"></a>    <span class="sc">!</span><span class="fu">is.na</span>(instancia),</span>
<span id="cb4-9"><a href="#cb4-9"></a>    <span class="sc">!</span><span class="fu">is.na</span>(data_resposta),</span>
<span id="cb4-10"><a href="#cb4-10"></a>    esfera <span class="sc">==</span> <span class="st">"Federal"</span>,</span>
<span id="cb4-11"><a href="#cb4-11"></a>    <span class="sc">!</span><span class="fu">str_detect</span>(orgao, <span class="st">"refeitura|Órgão para Teste"</span>),</span>
<span id="cb4-12"><a href="#cb4-12"></a>    instancia <span class="sc">!=</span> <span class="st">"Pedido de Revisão"</span></span>
<span id="cb4-13"><a href="#cb4-13"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb4-14"><a href="#cb4-14"></a>  <span class="fu">mutate</span>(<span class="at">instancia =</span> <span class="fu">ordered</span>(instancia, <span class="at">levels =</span> <span class="fu">names</span>(cores_instancia))) <span class="sc">%&gt;%</span> </span>
<span id="cb4-15"><a href="#cb4-15"></a>  <span class="fu">transmute</span>(</span>
<span id="cb4-16"><a href="#cb4-16"></a>    id_recurso,</span>
<span id="cb4-17"><a href="#cb4-17"></a>    id_pedido,</span>
<span id="cb4-18"><a href="#cb4-18"></a>    <span class="at">mes_recurso =</span> data_registro,</span>
<span id="cb4-19"><a href="#cb4-19"></a>    <span class="at">mes_resposta_recurso =</span> data_resposta,</span>
<span id="cb4-20"><a href="#cb4-20"></a>    <span class="at">data_recurso =</span> <span class="fu">dmy</span>(ts_registro),</span>
<span id="cb4-21"><a href="#cb4-21"></a>    <span class="at">data_resposta_recurso =</span> <span class="fu">dmy</span>(ts_resposta),</span>
<span id="cb4-22"><a href="#cb4-22"></a>    instancia,</span>
<span id="cb4-23"><a href="#cb4-23"></a>    tipo_recurso,</span>
<span id="cb4-24"><a href="#cb4-24"></a>    tipo_resposta</span>
<span id="cb4-25"><a href="#cb4-25"></a>  )</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p></p>
<section id="total-de-manifestações-registradas-no-falabr-2012-2022" class="level2"><h2 class="anchored" data-anchor-id="total-de-manifestações-registradas-no-falabr-2012-2022">Total de manifestações registradas no FalaBr (2012-2022)</h2>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>pedidos_cgu <span class="sc">%&gt;%</span> </span>
<span id="cb5-2"><a href="#cb5-2"></a>  <span class="fu">mutate</span>(<span class="at">is_pedido_de_informacao =</span> <span class="fu">case_when</span>(</span>
<span id="cb5-3"><a href="#cb5-3"></a>    decisao <span class="sc">%notin%</span> <span class="fu">c</span>(</span>
<span id="cb5-4"><a href="#cb5-4"></a>      <span class="st">"Pergunta Duplicada/Repetida"</span>,</span>
<span id="cb5-5"><a href="#cb5-5"></a>      <span class="st">"Não se trata de solicitação de informação"</span> </span>
<span id="cb5-6"><a href="#cb5-6"></a>    ) <span class="sc">~</span> <span class="st">"Pedidos de acesso a informação via LAI"</span>,</span>
<span id="cb5-7"><a href="#cb5-7"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> decisao</span>
<span id="cb5-8"><a href="#cb5-8"></a>  ) <span class="sc">%&gt;%</span> <span class="fu">str_wrap</span>(<span class="dv">25</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb5-9"><a href="#cb5-9"></a>  <span class="fu">count</span>(mes_pedido, is_pedido_de_informacao, <span class="at">name =</span> <span class="st">"qt"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb5-10"><a href="#cb5-10"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(</span>
<span id="cb5-11"><a href="#cb5-11"></a>    <span class="at">x =</span> mes_pedido,</span>
<span id="cb5-12"><a href="#cb5-12"></a>    <span class="at">y =</span> qt,</span>
<span id="cb5-13"><a href="#cb5-13"></a>    <span class="at">fill =</span> is_pedido_de_informacao,</span>
<span id="cb5-14"><a href="#cb5-14"></a>    <span class="at">color =</span> is_pedido_de_informacao</span>
<span id="cb5-15"><a href="#cb5-15"></a>  )) <span class="sc">+</span></span>
<span id="cb5-16"><a href="#cb5-16"></a>  <span class="fu">geom_vline</span>(</span>
<span id="cb5-17"><a href="#cb5-17"></a>    <span class="at">xintercept =</span> <span class="fu">seq</span>(<span class="fu">ymd</span>(<span class="st">'2013-01-01'</span>), <span class="fu">ymd</span>(<span class="st">'2022-01-01'</span>), <span class="at">by =</span> <span class="st">'year'</span>),</span>
<span id="cb5-18"><a href="#cb5-18"></a>    <span class="at">lty =</span> <span class="dv">3</span></span>
<span id="cb5-19"><a href="#cb5-19"></a>  ) <span class="sc">+</span></span>
<span id="cb5-20"><a href="#cb5-20"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb5-21"><a href="#cb5-21"></a>  <span class="fu">geom_label</span>(</span>
<span id="cb5-22"><a href="#cb5-22"></a>    <span class="fu">aes</span>(<span class="at">label =</span> qt),</span>
<span id="cb5-23"><a href="#cb5-23"></a>    <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb5-24"><a href="#cb5-24"></a>    <span class="at">size =</span> <span class="dv">3</span>, </span>
<span id="cb5-25"><a href="#cb5-25"></a>    <span class="at">nudge_y =</span> <span class="dv">250</span>,</span>
<span id="cb5-26"><a href="#cb5-26"></a>    <span class="at">alpha =</span> .<span class="dv">6</span>,</span>
<span id="cb5-27"><a href="#cb5-27"></a>    <span class="at">label.size =</span> <span class="cn">NA</span>,</span>
<span id="cb5-28"><a href="#cb5-28"></a>    <span class="at">data =</span> . <span class="sc">%&gt;%</span> </span>
<span id="cb5-29"><a href="#cb5-29"></a>      <span class="fu">group_by</span>(is_pedido_de_informacao) <span class="sc">%&gt;%</span> </span>
<span id="cb5-30"><a href="#cb5-30"></a>      <span class="fu">filter</span>(qt <span class="sc">==</span> <span class="fu">max</span>(qt)) <span class="sc">%&gt;%</span> </span>
<span id="cb5-31"><a href="#cb5-31"></a>      <span class="fu">ungroup</span>(),</span>
<span id="cb5-32"><a href="#cb5-32"></a>      <span class="at">show.legend =</span> F</span>
<span id="cb5-33"><a href="#cb5-33"></a>  ) <span class="sc">+</span></span>
<span id="cb5-34"><a href="#cb5-34"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb5-35"><a href="#cb5-35"></a>    <span class="at">color =</span> <span class="st">"gray20"</span>,</span>
<span id="cb5-36"><a href="#cb5-36"></a>    <span class="at">data =</span> . <span class="sc">%&gt;%</span> </span>
<span id="cb5-37"><a href="#cb5-37"></a>      <span class="fu">group_by</span>(is_pedido_de_informacao) <span class="sc">%&gt;%</span> </span>
<span id="cb5-38"><a href="#cb5-38"></a>      <span class="fu">filter</span>(qt <span class="sc">==</span> <span class="fu">max</span>(qt)) <span class="sc">%&gt;%</span> </span>
<span id="cb5-39"><a href="#cb5-39"></a>      <span class="fu">ungroup</span>(),</span>
<span id="cb5-40"><a href="#cb5-40"></a>    <span class="at">show.legend =</span> <span class="cn">FALSE</span></span>
<span id="cb5-41"><a href="#cb5-41"></a>  ) <span class="sc">+</span></span>
<span id="cb5-42"><a href="#cb5-42"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">number_format</span>()) <span class="sc">+</span></span>
<span id="cb5-43"><a href="#cb5-43"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> cores_lai) <span class="sc">+</span></span>
<span id="cb5-44"><a href="#cb5-44"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> cores_lai, <span class="at">breaks =</span> <span class="fu">names</span>(cores_lai)[<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">2</span>)]) <span class="sc">+</span></span>
<span id="cb5-45"><a href="#cb5-45"></a>  <span class="fu">scale_x_date</span>(</span>
<span id="cb5-46"><a href="#cb5-46"></a>    <span class="at">breaks =</span> <span class="fu">breaks_pretty</span>(<span class="dv">24</span>), </span>
<span id="cb5-47"><a href="#cb5-47"></a>    <span class="at">labels =</span> <span class="fu">label_date_short</span>(),</span>
<span id="cb5-48"><a href="#cb5-48"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="fu">ymd</span>(<span class="st">'2012-01-01'</span>), <span class="fu">ymd</span>(<span class="st">'2023-01-01'</span>)),</span>
<span id="cb5-49"><a href="#cb5-49"></a>    <span class="at">expand =</span> <span class="fu">c</span>(<span class="fl">0.</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb5-50"><a href="#cb5-50"></a>  <span class="fu">labs</span>(</span>
<span id="cb5-51"><a href="#cb5-51"></a>    <span class="at">y =</span> <span class="st">"Número de manifestações"</span>,</span>
<span id="cb5-52"><a href="#cb5-52"></a>    <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb5-53"><a href="#cb5-53"></a>    <span class="at">fill =</span> <span class="cn">NULL</span>,</span>
<span id="cb5-54"><a href="#cb5-54"></a>    <span class="at">color =</span> <span class="cn">NULL</span>,</span>
<span id="cb5-55"><a href="#cb5-55"></a>    <span class="at">title =</span> <span class="cn">NULL</span></span>
<span id="cb5-56"><a href="#cb5-56"></a>  ) <span class="sc">+</span></span>
<span id="cb5-57"><a href="#cb5-57"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb5-58"><a href="#cb5-58"></a>        <span class="at">legend.justification =</span> <span class="st">"left"</span>,</span>
<span id="cb5-59"><a href="#cb5-59"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">2</span>, <span class="dv">5</span>, <span class="st">"pt"</span>)),</span>
<span id="cb5-60"><a href="#cb5-60"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">vjust =</span> <span class="dv">1</span>)</span>
<span id="cb5-61"><a href="#cb5-61"></a>        )</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="0-monitoramento_files/figure-html/plot-total-de-manifestacoes-registradas-no-falabr-2012-2022-1.png" class="img-fluid" width="1056"></p>
</div>
</div>
<p></p>
</section><section id="número-de-órgãos-do-governo-federal-acionados-pela-lai-2012-2022" class="level2"><h2 class="anchored" data-anchor-id="número-de-órgãos-do-governo-federal-acionados-pela-lai-2012-2022">Número de órgãos do governo Federal acionados pela LAI (2012-2022)</h2>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>pedidos_cgu <span class="sc">%&gt;%</span> </span>
<span id="cb6-2"><a href="#cb6-2"></a>  <span class="fu">count</span>(<span class="at">ano =</span> <span class="fu">year</span>(mes_pedido), orgao) <span class="sc">%&gt;%</span> </span>
<span id="cb6-3"><a href="#cb6-3"></a>  <span class="fu">count</span>(ano) <span class="sc">%&gt;%</span> </span>
<span id="cb6-4"><a href="#cb6-4"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.character</span>(ano), <span class="at">y =</span> n)) <span class="sc">+</span></span>
<span id="cb6-5"><a href="#cb6-5"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> cores_aep[[<span class="st">"laranja"</span>]], <span class="at">alpha =</span> .<span class="dv">9</span>) <span class="sc">+</span></span>
<span id="cb6-6"><a href="#cb6-6"></a>  <span class="fu">geom_hline</span>(<span class="fu">aes</span>(<span class="at">yintercept =</span> <span class="fu">n_distinct</span>(pedidos_cgu<span class="sc">$</span>orgao))) <span class="sc">+</span></span>
<span id="cb6-7"><a href="#cb6-7"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb6-8"><a href="#cb6-8"></a>    <span class="fu">aes</span>(</span>
<span id="cb6-9"><a href="#cb6-9"></a>      <span class="at">y =</span> <span class="fu">n_distinct</span>(pedidos_cgu<span class="sc">$</span>orgao) <span class="sc">+</span> <span class="dv">10</span>,</span>
<span id="cb6-10"><a href="#cb6-10"></a>      <span class="at">x =</span> <span class="st">"2016"</span>,</span>
<span id="cb6-11"><a href="#cb6-11"></a>      <span class="at">label =</span> <span class="fu">glue</span>(<span class="st">"Total de órgãos no Executivo Federal: {n_distinct(pedidos_cgu$orgao)}"</span>)</span>
<span id="cb6-12"><a href="#cb6-12"></a>    ),</span>
<span id="cb6-13"><a href="#cb6-13"></a>    <span class="at">check_overlap =</span> T</span>
<span id="cb6-14"><a href="#cb6-14"></a>  ) <span class="sc">+</span></span>
<span id="cb6-15"><a href="#cb6-15"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> n), <span class="at">color =</span> <span class="st">"gray30"</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb6-16"><a href="#cb6-16"></a>  <span class="fu">labs</span>(</span>
<span id="cb6-17"><a href="#cb6-17"></a>    <span class="at">x =</span> <span class="st">"Ano"</span>,</span>
<span id="cb6-18"><a href="#cb6-18"></a>    <span class="at">y =</span> <span class="st">"Quantidade de órgãos"</span></span>
<span id="cb6-19"><a href="#cb6-19"></a>  ) <span class="sc">+</span></span>
<span id="cb6-20"><a href="#cb6-20"></a>  <span class="fu">theme</span>(</span>
<span id="cb6-21"><a href="#cb6-21"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>)</span>
<span id="cb6-22"><a href="#cb6-22"></a>  )</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="0-monitoramento_files/figure-html/plot-orgaos-requisitados-pela-lai-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p></p>
</section><section id="taxa-de-atendimento-de-pedidos-de-acesso-a-informação-2012-2022" class="level2"><h2 class="anchored" data-anchor-id="taxa-de-atendimento-de-pedidos-de-acesso-a-informação-2012-2022">Taxa de atendimento de pedidos de acesso a informação (2012-2022)</h2>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>decisao <span class="ot">&lt;-</span> pedidos_cgu <span class="sc">%&gt;%</span> </span>
<span id="cb7-2"><a href="#cb7-2"></a>  <span class="fu">filter</span>(decisao <span class="sc">%notin%</span> <span class="fu">c</span>(</span>
<span id="cb7-3"><a href="#cb7-3"></a>    <span class="st">"Pergunta Duplicada/Repetida"</span>,</span>
<span id="cb7-4"><a href="#cb7-4"></a>    <span class="st">"Não se trata de solicitação de informação"</span></span>
<span id="cb7-5"><a href="#cb7-5"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb7-6"><a href="#cb7-6"></a>  <span class="fu">count</span>(mes_pedido, decisao, <span class="at">name =</span> <span class="st">"qt"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-7"><a href="#cb7-7"></a>  <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb7-8"><a href="#cb7-8"></a>  <span class="fu">mutate</span>(<span class="at">decisao =</span> <span class="fu">fct_reorder</span>(decisao, qt, <span class="at">.desc =</span> T))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="co"># plot esquerdo ----------------------------------------------------------------</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>plot_decisao <span class="ot">&lt;-</span> <span class="cf">function</span>(decisao_escolhida) {</span>
<span id="cb8-3"><a href="#cb8-3"></a>  </span>
<span id="cb8-4"><a href="#cb8-4"></a>  p1 <span class="ot">&lt;-</span> decisao <span class="sc">%&gt;%</span></span>
<span id="cb8-5"><a href="#cb8-5"></a>    <span class="fu">add_count</span>(mes_pedido, <span class="at">wt =</span> qt, <span class="at">name =</span> <span class="st">"qt_mes"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-6"><a href="#cb8-6"></a>    <span class="fu">mutate</span>(<span class="at">per =</span> qt <span class="sc">/</span> qt_mes) <span class="sc">%&gt;%</span> </span>
<span id="cb8-7"><a href="#cb8-7"></a>    <span class="fu">filter</span>(decisao <span class="sc">==</span> decisao_escolhida) <span class="sc">%&gt;%</span> </span>
<span id="cb8-8"><a href="#cb8-8"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> mes_pedido, <span class="at">y =</span> per)) <span class="sc">+</span></span>
<span id="cb8-9"><a href="#cb8-9"></a>    <span class="fu">geom_rect</span>(</span>
<span id="cb8-10"><a href="#cb8-10"></a>      <span class="at">data =</span> . <span class="sc">%&gt;%</span></span>
<span id="cb8-11"><a href="#cb8-11"></a>        <span class="fu">filter</span>(mes_pedido <span class="sc">==</span> <span class="fu">min</span>(mes_pedido) <span class="sc">|</span> mes_pedido <span class="sc">==</span> <span class="fu">max</span>(mes_pedido)),</span>
<span id="cb8-12"><a href="#cb8-12"></a>      <span class="fu">aes</span>(</span>
<span id="cb8-13"><a href="#cb8-13"></a>        <span class="at">xmin =</span> <span class="fu">floor_date</span>(<span class="fu">min</span>(mes_pedido), <span class="st">"year"</span>),</span>
<span id="cb8-14"><a href="#cb8-14"></a>        <span class="at">xmax =</span> <span class="fu">ceiling_date</span>(<span class="fu">max</span>(mes_pedido), <span class="st">"year"</span>),</span>
<span id="cb8-15"><a href="#cb8-15"></a>        <span class="at">ymin =</span> <span class="sc">-</span><span class="cn">Inf</span>,</span>
<span id="cb8-16"><a href="#cb8-16"></a>        <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb8-17"><a href="#cb8-17"></a>        <span class="at">fill =</span> decisao</span>
<span id="cb8-18"><a href="#cb8-18"></a>      ),</span>
<span id="cb8-19"><a href="#cb8-19"></a>      <span class="at">alpha =</span> .<span class="dv">2</span>,</span>
<span id="cb8-20"><a href="#cb8-20"></a>      <span class="at">show.legend =</span> F</span>
<span id="cb8-21"><a href="#cb8-21"></a>    ) <span class="sc">+</span></span>
<span id="cb8-22"><a href="#cb8-22"></a>    <span class="fu">geom_line</span>(<span class="at">show.legend =</span> F, <span class="at">size =</span> .<span class="dv">7</span>) <span class="sc">+</span></span>
<span id="cb8-23"><a href="#cb8-23"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">seq</span>(<span class="fu">ymd</span>(<span class="st">'2013-01-01'</span>), <span class="fu">ymd</span>(<span class="st">'2022-01-01'</span>), <span class="at">by =</span> <span class="st">'year'</span>), <span class="at">lty =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb8-24"><a href="#cb8-24"></a>    ggforce<span class="sc">::</span><span class="fu">geom_mark_circle</span>(</span>
<span id="cb8-25"><a href="#cb8-25"></a>      <span class="fu">aes</span>(<span class="at">filter =</span> mes_pedido <span class="sc">==</span> <span class="fu">ymd</span>(<span class="st">"2018-10-01"</span>) <span class="sc">&amp;</span> decisao <span class="sc">==</span> <span class="st">"Acesso Concedido"</span>,</span>
<span id="cb8-26"><a href="#cb8-26"></a>          <span class="at">label =</span> <span class="st">"Máximas anuais"</span>),</span>
<span id="cb8-27"><a href="#cb8-27"></a>      <span class="at">color =</span> <span class="st">"gray20"</span>,</span>
<span id="cb8-28"><a href="#cb8-28"></a>      <span class="at">fill =</span> <span class="cn">NA</span>,</span>
<span id="cb8-29"><a href="#cb8-29"></a>      <span class="at">radius =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">"mm"</span>),</span>
<span id="cb8-30"><a href="#cb8-30"></a>      <span class="at">expand =</span> <span class="dv">0</span>,</span>
<span id="cb8-31"><a href="#cb8-31"></a>      <span class="at">con.cap =</span> <span class="dv">0</span>,</span>
<span id="cb8-32"><a href="#cb8-32"></a>      <span class="at">label.fill =</span> <span class="fu">alpha</span>(cores_decisao[[<span class="st">"Acesso Concedido"</span>]], .<span class="dv">5</span>),</span>
<span id="cb8-33"><a href="#cb8-33"></a>      <span class="at">label.fontsize =</span> <span class="dv">10</span>,</span>
<span id="cb8-34"><a href="#cb8-34"></a>      <span class="at">label.fontface =</span> <span class="st">"plain"</span>,</span>
<span id="cb8-35"><a href="#cb8-35"></a>      <span class="at">label.buffer =</span> <span class="fu">unit</span>(<span class="dv">10</span>, <span class="st">"mm"</span>),</span>
<span id="cb8-36"><a href="#cb8-36"></a>      <span class="at">label.margin =</span> <span class="fu">margin</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="st">"mm"</span>)</span>
<span id="cb8-37"><a href="#cb8-37"></a>    ) <span class="sc">+</span></span>
<span id="cb8-38"><a href="#cb8-38"></a>    ggrepel<span class="sc">::</span><span class="fu">geom_label_repel</span>(</span>
<span id="cb8-39"><a href="#cb8-39"></a>      <span class="at">data =</span> . <span class="sc">%&gt;%</span></span>
<span id="cb8-40"><a href="#cb8-40"></a>        <span class="fu">group_by</span>(decisao, <span class="fu">year</span>(mes_pedido)) <span class="sc">%&gt;%</span></span>
<span id="cb8-41"><a href="#cb8-41"></a>        <span class="fu">arrange</span>(<span class="fu">year</span>(mes_pedido), decisao, <span class="sc">-</span>per) <span class="sc">%&gt;%</span></span>
<span id="cb8-42"><a href="#cb8-42"></a>        <span class="fu">filter</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-43"><a href="#cb8-43"></a>        <span class="fu">ungroup</span>(),</span>
<span id="cb8-44"><a href="#cb8-44"></a>      <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">my_lbl</span>(per), <span class="at">fill =</span> decisao, <span class="at">color =</span> decisao),</span>
<span id="cb8-45"><a href="#cb8-45"></a>      <span class="at">min.segment.length =</span> <span class="fl">0.01</span>,</span>
<span id="cb8-46"><a href="#cb8-46"></a>      <span class="at">size =</span> <span class="fl">3.5</span>,</span>
<span id="cb8-47"><a href="#cb8-47"></a>      <span class="at">label.padding =</span> <span class="fu">unit</span>(<span class="fl">0.1</span>, <span class="st">"lines"</span>),</span>
<span id="cb8-48"><a href="#cb8-48"></a>      <span class="at">label.size =</span> <span class="cn">NA</span>,</span>
<span id="cb8-49"><a href="#cb8-49"></a>      <span class="at">show.legend =</span> F</span>
<span id="cb8-50"><a href="#cb8-50"></a>    ) <span class="sc">+</span></span>
<span id="cb8-51"><a href="#cb8-51"></a>    <span class="fu">geom_point</span>(</span>
<span id="cb8-52"><a href="#cb8-52"></a>      <span class="at">data =</span> . <span class="sc">%&gt;%</span></span>
<span id="cb8-53"><a href="#cb8-53"></a>        <span class="fu">group_by</span>(decisao, <span class="fu">year</span>(mes_pedido)) <span class="sc">%&gt;%</span></span>
<span id="cb8-54"><a href="#cb8-54"></a>        <span class="fu">arrange</span>(<span class="fu">year</span>(mes_pedido), decisao, <span class="sc">-</span>per) <span class="sc">%&gt;%</span></span>
<span id="cb8-55"><a href="#cb8-55"></a>        <span class="fu">filter</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-56"><a href="#cb8-56"></a>        <span class="fu">ungroup</span>()</span>
<span id="cb8-57"><a href="#cb8-57"></a>    ) <span class="sc">+</span></span>
<span id="cb8-58"><a href="#cb8-58"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> cores_decisao) <span class="sc">+</span></span>
<span id="cb8-59"><a href="#cb8-59"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> cores_decisao3) <span class="sc">+</span></span>
<span id="cb8-60"><a href="#cb8-60"></a>    <span class="fu">scale_y_percent</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb8-61"><a href="#cb8-61"></a>    <span class="co"># scale_x_date(</span></span>
<span id="cb8-62"><a href="#cb8-62"></a>    <span class="co">#   breaks = scales::date_breaks("6 months"),</span></span>
<span id="cb8-63"><a href="#cb8-63"></a>    <span class="co">#   date_labels = "%b",</span></span>
<span id="cb8-64"><a href="#cb8-64"></a>    <span class="co">#   expand = c(0, 0)</span></span>
<span id="cb8-65"><a href="#cb8-65"></a>    <span class="co"># ) +</span></span>
<span id="cb8-66"><a href="#cb8-66"></a>    <span class="fu">scale_x_date</span>(</span>
<span id="cb8-67"><a href="#cb8-67"></a>      <span class="at">breaks =</span> <span class="fu">breaks_pretty</span>(<span class="dv">24</span>), </span>
<span id="cb8-68"><a href="#cb8-68"></a>      <span class="at">labels =</span> <span class="fu">label_date_short</span>(),</span>
<span id="cb8-69"><a href="#cb8-69"></a>      <span class="at">limits =</span> <span class="fu">c</span>(<span class="fu">ymd</span>(<span class="st">'2012-01-01'</span>), <span class="fu">ymd</span>(<span class="st">'2023-01-01'</span>)),</span>
<span id="cb8-70"><a href="#cb8-70"></a>      <span class="at">expand =</span> <span class="fu">c</span>(<span class="fl">0.</span>, <span class="dv">0</span>)</span>
<span id="cb8-71"><a href="#cb8-71"></a>    ) <span class="sc">+</span></span>
<span id="cb8-72"><a href="#cb8-72"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb8-73"><a href="#cb8-73"></a>    <span class="fu">theme</span>(</span>
<span id="cb8-74"><a href="#cb8-74"></a>      <span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb8-75"><a href="#cb8-75"></a>      <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(), </span>
<span id="cb8-76"><a href="#cb8-76"></a>      <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb8-77"><a href="#cb8-77"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb8-78"><a href="#cb8-78"></a>      <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb8-79"><a href="#cb8-79"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb8-80"><a href="#cb8-80"></a>      <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">angle =</span> <span class="dv">0</span>, <span class="at">hjust =</span> <span class="dv">0</span>)</span>
<span id="cb8-81"><a href="#cb8-81"></a>    ) <span class="sc">+</span></span>
<span id="cb8-82"><a href="#cb8-82"></a>    <span class="fu">labs</span>(</span>
<span id="cb8-83"><a href="#cb8-83"></a>      <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb8-84"><a href="#cb8-84"></a>      <span class="at">y =</span> <span class="cn">NULL</span>,</span>
<span id="cb8-85"><a href="#cb8-85"></a>      <span class="at">title =</span> <span class="cn">NULL</span>,</span>
<span id="cb8-86"><a href="#cb8-86"></a>      <span class="at">subtitle =</span> <span class="st">"Taxa mensal"</span>,</span>
<span id="cb8-87"><a href="#cb8-87"></a>      <span class="at">color =</span> <span class="cn">NULL</span>,</span>
<span id="cb8-88"><a href="#cb8-88"></a>      <span class="at">fill =</span> <span class="cn">NULL</span></span>
<span id="cb8-89"><a href="#cb8-89"></a>    )</span>
<span id="cb8-90"><a href="#cb8-90"></a>    </span>
<span id="cb8-91"><a href="#cb8-91"></a>  p2 <span class="ot">&lt;-</span> decisao <span class="sc">%&gt;%</span></span>
<span id="cb8-92"><a href="#cb8-92"></a>    <span class="fu">count</span>(<span class="at">ano =</span> <span class="fu">year</span>(mes_pedido), decisao, <span class="at">wt =</span> qt, <span class="at">name =</span> <span class="st">"qt"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-93"><a href="#cb8-93"></a>    <span class="fu">add_count</span>(ano, <span class="at">wt =</span> qt, <span class="at">name =</span> <span class="st">"qt_ano"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-94"><a href="#cb8-94"></a>    <span class="fu">mutate</span>(<span class="at">perc_ano =</span> qt <span class="sc">/</span> qt_ano) <span class="sc">%&gt;%</span></span>
<span id="cb8-95"><a href="#cb8-95"></a>    <span class="fu">filter</span>(decisao <span class="sc">==</span> decisao_escolhida) <span class="sc">%&gt;%</span> </span>
<span id="cb8-96"><a href="#cb8-96"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> perc_ano, <span class="at">y =</span> <span class="fu">reorder</span>(ano, <span class="sc">-</span>ano), <span class="at">fill =</span> decisao, <span class="at">color =</span> decisao)) <span class="sc">+</span></span>
<span id="cb8-97"><a href="#cb8-97"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span> <span class="fu">reorder</span>(decisao, <span class="sc">-</span>perc_ano), <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">scales =</span> <span class="st">"free_x"</span>) <span class="sc">+</span></span>
<span id="cb8-98"><a href="#cb8-98"></a>    <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">1</span>), <span class="at">alpha =</span> .<span class="dv">3</span>, <span class="at">fill =</span> <span class="st">"gray97"</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb8-99"><a href="#cb8-99"></a>    <span class="fu">geom_col</span>(<span class="at">alpha =</span> .<span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb8-100"><a href="#cb8-100"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">my_lbl</span>(perc_ano)), </span>
<span id="cb8-101"><a href="#cb8-101"></a>               <span class="at">size =</span> <span class="dv">4</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="sc">-</span>.<span class="dv">05</span>, <span class="at">check_overlap =</span> T) <span class="sc">+</span></span>
<span id="cb8-102"><a href="#cb8-102"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb8-103"><a href="#cb8-103"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> cores_decisao) <span class="sc">+</span></span>
<span id="cb8-104"><a href="#cb8-104"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> cores_decisao2) <span class="sc">+</span></span>
<span id="cb8-105"><a href="#cb8-105"></a>    <span class="fu">scale_x_percent</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">3</span>, .<span class="dv">6</span>, .<span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="cb8-106"><a href="#cb8-106"></a>    <span class="fu">scale_y_discrete</span>(<span class="at">labels =</span> <span class="fu">glue</span>(<span class="st">"{2022:2012}"</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb8-107"><a href="#cb8-107"></a>    <span class="co">#coord_flip() +</span></span>
<span id="cb8-108"><a href="#cb8-108"></a>    <span class="fu">theme</span>(</span>
<span id="cb8-109"><a href="#cb8-109"></a>      <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(),</span>
<span id="cb8-110"><a href="#cb8-110"></a>      <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"white"</span>),</span>
<span id="cb8-111"><a href="#cb8-111"></a>      <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb8-112"><a href="#cb8-112"></a>      <span class="at">panel.grid.minor.y =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"white"</span>),</span>
<span id="cb8-113"><a href="#cb8-113"></a>      <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb8-114"><a href="#cb8-114"></a>      <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"transparent"</span>),</span>
<span id="cb8-115"><a href="#cb8-115"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">vjust =</span> <span class="dv">2</span>),</span>
<span id="cb8-116"><a href="#cb8-116"></a>      <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">hjust =</span> <span class="dv">3</span>)</span>
<span id="cb8-117"><a href="#cb8-117"></a>    ) <span class="sc">+</span></span>
<span id="cb8-118"><a href="#cb8-118"></a>    <span class="fu">labs</span>(</span>
<span id="cb8-119"><a href="#cb8-119"></a>      <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb8-120"><a href="#cb8-120"></a>      <span class="at">y =</span> <span class="cn">NULL</span>,</span>
<span id="cb8-121"><a href="#cb8-121"></a>      <span class="at">fill =</span> <span class="cn">NULL</span>,</span>
<span id="cb8-122"><a href="#cb8-122"></a>      <span class="at">subtitle =</span> <span class="st">"Taxa anual"</span></span>
<span id="cb8-123"><a href="#cb8-123"></a>    )</span>
<span id="cb8-124"><a href="#cb8-124"></a>  </span>
<span id="cb8-125"><a href="#cb8-125"></a>  comb <span class="ot">&lt;-</span> p1 <span class="sc">+</span> p2 <span class="sc">&amp;</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) </span>
<span id="cb8-126"><a href="#cb8-126"></a>  </span>
<span id="cb8-127"><a href="#cb8-127"></a>  comb <span class="ot">&lt;-</span> comb <span class="sc">+</span></span>
<span id="cb8-128"><a href="#cb8-128"></a>    <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">widths =</span> <span class="fu">c</span>(<span class="fl">2.8</span>, <span class="fl">1.2</span>))</span>
<span id="cb8-129"><a href="#cb8-129"></a>  </span>
<span id="cb8-130"><a href="#cb8-130"></a>  <span class="fu">return</span>(comb)</span>
<span id="cb8-131"><a href="#cb8-131"></a>  </span>
<span id="cb8-132"><a href="#cb8-132"></a>}</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>A <strong>taxa de atendimento</strong> é a proporção de uma decisão de acesso em relação à todos os pedidos de acesso a informação.</p>
<p></p>
<section id="taxa-de-acessos-concedidos" class="level3"><h3 class="anchored" data-anchor-id="taxa-de-acessos-concedidos">Taxa de Acessos Concedidos</h3>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="fu">plot_decisao</span>(<span class="st">"Acesso Concedido"</span>) </span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="0-monitoramento_files/figure-html/plot-acesso-concedido-1.png" class="img-fluid" width="1056"></p>
</div>
</div>
<p></p>
</section><section id="taxa-de-acessos-negados" class="level3"><h3 class="anchored" data-anchor-id="taxa-de-acessos-negados">Taxa de Acessos Negados</h3>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="fu">plot_decisao</span>(<span class="st">"Acesso Negado"</span>) </span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="0-monitoramento_files/figure-html/plot-acesso-negado-1.png" class="img-fluid" width="1056"></p>
</div>
</div>
<p></p>
</section><section id="taxa-de-acessos-parcialmente-concedido" class="level3"><h3 class="anchored" data-anchor-id="taxa-de-acessos-parcialmente-concedido">Taxa de Acessos Parcialmente Concedido</h3>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="fu">plot_decisao</span>(<span class="st">"Acesso Parcialmente Concedido"</span>) </span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="0-monitoramento_files/figure-html/plot-acesso-parcial-1.png" class="img-fluid" width="1056"></p>
</div>
</div>
<p></p>
</section><section id="taxa-para-a-decisão-órgão-não-tem-competência-para-responder-sobre-o-assunto" class="level3"><h3 class="anchored" data-anchor-id="taxa-para-a-decisão-órgão-não-tem-competência-para-responder-sobre-o-assunto">Taxa para a decisão “Órgão não tem competência para responder sobre o assunto”</h3>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="fu">plot_decisao</span>(<span class="st">"Órgão não tem competência para responder sobre o assunto"</span>) </span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="0-monitoramento_files/figure-html/plot-orgao-sem-competencia-1.png" class="img-fluid" width="1056"></p>
</div>
</div>
<p></p>
</section><section id="taxa-de-resposta-de-informação-inexistente" class="level3"><h3 class="anchored" data-anchor-id="taxa-de-resposta-de-informação-inexistente">Taxa de resposta de “Informação Inexistente”</h3>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="fu">plot_decisao</span>(<span class="st">"Informação Inexistente"</span>) </span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="0-monitoramento_files/figure-html/plot-informacao-inexistente-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<p></p>
</section></section><section id="taxas-de-respostas-por-decisão-de-acesso---mesmo-período---2012-2022" class="level2"><h2 class="anchored" data-anchor-id="taxas-de-respostas-por-decisão-de-acesso---mesmo-período---2012-2022">Taxas de respostas por decisão de acesso - mesmo período - (2012-2022)</h2>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>decisao <span class="sc">%&gt;%</span></span>
<span id="cb14-2"><a href="#cb14-2"></a>  <span class="fu">mutate</span>(<span class="at">mesmo_periodo =</span> <span class="fu">month</span>(mes_pedido) <span class="sc">&lt;=</span> <span class="fu">month</span>(<span class="fu">today</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb14-3"><a href="#cb14-3"></a>  <span class="fu">add_count</span>(mes_pedido, mesmo_periodo, <span class="at">wt =</span> qt, <span class="at">name =</span> <span class="st">"qt_mes"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-4"><a href="#cb14-4"></a>  <span class="fu">mutate</span>(<span class="at">perc =</span> qt <span class="sc">/</span> qt_mes) <span class="sc">%&gt;%</span></span>
<span id="cb14-5"><a href="#cb14-5"></a>  <span class="co"># filter(decisao == "Acesso Negado") %&gt;%</span></span>
<span id="cb14-6"><a href="#cb14-6"></a>  <span class="fu">filter</span>(decisao <span class="sc">%in%</span> <span class="fu">c</span>(</span>
<span id="cb14-7"><a href="#cb14-7"></a>    <span class="st">"Acesso Negado"</span>,</span>
<span id="cb14-8"><a href="#cb14-8"></a>    <span class="st">"Acesso Parcialmente Concedido"</span></span>
<span id="cb14-9"><a href="#cb14-9"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb14-10"><a href="#cb14-10"></a>  <span class="fu">group_by</span>(<span class="at">ano =</span> <span class="fu">year</span>(mes_pedido), mesmo_periodo, decisao) <span class="sc">%&gt;%</span></span>
<span id="cb14-11"><a href="#cb14-11"></a>  <span class="fu">mutate</span>(<span class="at">media_perc =</span> <span class="fu">if_else</span>(mesmo_periodo, <span class="fu">mean</span>(perc), <span class="cn">NA_real_</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb14-12"><a href="#cb14-12"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb14-13"><a href="#cb14-13"></a>  <span class="fu">mutate</span>(</span>
<span id="cb14-14"><a href="#cb14-14"></a>   <span class="at">decisao2 =</span> <span class="fu">if_else</span>(mesmo_periodo, <span class="fu">as.character</span>(decisao), <span class="st">""</span>)</span>
<span id="cb14-15"><a href="#cb14-15"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb14-16"><a href="#cb14-16"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> mes_pedido, <span class="at">y =</span> perc, <span class="at">fill =</span> decisao2)) <span class="sc">+</span></span>
<span id="cb14-17"><a href="#cb14-17"></a>  <span class="fu">geom_vline</span>(</span>
<span id="cb14-18"><a href="#cb14-18"></a>    <span class="at">xintercept =</span> <span class="fu">seq</span>(<span class="fu">ymd</span>(<span class="st">"2013-01-01"</span>), <span class="fu">ymd</span>(<span class="st">"2022-01-01"</span>), <span class="at">by =</span> <span class="st">"year"</span>),</span>
<span id="cb14-19"><a href="#cb14-19"></a>    <span class="at">lty =</span> <span class="dv">3</span></span>
<span id="cb14-20"><a href="#cb14-20"></a>  ) <span class="sc">+</span></span>
<span id="cb14-21"><a href="#cb14-21"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb14-22"><a href="#cb14-22"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> media_perc), <span class="at">shape =</span> <span class="dv">95</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb14-23"><a href="#cb14-23"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb14-24"><a href="#cb14-24"></a>    <span class="at">data =</span> . <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">month</span>(mes_pedido) <span class="sc">==</span> <span class="fu">month</span>(<span class="fu">today</span>())),</span>
<span id="cb14-25"><a href="#cb14-25"></a>    <span class="at">check_overlap =</span> <span class="cn">TRUE</span>,</span>
<span id="cb14-26"><a href="#cb14-26"></a>    <span class="at">fontface =</span> <span class="st">"bold"</span>,</span>
<span id="cb14-27"><a href="#cb14-27"></a>    <span class="at">size =</span> <span class="fl">3.5</span>,</span>
<span id="cb14-28"><a href="#cb14-28"></a>    <span class="fu">aes</span>(</span>
<span id="cb14-29"><a href="#cb14-29"></a>      <span class="at">y =</span> media_perc,</span>
<span id="cb14-30"><a href="#cb14-30"></a>      <span class="at">label =</span> <span class="fu">my_lbl</span>(media_perc)</span>
<span id="cb14-31"><a href="#cb14-31"></a>      ),</span>
<span id="cb14-32"><a href="#cb14-32"></a>    <span class="at">nudge_y =</span> .<span class="dv">006</span>,</span>
<span id="cb14-33"><a href="#cb14-33"></a>    <span class="at">hjust =</span> .<span class="dv">5</span>,</span>
<span id="cb14-34"><a href="#cb14-34"></a>  ) <span class="sc">+</span></span>
<span id="cb14-35"><a href="#cb14-35"></a>  <span class="fu">geom_curve</span>(</span>
<span id="cb14-36"><a href="#cb14-36"></a>    <span class="at">data =</span> . <span class="sc">%&gt;%</span> <span class="fu">filter</span>(decisao2 <span class="sc">==</span> <span class="st">"Acesso Parcialmente Concedido"</span>),</span>
<span id="cb14-37"><a href="#cb14-37"></a>    <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">ymd</span>(<span class="st">"2019-03-01"</span>),</span>
<span id="cb14-38"><a href="#cb14-38"></a>        <span class="at">y =</span> <span class="fl">0.115</span>, </span>
<span id="cb14-39"><a href="#cb14-39"></a>        <span class="at">xend =</span> <span class="fu">ymd</span>(<span class="st">"2019-03-01"</span>),</span>
<span id="cb14-40"><a href="#cb14-40"></a>        <span class="at">yend =</span> <span class="fl">0.075</span>),</span>
<span id="cb14-41"><a href="#cb14-41"></a>    <span class="at">colour =</span> <span class="st">"black"</span>,</span>
<span id="cb14-42"><a href="#cb14-42"></a>    <span class="at">size =</span> <span class="fl">0.6</span>,</span>
<span id="cb14-43"><a href="#cb14-43"></a>    <span class="at">curvature =</span> .<span class="dv">35</span>,</span>
<span id="cb14-44"><a href="#cb14-44"></a>    <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.2</span>, <span class="st">"cm"</span>))</span>
<span id="cb14-45"><a href="#cb14-45"></a>  ) <span class="sc">+</span></span>
<span id="cb14-46"><a href="#cb14-46"></a>  <span class="fu">geom_label</span>(</span>
<span id="cb14-47"><a href="#cb14-47"></a>    <span class="at">data =</span> . <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mes_pedido <span class="sc">==</span> <span class="fu">ymd</span>(<span class="st">"2019-04-01"</span>) <span class="sc">&amp;</span> decisao2 <span class="sc">==</span> <span class="st">"Acesso Parcialmente Concedido"</span>),</span>
<span id="cb14-48"><a href="#cb14-48"></a>    <span class="fu">aes</span>(<span class="at">label =</span> <span class="st">"Média anual</span><span class="sc">\n</span><span class="st">(mesmo período)"</span>, <span class="at">y =</span> .<span class="dv">125</span>, <span class="at">x =</span> mes_pedido),</span>
<span id="cb14-49"><a href="#cb14-49"></a>    <span class="at">fill =</span> <span class="st">"white"</span>,</span>
<span id="cb14-50"><a href="#cb14-50"></a>    <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb14-51"><a href="#cb14-51"></a>    <span class="at">label.size =</span> <span class="cn">NA</span></span>
<span id="cb14-52"><a href="#cb14-52"></a>  ) <span class="sc">+</span></span>
<span id="cb14-53"><a href="#cb14-53"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"gray70"</span>, cores_decisao[<span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">4</span>)])) <span class="sc">+</span></span>
<span id="cb14-54"><a href="#cb14-54"></a>  <span class="fu">facet_wrap</span>(. <span class="sc">~</span> <span class="fu">reorder</span>(decisao, <span class="sc">-</span>perc), <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">scales =</span> <span class="st">"free_x"</span>) <span class="sc">+</span></span>
<span id="cb14-55"><a href="#cb14-55"></a>  hrbrthemes<span class="sc">::</span><span class="fu">scale_y_percent</span>() <span class="sc">+</span></span>
<span id="cb14-56"><a href="#cb14-56"></a>  <span class="fu">scale_x_date</span>(</span>
<span id="cb14-57"><a href="#cb14-57"></a>    <span class="at">breaks =</span> <span class="fu">breaks_pretty</span>(<span class="dv">36</span>), </span>
<span id="cb14-58"><a href="#cb14-58"></a>    <span class="at">labels =</span> <span class="fu">label_date_short</span>(),</span>
<span id="cb14-59"><a href="#cb14-59"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="fu">ymd</span>(<span class="st">'2012-01-01'</span>), <span class="fu">ymd</span>(<span class="st">'2023-01-01'</span>)),</span>
<span id="cb14-60"><a href="#cb14-60"></a>    <span class="at">expand =</span> <span class="fu">c</span>(<span class="fl">0.</span>, <span class="dv">0</span>)</span>
<span id="cb14-61"><a href="#cb14-61"></a>  ) <span class="sc">+</span></span>
<span id="cb14-62"><a href="#cb14-62"></a>  <span class="fu">theme</span>(</span>
<span id="cb14-63"><a href="#cb14-63"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb14-64"><a href="#cb14-64"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb14-65"><a href="#cb14-65"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>)</span>
<span id="cb14-66"><a href="#cb14-66"></a>  ) <span class="sc">+</span></span>
<span id="cb14-67"><a href="#cb14-67"></a>  <span class="fu">labs</span>(</span>
<span id="cb14-68"><a href="#cb14-68"></a>    <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb14-69"><a href="#cb14-69"></a>    <span class="at">y =</span> <span class="cn">NULL</span>,</span>
<span id="cb14-70"><a href="#cb14-70"></a>    <span class="at">title =</span> <span class="cn">NULL</span>,</span>
<span id="cb14-71"><a href="#cb14-71"></a>    <span class="at">subtitle =</span> <span class="st">"Como % do total de pedidos de acesso a informação"</span></span>
<span id="cb14-72"><a href="#cb14-72"></a>  )</span>
<span id="cb14-73"><a href="#cb14-73"></a><span class="co">#&gt; Warning: Removed 80 rows containing missing values (geom_point).</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="0-monitoramento_files/figure-html/plot-taxa-de-resposta-mesmo-periodo-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<p></p>
</section><section id="negativas-de-acesso" class="level2"><h2 class="anchored" data-anchor-id="negativas-de-acesso">Negativas de acesso</h2>
<section id="metodologia-taxa-geral-e-interna-de-acessos-negados" class="level3"><h3 class="anchored" data-anchor-id="metodologia-taxa-geral-e-interna-de-acessos-negados">Metodologia (taxa geral e interna de acessos negados)</h3>
<p>Pedidos de acesso a informação são solicitações no FalaBr que <u>não</u> foram classificadas como: “Pergunta Duplicada/Repetida”, “Não se trata de solicitação de informação”.</p>
<p>As negativas de acesso são abordadas de duas formas:</p>
<ul>
<li>Taxa geral de negativas por órgão:</li>
</ul>
<p><span class="math display">\[
Taxa\:geral\:\:de\:negativas\:por\:órgão = \frac{{Total\:Acessos\:Negados\:no\:órgão}_{mês}}{{Total\:Acessos\:Negados\:no\:FalaBr}_{mês}} \times 100
\]</span></p>
<ul>
<li>Taxa interna de negativas por órgão</li>
</ul>
<p><span class="math display">\[
Taxa\:interna\:de\:negativas\:por\:órgão = \frac{{Total\:Acessos\:Negados\:no\:órgão}_{mês}}{{Total\:pedidos\:recebidos\:pelo\:órgão}_{mês}} \times 100
\]</span></p>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>taxas <span class="ot">&lt;-</span> pedidos_cgu <span class="sc">%&gt;%</span></span>
<span id="cb15-2"><a href="#cb15-2"></a>  <span class="fu">select</span>(id_pedido, mes_pedido, decisao, orgao) <span class="sc">%&gt;%</span> </span>
<span id="cb15-3"><a href="#cb15-3"></a>  <span class="fu">filter</span>(decisao <span class="sc">%notin%</span> <span class="fu">c</span>(</span>
<span id="cb15-4"><a href="#cb15-4"></a>    <span class="st">"Pergunta Duplicada/Repetida"</span>,</span>
<span id="cb15-5"><a href="#cb15-5"></a>    <span class="st">"Não se trata de solicitação de informação"</span></span>
<span id="cb15-6"><a href="#cb15-6"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb15-7"><a href="#cb15-7"></a>  <span class="fu">mutate</span>(<span class="at">orgao =</span> <span class="fu">str_wrap</span>(orgao, <span class="dv">40</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb15-8"><a href="#cb15-8"></a>  <span class="co"># contagem de pedidos anuais</span></span>
<span id="cb15-9"><a href="#cb15-9"></a>  <span class="fu">add_count</span>(<span class="at">name =</span> <span class="st">"n_ano"</span>, <span class="at">ano =</span> <span class="fu">year</span>(mes_pedido)) <span class="sc">%&gt;%</span> </span>
<span id="cb15-10"><a href="#cb15-10"></a>  <span class="fu">add_count</span>(<span class="at">name =</span> <span class="st">"n_ano_orgao"</span>, ano, orgao) <span class="sc">%&gt;%</span> </span>
<span id="cb15-11"><a href="#cb15-11"></a>  <span class="fu">add_count</span>(<span class="at">name =</span> <span class="st">"n_ano_decisao"</span>, ano, decisao) <span class="sc">%&gt;%</span> </span>
<span id="cb15-12"><a href="#cb15-12"></a>  <span class="fu">add_count</span>(<span class="at">name =</span> <span class="st">"n_ano_decisao_orgao"</span>, ano, decisao, orgao) <span class="sc">%&gt;%</span> </span>
<span id="cb15-13"><a href="#cb15-13"></a>  <span class="co"># contagem de pedidos mensais</span></span>
<span id="cb15-14"><a href="#cb15-14"></a>  <span class="fu">add_count</span>(<span class="at">name =</span> <span class="st">"n_mes"</span>, mes_pedido) <span class="sc">%&gt;%</span> </span>
<span id="cb15-15"><a href="#cb15-15"></a>  <span class="fu">add_count</span>(<span class="at">name =</span> <span class="st">"n_mes_orgao"</span>, mes_pedido, orgao) <span class="sc">%&gt;%</span> </span>
<span id="cb15-16"><a href="#cb15-16"></a>  <span class="fu">add_count</span>(<span class="at">name =</span> <span class="st">"n_mes_decisao"</span>, mes_pedido, decisao) <span class="sc">%&gt;%</span> </span>
<span id="cb15-17"><a href="#cb15-17"></a>  <span class="fu">add_count</span>(<span class="at">name =</span> <span class="st">"n_mes_decisao_orgao"</span>, mes_pedido, decisao, orgao) <span class="sc">%&gt;%</span> </span>
<span id="cb15-18"><a href="#cb15-18"></a>  <span class="fu">group_by</span>(</span>
<span id="cb15-19"><a href="#cb15-19"></a>    ano,</span>
<span id="cb15-20"><a href="#cb15-20"></a>    mes_pedido,</span>
<span id="cb15-21"><a href="#cb15-21"></a>    decisao,</span>
<span id="cb15-22"><a href="#cb15-22"></a>    orgao,</span>
<span id="cb15-23"><a href="#cb15-23"></a>    n_ano,</span>
<span id="cb15-24"><a href="#cb15-24"></a>    n_ano_decisao,</span>
<span id="cb15-25"><a href="#cb15-25"></a>    n_ano_orgao,</span>
<span id="cb15-26"><a href="#cb15-26"></a>    n_ano_decisao_orgao,</span>
<span id="cb15-27"><a href="#cb15-27"></a>    n_mes,</span>
<span id="cb15-28"><a href="#cb15-28"></a>    n_mes_decisao,</span>
<span id="cb15-29"><a href="#cb15-29"></a>    n_mes_orgao,</span>
<span id="cb15-30"><a href="#cb15-30"></a>    n_mes_decisao_orgao</span>
<span id="cb15-31"><a href="#cb15-31"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb15-32"><a href="#cb15-32"></a>  <span class="fu">summarise</span>(<span class="at">.groups =</span> <span class="st">"drop"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p></p>
</section><section id="órgãos-que-mais-negaram-informações---mês-a-mês-2012-2022" class="level3"><h3 class="anchored" data-anchor-id="órgãos-que-mais-negaram-informações---mês-a-mês-2012-2022">Órgãos que mais negaram informações - mês a mês (2012-2022)</h3>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>month.abb2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) month.abb[<span class="fu">month</span>(x)]</span>
<span id="cb16-2"><a href="#cb16-2"></a></span>
<span id="cb16-3"><a href="#cb16-3"></a>taxas <span class="sc">%&gt;%</span> </span>
<span id="cb16-4"><a href="#cb16-4"></a>  <span class="fu">filter</span>(decisao <span class="sc">==</span> <span class="st">"Acesso Negado"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb16-5"><a href="#cb16-5"></a>  <span class="fu">transmute</span>(</span>
<span id="cb16-6"><a href="#cb16-6"></a>    mes_pedido,</span>
<span id="cb16-7"><a href="#cb16-7"></a>    orgao,</span>
<span id="cb16-8"><a href="#cb16-8"></a>    <span class="at">per =</span> n_mes_decisao_orgao <span class="sc">/</span> n_mes_decisao</span>
<span id="cb16-9"><a href="#cb16-9"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb16-10"><a href="#cb16-10"></a>  <span class="fu">group_by</span>(mes_pedido) <span class="sc">%&gt;%</span> </span>
<span id="cb16-11"><a href="#cb16-11"></a>  <span class="fu">slice_max</span>(<span class="at">order_by =</span> per, <span class="at">n =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb16-12"><a href="#cb16-12"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb16-13"><a href="#cb16-13"></a>  <span class="fu">mutate</span>(<span class="at">mes =</span> <span class="fu">month.abb2</span>(mes_pedido)) <span class="sc">%&gt;%</span></span>
<span id="cb16-14"><a href="#cb16-14"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> mes_pedido, <span class="at">y =</span> per, <span class="at">color =</span> orgao)) <span class="sc">+</span></span>
<span id="cb16-15"><a href="#cb16-15"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(</span>
<span id="cb16-16"><a href="#cb16-16"></a>    <span class="at">y =</span> <span class="dv">0</span>,</span>
<span id="cb16-17"><a href="#cb16-17"></a>    <span class="at">yend =</span> per,</span>
<span id="cb16-18"><a href="#cb16-18"></a>    <span class="at">x =</span> mes_pedido,</span>
<span id="cb16-19"><a href="#cb16-19"></a>    <span class="at">xend =</span> mes_pedido),</span>
<span id="cb16-20"><a href="#cb16-20"></a>    <span class="at">color =</span> <span class="st">"gray60"</span></span>
<span id="cb16-21"><a href="#cb16-21"></a>  ) <span class="sc">+</span></span>
<span id="cb16-22"><a href="#cb16-22"></a>  <span class="fu">geom_vline</span>(</span>
<span id="cb16-23"><a href="#cb16-23"></a>    <span class="at">xintercept =</span> <span class="fu">seq</span>(<span class="fu">ymd</span>(<span class="st">'2013-01-01'</span>), <span class="fu">ymd</span>(<span class="st">'2022-01-01'</span>), <span class="at">by =</span> <span class="st">'year'</span>),</span>
<span id="cb16-24"><a href="#cb16-24"></a>    <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"gray80"</span></span>
<span id="cb16-25"><a href="#cb16-25"></a>  ) <span class="sc">+</span></span>
<span id="cb16-26"><a href="#cb16-26"></a>  <span class="fu">scale_y_percent</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.7</span>)) <span class="sc">+</span></span>
<span id="cb16-27"><a href="#cb16-27"></a>  <span class="fu">scale_x_date</span>(</span>
<span id="cb16-28"><a href="#cb16-28"></a>    <span class="at">breaks =</span> <span class="fu">breaks_pretty</span>(<span class="dv">24</span>), </span>
<span id="cb16-29"><a href="#cb16-29"></a>    <span class="at">labels =</span> <span class="fu">label_date_short</span>(),</span>
<span id="cb16-30"><a href="#cb16-30"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="fu">ymd</span>(<span class="st">'2012-01-01'</span>), <span class="fu">ymd</span>(<span class="st">'2022-12-01'</span>)),</span>
<span id="cb16-31"><a href="#cb16-31"></a>    <span class="at">expand =</span> <span class="fu">c</span>(<span class="fl">0.</span>, <span class="dv">0</span>)</span>
<span id="cb16-32"><a href="#cb16-32"></a>  ) <span class="sc">+</span></span>
<span id="cb16-33"><a href="#cb16-33"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>, <span class="at">alpha =</span> .<span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb16-34"><a href="#cb16-34"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb16-35"><a href="#cb16-35"></a>    <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">str_extract</span>(orgao, <span class="st">"^[:upper:]+(?= )|^GSI-PR"</span>),</span>
<span id="cb16-36"><a href="#cb16-36"></a>        <span class="at">y =</span> per),</span>
<span id="cb16-37"><a href="#cb16-37"></a>    <span class="at">size =</span> <span class="fl">2.7</span>,</span>
<span id="cb16-38"><a href="#cb16-38"></a>    <span class="at">angle =</span> <span class="dv">90</span>,</span>
<span id="cb16-39"><a href="#cb16-39"></a>    <span class="at">fontface =</span> <span class="st">"bold"</span>,</span>
<span id="cb16-40"><a href="#cb16-40"></a>    <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb16-41"><a href="#cb16-41"></a>    <span class="at">hjust =</span> <span class="dv">0</span>,</span>
<span id="cb16-42"><a href="#cb16-42"></a>    <span class="at">check_overlap =</span> T</span>
<span id="cb16-43"><a href="#cb16-43"></a>  ) <span class="sc">+</span></span>
<span id="cb16-44"><a href="#cb16-44"></a>  <span class="fu">theme</span>(</span>
<span id="cb16-45"><a href="#cb16-45"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb16-46"><a href="#cb16-46"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">0</span>, <span class="st">"pt"</span>)),</span>
<span id="cb16-47"><a href="#cb16-47"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb16-48"><a href="#cb16-48"></a>    <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> .<span class="dv">7</span>),</span>
<span id="cb16-49"><a href="#cb16-49"></a>    <span class="co"># axis.text = element_text(size = 11),</span></span>
<span id="cb16-50"><a href="#cb16-50"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb16-51"><a href="#cb16-51"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>),</span>
<span id="cb16-52"><a href="#cb16-52"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>)</span>
<span id="cb16-53"><a href="#cb16-53"></a>  ) <span class="sc">+</span></span>
<span id="cb16-54"><a href="#cb16-54"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">title.position =</span> <span class="st">"top"</span>)) <span class="sc">+</span></span>
<span id="cb16-55"><a href="#cb16-55"></a>  <span class="fu">labs</span>(</span>
<span id="cb16-56"><a href="#cb16-56"></a>    <span class="at">color =</span> <span class="st">"Sigla do órgão que mais negou acesso a informação no mês:"</span>,</span>
<span id="cb16-57"><a href="#cb16-57"></a>    <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb16-58"><a href="#cb16-58"></a>    <span class="at">y =</span> <span class="st">"% do total de acessos negados</span><span class="sc">\n</span><span class="st">entre todos os pedidos no FalaBr"</span></span>
<span id="cb16-59"><a href="#cb16-59"></a>  )</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="0-monitoramento_files/figure-html/plot-acessos-negados-geral-1.png" class="img-fluid" width="1056"></p>
</div>
</div>
<p></p>
</section><section id="poucos-órgãos-são-responsáveis-por-mais-da-metade-das-negativas-do-falabr" class="level3"><h3 class="anchored" data-anchor-id="poucos-órgãos-são-responsáveis-por-mais-da-metade-das-negativas-do-falabr">Poucos órgãos são responsáveis por mais da metade das negativas do FalaBr</h3>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>top_opacos <span class="ot">&lt;-</span> taxas <span class="sc">%&gt;%</span> </span>
<span id="cb17-2"><a href="#cb17-2"></a>  <span class="fu">filter</span>(decisao <span class="sc">==</span> <span class="st">"Acesso Negado"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-3"><a href="#cb17-3"></a>  <span class="fu">distinct</span>(</span>
<span id="cb17-4"><a href="#cb17-4"></a>    ano,</span>
<span id="cb17-5"><a href="#cb17-5"></a>    orgao,</span>
<span id="cb17-6"><a href="#cb17-6"></a>    n_ano_decisao,</span>
<span id="cb17-7"><a href="#cb17-7"></a>    n_ano_decisao_orgao,</span>
<span id="cb17-8"><a href="#cb17-8"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb17-9"><a href="#cb17-9"></a>  <span class="fu">arrange</span>(ano, <span class="sc">-</span>n_ano_decisao_orgao) <span class="sc">%&gt;%</span> </span>
<span id="cb17-10"><a href="#cb17-10"></a>  <span class="fu">mutate</span>(<span class="at">per =</span> n_ano_decisao_orgao <span class="sc">/</span> n_ano_decisao) <span class="sc">%&gt;%</span></span>
<span id="cb17-11"><a href="#cb17-11"></a>  <span class="fu">group_by</span>(ano) <span class="sc">%&gt;%</span> </span>
<span id="cb17-12"><a href="#cb17-12"></a>  <span class="fu">mutate</span>(</span>
<span id="cb17-13"><a href="#cb17-13"></a>    <span class="at">ord =</span> <span class="fu">row_number</span>(),</span>
<span id="cb17-14"><a href="#cb17-14"></a>    <span class="at">per_acum =</span> <span class="fu">cumsum</span>(per),</span>
<span id="cb17-15"><a href="#cb17-15"></a>    <span class="at">cutoff =</span> <span class="fu">lag</span>(per_acum <span class="sc">&lt;=</span> .<span class="dv">5</span>),</span>
<span id="cb17-16"><a href="#cb17-16"></a>    <span class="at">cutoff =</span> <span class="fu">if_else</span>(<span class="fu">is.na</span>(cutoff) <span class="sc">|</span> cutoff, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>)</span>
<span id="cb17-17"><a href="#cb17-17"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb17-18"><a href="#cb17-18"></a>  <span class="fu">filter</span>(cutoff) <span class="sc">%&gt;%</span> </span>
<span id="cb17-19"><a href="#cb17-19"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb17-20"><a href="#cb17-20"></a>  <span class="fu">mutate</span>(<span class="at">sigla =</span> <span class="fu">str_extract</span>(orgao, <span class="st">"^[:upper:]+(?= )|^GSI-PR"</span>))</span>
<span id="cb17-21"><a href="#cb17-21"></a></span>
<span id="cb17-22"><a href="#cb17-22"></a>top_opacos_pqn <span class="ot">&lt;-</span> top_opacos <span class="sc">%&gt;%</span> </span>
<span id="cb17-23"><a href="#cb17-23"></a>  <span class="fu">filter</span>(per <span class="sc">&lt;=</span> .<span class="dv">05</span>, ano <span class="sc">&gt;</span> <span class="dv">2016</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-24"><a href="#cb17-24"></a>  <span class="fu">arrange</span>(ano, <span class="sc">-</span>per) <span class="sc">%&gt;%</span> </span>
<span id="cb17-25"><a href="#cb17-25"></a>  <span class="fu">group_by</span>(ano) <span class="sc">%&gt;%</span> </span>
<span id="cb17-26"><a href="#cb17-26"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb17-27"><a href="#cb17-27"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb17-28"><a href="#cb17-28"></a>  <span class="fu">mutate</span>(</span>
<span id="cb17-29"><a href="#cb17-29"></a>    <span class="at">sigla =</span> <span class="fu">map</span>(data, pull, sigla),</span>
<span id="cb17-30"><a href="#cb17-30"></a>    <span class="at">sigla =</span> <span class="fu">paste</span>(sigla),</span>
<span id="cb17-31"><a href="#cb17-31"></a>    <span class="at">sigla =</span> <span class="fu">str_remove_all</span>(sigla, <span class="st">"^c</span><span class="sc">\\</span><span class="st">(|</span><span class="sc">\\\"</span><span class="st">|</span><span class="sc">\\</span><span class="st">)"</span> ),</span>
<span id="cb17-32"><a href="#cb17-32"></a>    <span class="at">sigla =</span> <span class="fu">str_replace_all</span>(sigla, <span class="st">", "</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>),</span>
<span id="cb17-33"><a href="#cb17-33"></a>    <span class="co"># orgao = map(data, pull, orgao),</span></span>
<span id="cb17-34"><a href="#cb17-34"></a>    <span class="co"># orgao = paste(orgao),</span></span>
<span id="cb17-35"><a href="#cb17-35"></a>    <span class="co"># orgao = str_remove_all(orgao, "^c\\(|\\\"|\\)" ),</span></span>
<span id="cb17-36"><a href="#cb17-36"></a>    <span class="co"># orgao = str_replace_all(orgao, ", ", ",\n"),</span></span>
<span id="cb17-37"><a href="#cb17-37"></a>    <span class="at">orgao =</span> <span class="st">"menores"</span>,</span>
<span id="cb17-38"><a href="#cb17-38"></a>    <span class="at">per =</span> <span class="fu">map</span>(data, select, per),</span>
<span id="cb17-39"><a href="#cb17-39"></a>    <span class="at">per =</span> <span class="fu">map_dbl</span>(per, sum),</span>
<span id="cb17-40"><a href="#cb17-40"></a>    <span class="at">qtd_orgaos =</span> <span class="fu">map_int</span>(data, nrow)</span>
<span id="cb17-41"><a href="#cb17-41"></a>  ) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>data) </span>
<span id="cb17-42"><a href="#cb17-42"></a></span>
<span id="cb17-43"><a href="#cb17-43"></a>top_opacos2 <span class="ot">&lt;-</span> top_opacos <span class="sc">%&gt;%</span> </span>
<span id="cb17-44"><a href="#cb17-44"></a>  <span class="fu">filter</span>(per <span class="sc">&gt;</span> .<span class="dv">05</span> <span class="sc">|</span> ano <span class="sc">&lt;</span> <span class="dv">2017</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb17-45"><a href="#cb17-45"></a>  <span class="fu">mutate</span>(<span class="at">qtd_orgaos =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb17-46"><a href="#cb17-46"></a>  <span class="fu">bind_rows</span>(top_opacos_pqn)</span>
<span id="cb17-47"><a href="#cb17-47"></a></span>
<span id="cb17-48"><a href="#cb17-48"></a><span class="co">#' paleta de cores</span></span>
<span id="cb17-49"><a href="#cb17-49"></a>pal <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb17-50"><a href="#cb17-50"></a>  cores_tb[[<span class="st">"laranja"</span>]],</span>
<span id="cb17-51"><a href="#cb17-51"></a>  <span class="st">"#0c93a8"</span>,</span>
<span id="cb17-52"><a href="#cb17-52"></a>  cores_tb[[<span class="st">"azul"</span>]],</span>
<span id="cb17-53"><a href="#cb17-53"></a>  cores_aep[[<span class="st">"marrom"</span>]],</span>
<span id="cb17-54"><a href="#cb17-54"></a>  cores_aep[[<span class="st">"cinza"</span>]],</span>
<span id="cb17-55"><a href="#cb17-55"></a>  cores_aep[[<span class="st">"laranja"</span>]],</span>
<span id="cb17-56"><a href="#cb17-56"></a>  <span class="st">"ivory"</span>,</span>
<span id="cb17-57"><a href="#cb17-57"></a>  cores_aep[[<span class="st">"rosa"</span>]]</span>
<span id="cb17-58"><a href="#cb17-58"></a>)</span>
<span id="cb17-59"><a href="#cb17-59"></a></span>
<span id="cb17-60"><a href="#cb17-60"></a><span class="co">#' paleta de cores associada aos órgãos</span></span>
<span id="cb17-61"><a href="#cb17-61"></a>cores <span class="ot">&lt;-</span> top_opacos2 <span class="sc">%&gt;%</span></span>
<span id="cb17-62"><a href="#cb17-62"></a>  <span class="fu">select</span>(orgao, per) <span class="sc">%&gt;%</span></span>
<span id="cb17-63"><a href="#cb17-63"></a>  <span class="fu">group_by</span>(orgao) <span class="sc">%&gt;%</span></span>
<span id="cb17-64"><a href="#cb17-64"></a>  <span class="fu">summarise</span>(<span class="at">per =</span> <span class="fu">sum</span>(per), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-65"><a href="#cb17-65"></a>  <span class="fu">arrange</span>(per) <span class="sc">%&gt;%</span></span>
<span id="cb17-66"><a href="#cb17-66"></a>  <span class="fu">mutate</span>(<span class="at">cor =</span> <span class="fu">colorRampPalette</span>(pal)(<span class="dv">13</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb17-67"><a href="#cb17-67"></a>  <span class="fu">select</span>(<span class="sc">-</span>per) <span class="sc">%&gt;%</span></span>
<span id="cb17-68"><a href="#cb17-68"></a>  <span class="fu">deframe</span>()</span>
<span id="cb17-69"><a href="#cb17-69"></a></span>
<span id="cb17-70"><a href="#cb17-70"></a>top_opacos2 <span class="sc">%&gt;%</span></span>
<span id="cb17-71"><a href="#cb17-71"></a>  <span class="fu">mutate</span>(<span class="at">sigla =</span> <span class="fu">if_else</span>(orgao <span class="sc">!=</span> <span class="st">"menores"</span>, </span>
<span id="cb17-72"><a href="#cb17-72"></a>                         <span class="fu">glue</span>(<span class="st">"{sigla}</span><span class="sc">\n</span><span class="st"> {my_lbl(per)}"</span>),</span>
<span id="cb17-73"><a href="#cb17-73"></a>                         <span class="fu">glue</span>(<span class="st">"(&lt; 5%)</span><span class="sc">\n</span><span class="st">{sigla}</span><span class="sc">\n</span><span class="st">soma: {my_lbl(per)}"</span>)</span>
<span id="cb17-74"><a href="#cb17-74"></a>                         )) <span class="sc">%&gt;%</span> </span>
<span id="cb17-75"><a href="#cb17-75"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ano, <span class="at">y =</span> per, <span class="at">fill =</span> <span class="fu">fct_reorder2</span>(orgao, <span class="sc">-</span>per, <span class="sc">-</span>ano))) <span class="sc">+</span></span>
<span id="cb17-76"><a href="#cb17-76"></a>  <span class="fu">geom_col</span>(<span class="at">color =</span> <span class="st">"gray60"</span>) <span class="sc">+</span> </span>
<span id="cb17-77"><a href="#cb17-77"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> sigla), </span>
<span id="cb17-78"><a href="#cb17-78"></a>            <span class="at">size =</span> <span class="fl">2.7</span>, <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> .<span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb17-79"><a href="#cb17-79"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb17-80"><a href="#cb17-80"></a>  <span class="fu">labs</span>(</span>
<span id="cb17-81"><a href="#cb17-81"></a>    <span class="at">fill =</span> <span class="st">"Sigla do órgão"</span>,</span>
<span id="cb17-82"><a href="#cb17-82"></a>    <span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span></span>
<span id="cb17-83"><a href="#cb17-83"></a>  ) <span class="sc">+</span></span>
<span id="cb17-84"><a href="#cb17-84"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">2012</span><span class="sc">:</span><span class="dv">2022</span>) <span class="sc">+</span></span>
<span id="cb17-85"><a href="#cb17-85"></a>  <span class="co">#scale_fill_ordinal() +</span></span>
<span id="cb17-86"><a href="#cb17-86"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> cores) <span class="sc">+</span></span>
<span id="cb17-87"><a href="#cb17-87"></a>  hrbrthemes<span class="sc">::</span><span class="fu">scale_y_percent</span>() <span class="sc">+</span></span>
<span id="cb17-88"><a href="#cb17-88"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">title.position =</span> <span class="st">"top"</span>, <span class="at">reverse =</span> T)) <span class="sc">+</span></span>
<span id="cb17-89"><a href="#cb17-89"></a>  <span class="fu">theme</span>(</span>
<span id="cb17-90"><a href="#cb17-90"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb17-91"><a href="#cb17-91"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">0</span>, <span class="st">"pt"</span>))</span>
<span id="cb17-92"><a href="#cb17-92"></a>  )</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="0-monitoramento_files/figure-html/plot-metade-das-negativas-1.png" class="img-fluid" width="864"></p>
</div>
</div>
<p></p>
</section><section id="mediana-da-taxa-interna-de-acessos-negados-por-órgão-2012-2022" class="level3"><h3 class="anchored" data-anchor-id="mediana-da-taxa-interna-de-acessos-negados-por-órgão-2012-2022">Mediana da taxa interna de acessos negados por órgão (2012-2022)</h3>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>taxas <span class="sc">%&gt;%</span> </span>
<span id="cb18-2"><a href="#cb18-2"></a>  <span class="co">#filter(decisao == "Acesso Negado") %&gt;% </span></span>
<span id="cb18-3"><a href="#cb18-3"></a>  <span class="fu">mutate</span>(</span>
<span id="cb18-4"><a href="#cb18-4"></a>    <span class="at">taxa_decisao_interna =</span> n_ano_decisao_orgao <span class="sc">/</span> n_ano_orgao,</span>
<span id="cb18-5"><a href="#cb18-5"></a>    <span class="at">taxa_decisao_relativa =</span> n_ano_decisao_orgao <span class="sc">/</span> n_ano_decisao</span>
<span id="cb18-6"><a href="#cb18-6"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb18-7"><a href="#cb18-7"></a>  <span class="fu">group_by</span>(ano, decisao) <span class="sc">%&gt;%</span></span>
<span id="cb18-8"><a href="#cb18-8"></a>  <span class="fu">summarise</span>(<span class="at">taxa_decisao_mediana =</span> <span class="fu">median</span>(taxa_decisao_interna)) <span class="sc">%&gt;%</span></span>
<span id="cb18-9"><a href="#cb18-9"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb18-10"><a href="#cb18-10"></a>  <span class="fu">filter</span>(decisao <span class="sc">==</span> <span class="st">"Acesso Negado"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb18-11"><a href="#cb18-11"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ano, <span class="at">y =</span> taxa_decisao_mediana)) <span class="sc">+</span></span>
<span id="cb18-12"><a href="#cb18-12"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"gray60"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb18-13"><a href="#cb18-13"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> cores_aep[[<span class="st">"rosa"</span>]], <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb18-14"><a href="#cb18-14"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">my_lbl</span>(taxa_decisao_mediana)), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">color =</span> cores_aep[[<span class="st">'rosa'</span>]]) <span class="sc">+</span></span>
<span id="cb18-15"><a href="#cb18-15"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">2012</span><span class="sc">:</span><span class="dv">2022</span>) <span class="sc">+</span></span>
<span id="cb18-16"><a href="#cb18-16"></a>  <span class="fu">scale_y_percent</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb18-17"><a href="#cb18-17"></a>  <span class="fu">labs</span>(</span>
<span id="cb18-18"><a href="#cb18-18"></a>    <span class="at">y =</span> <span class="st">"Acessos negados por órgão - mediana anual</span><span class="sc">\n</span><span class="st">como % do total de pedidos de um órgão"</span>,</span>
<span id="cb18-19"><a href="#cb18-19"></a>    <span class="at">x =</span> <span class="cn">NULL</span></span>
<span id="cb18-20"><a href="#cb18-20"></a>  )</span>
<span id="cb18-21"><a href="#cb18-21"></a><span class="co">#&gt; `summarise()` has grouped output by 'ano'. You can override using the `.groups`</span></span>
<span id="cb18-22"><a href="#cb18-22"></a><span class="co">#&gt; argument.</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="0-monitoramento_files/figure-html/plot-mediana-acessos-negados-interno-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p></p>
</section><section id="distribuição-das-taxas-internas-de-acessos-negados-por-órgão" class="level3"><h3 class="anchored" data-anchor-id="distribuição-das-taxas-internas-de-acessos-negados-por-órgão">Distribuição das taxas internas de acessos negados por órgão</h3>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>taxas <span class="sc">%&gt;%</span> </span>
<span id="cb19-2"><a href="#cb19-2"></a>  <span class="fu">filter</span>(decisao <span class="sc">==</span> <span class="st">"Acesso Negado"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb19-3"><a href="#cb19-3"></a>  <span class="fu">mutate</span>(</span>
<span id="cb19-4"><a href="#cb19-4"></a>    <span class="at">taxa_decisao_interna =</span> n_ano_decisao_orgao <span class="sc">/</span> n_ano_orgao,</span>
<span id="cb19-5"><a href="#cb19-5"></a>    <span class="at">taxa_decisao_relativa =</span> n_ano_decisao_orgao <span class="sc">/</span> n_ano_decisao</span>
<span id="cb19-6"><a href="#cb19-6"></a>  ) <span class="sc">%&gt;%</span> <span class="co">#glimpse() </span></span>
<span id="cb19-7"><a href="#cb19-7"></a>  <span class="fu">group_by</span>(ano, decisao) <span class="sc">%&gt;%</span> </span>
<span id="cb19-8"><a href="#cb19-8"></a>  <span class="fu">mutate</span>(<span class="at">taxa_decisao_mediana =</span> <span class="fu">median</span>(taxa_decisao_interna)) <span class="sc">%&gt;%</span> </span>
<span id="cb19-9"><a href="#cb19-9"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb19-10"><a href="#cb19-10"></a>  <span class="fu">select</span>(ano, decisao, orgao, <span class="fu">contains</span>(<span class="st">"taxa"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb19-11"><a href="#cb19-11"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb19-12"><a href="#cb19-12"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ano, </span>
<span id="cb19-13"><a href="#cb19-13"></a>             <span class="at">y =</span> taxa_decisao_interna,</span>
<span id="cb19-14"><a href="#cb19-14"></a>             <span class="at">color =</span> decisao)) <span class="sc">+</span></span>
<span id="cb19-15"><a href="#cb19-15"></a>  ggbeeswarm<span class="sc">::</span><span class="fu">geom_quasirandom</span>(<span class="at">alpha =</span> .<span class="dv">6</span>, <span class="at">show.legend =</span> F) <span class="sc">+</span></span>
<span id="cb19-16"><a href="#cb19-16"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb19-17"><a href="#cb19-17"></a>    <span class="fu">aes</span>(</span>
<span id="cb19-18"><a href="#cb19-18"></a>      <span class="at">x =</span> ano,</span>
<span id="cb19-19"><a href="#cb19-19"></a>      <span class="at">y =</span> taxa_decisao_mediana,</span>
<span id="cb19-20"><a href="#cb19-20"></a>      ),</span>
<span id="cb19-21"><a href="#cb19-21"></a>    <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb19-22"><a href="#cb19-22"></a>    <span class="at">inherit.aes =</span> F,</span>
<span id="cb19-23"><a href="#cb19-23"></a>    <span class="at">shape =</span> <span class="dv">45</span>,</span>
<span id="cb19-24"><a href="#cb19-24"></a>    <span class="at">size =</span> <span class="dv">15</span></span>
<span id="cb19-25"><a href="#cb19-25"></a>  ) <span class="sc">+</span></span>
<span id="cb19-26"><a href="#cb19-26"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb19-27"><a href="#cb19-27"></a>    <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">str_extract</span>(orgao, <span class="st">"^[:upper:]+(?= )|^GSI-PR|^CEITEC</span><span class="sc">\\</span><span class="st">/S</span><span class="sc">\\</span><span class="st">.A</span><span class="sc">\\</span><span class="st">."</span>)),</span>
<span id="cb19-28"><a href="#cb19-28"></a>    <span class="at">data =</span> . <span class="sc">%&gt;%</span> <span class="fu">filter</span>(taxa_decisao_interna <span class="sc">&gt;=</span> .<span class="dv">3</span>),</span>
<span id="cb19-29"><a href="#cb19-29"></a>    <span class="at">size =</span> <span class="fl">2.7</span>,</span>
<span id="cb19-30"><a href="#cb19-30"></a>    <span class="at">angle =</span> <span class="dv">45</span>,</span>
<span id="cb19-31"><a href="#cb19-31"></a>    <span class="at">hjust =</span> <span class="dv">0</span></span>
<span id="cb19-32"><a href="#cb19-32"></a>  ) <span class="sc">+</span></span>
<span id="cb19-33"><a href="#cb19-33"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> cores_decisao, <span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb19-34"><a href="#cb19-34"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> decisao, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb19-35"><a href="#cb19-35"></a>  <span class="fu">scale_y_percent</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb19-36"><a href="#cb19-36"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">2012</span><span class="sc">:</span><span class="dv">2021</span>) <span class="sc">+</span></span>
<span id="cb19-37"><a href="#cb19-37"></a>  <span class="fu">theme</span>(<span class="at">strip.text =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb19-38"><a href="#cb19-38"></a>  <span class="fu">labs</span>(</span>
<span id="cb19-39"><a href="#cb19-39"></a>    <span class="at">subtitle =</span> <span class="st">"Cada ponto representa um órgão - média anual"</span>,</span>
<span id="cb19-40"><a href="#cb19-40"></a>    <span class="at">y =</span> <span class="st">"Acessos negados por órgão</span><span class="sc">\n</span><span class="st">como % do total de pedidos de um órgão"</span>,</span>
<span id="cb19-41"><a href="#cb19-41"></a>    <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb19-42"><a href="#cb19-42"></a>    <span class="at">color =</span> <span class="cn">NULL</span></span>
<span id="cb19-43"><a href="#cb19-43"></a>  )</span>
<span id="cb19-44"><a href="#cb19-44"></a><span class="co">#&gt; Warning: Removed 2 rows containing missing values (geom_text).</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="0-monitoramento_files/figure-html/plot-distribuicao-acessos-negados-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p></p>
</section></section><section id="tempo-de-resposta-dos-pedidos" class="level2"><h2 class="anchored" data-anchor-id="tempo-de-resposta-dos-pedidos">Tempo de resposta dos pedidos</h2>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>cores <span class="ot">&lt;-</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(</span>
<span id="cb20-2"><a href="#cb20-2"></a>  cores_aep[[<span class="st">"marrom"</span>]],</span>
<span id="cb20-3"><a href="#cb20-3"></a>  cores_aep[[<span class="st">"rosa"</span>]],</span>
<span id="cb20-4"><a href="#cb20-4"></a>  cores_aep[[<span class="st">"laranja"</span>]],</span>
<span id="cb20-5"><a href="#cb20-5"></a>  cores_tb[[<span class="st">"laranja"</span>]],</span>
<span id="cb20-6"><a href="#cb20-6"></a>  cores_tb[[<span class="st">"azul"</span>]]</span>
<span id="cb20-7"><a href="#cb20-7"></a>  ))(<span class="dv">8</span>)</span>
<span id="cb20-8"><a href="#cb20-8"></a></span>
<span id="cb20-9"><a href="#cb20-9"></a>pedidos_prazo <span class="ot">&lt;-</span> pedidos_cgu <span class="sc">%&gt;%</span> </span>
<span id="cb20-10"><a href="#cb20-10"></a>  <span class="fu">filter</span>(</span>
<span id="cb20-11"><a href="#cb20-11"></a>    decisao <span class="sc">%notin%</span> <span class="fu">c</span>(</span>
<span id="cb20-12"><a href="#cb20-12"></a>      <span class="st">"Pergunta Duplicada/Repetida"</span>,</span>
<span id="cb20-13"><a href="#cb20-13"></a>      <span class="st">"Não se trata de solicitação de informação"</span> </span>
<span id="cb20-14"><a href="#cb20-14"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb20-15"><a href="#cb20-15"></a>  <span class="fu">transmute</span>(</span>
<span id="cb20-16"><a href="#cb20-16"></a>    id_pedido, </span>
<span id="cb20-17"><a href="#cb20-17"></a>    orgao,</span>
<span id="cb20-18"><a href="#cb20-18"></a>    data_pedido,</span>
<span id="cb20-19"><a href="#cb20-19"></a>    data_resposta,</span>
<span id="cb20-20"><a href="#cb20-20"></a>    prazo,</span>
<span id="cb20-21"><a href="#cb20-21"></a>    <span class="at">dias_corridos =</span> data_resposta <span class="sc">-</span> data_pedido,</span>
<span id="cb20-22"><a href="#cb20-22"></a>    <span class="at">dias_corridos_fx =</span> <span class="fu">case_when</span>(</span>
<span id="cb20-23"><a href="#cb20-23"></a>      dias_corridos <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span>  <span class="st">" 0 dias corridos"</span>,</span>
<span id="cb20-24"><a href="#cb20-24"></a>      dias_corridos <span class="sc">&lt;=</span> <span class="dv">5</span> <span class="sc">~</span>  <span class="st">" 1 até 5 dias"</span>,</span>
<span id="cb20-25"><a href="#cb20-25"></a>      dias_corridos <span class="sc">&lt;=</span> <span class="dv">10</span> <span class="sc">~</span> <span class="st">" 6 até 10 dias"</span>,</span>
<span id="cb20-26"><a href="#cb20-26"></a>      dias_corridos <span class="sc">&lt;=</span> <span class="dv">15</span> <span class="sc">~</span> <span class="st">"11 até 15 dias"</span>,</span>
<span id="cb20-27"><a href="#cb20-27"></a>      dias_corridos <span class="sc">&lt;=</span> <span class="dv">20</span> <span class="sc">~</span> <span class="st">"16 até 20 dias"</span>,</span>
<span id="cb20-28"><a href="#cb20-28"></a>      dias_corridos <span class="sc">&lt;=</span> <span class="dv">25</span> <span class="sc">~</span> <span class="st">"21 até 25 dias"</span>,</span>
<span id="cb20-29"><a href="#cb20-29"></a>      dias_corridos <span class="sc">&lt;=</span> <span class="dv">30</span> <span class="sc">~</span> <span class="st">"26 até 30 dias"</span>,</span>
<span id="cb20-30"><a href="#cb20-30"></a>      <span class="cn">TRUE</span> <span class="sc">~</span>  <span class="st">"Acima de 30 dias"</span></span>
<span id="cb20-31"><a href="#cb20-31"></a>    ),</span>
<span id="cb20-32"><a href="#cb20-32"></a>    <span class="at">dias_corridos_fx =</span> <span class="fu">ordered</span>(dias_corridos_fx, <span class="at">levels =</span> <span class="fu">c</span>(</span>
<span id="cb20-33"><a href="#cb20-33"></a>      <span class="st">" 0 dias corridos"</span>,</span>
<span id="cb20-34"><a href="#cb20-34"></a>      <span class="st">" 1 até 5 dias"</span>,</span>
<span id="cb20-35"><a href="#cb20-35"></a>      <span class="st">" 6 até 10 dias"</span>,</span>
<span id="cb20-36"><a href="#cb20-36"></a>      <span class="st">"11 até 15 dias"</span>,</span>
<span id="cb20-37"><a href="#cb20-37"></a>      <span class="st">"16 até 20 dias"</span>,</span>
<span id="cb20-38"><a href="#cb20-38"></a>      <span class="st">"21 até 25 dias"</span>,</span>
<span id="cb20-39"><a href="#cb20-39"></a>      <span class="st">"26 até 30 dias"</span>,</span>
<span id="cb20-40"><a href="#cb20-40"></a>      <span class="st">"Acima de 30 dias"</span></span>
<span id="cb20-41"><a href="#cb20-41"></a>    ))</span>
<span id="cb20-42"><a href="#cb20-42"></a>  )</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p></p>
<section id="frequência-de-dias-corridos-para-resposta-à-lai-2012-2022" class="level3"><h3 class="anchored" data-anchor-id="frequência-de-dias-corridos-para-resposta-à-lai-2012-2022">Frequência de dias corridos para resposta à LAI (2012-2022)</h3>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>pedidos_prazo <span class="sc">%&gt;%</span> </span>
<span id="cb21-2"><a href="#cb21-2"></a>  <span class="fu">count</span>(<span class="at">name =</span> <span class="st">'n_pedidos_ano_prazo'</span>, dias_corridos_fx, <span class="at">ano =</span> <span class="fu">year</span>(data_pedido), <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-3"><a href="#cb21-3"></a>  <span class="fu">add_count</span>(<span class="at">name =</span> <span class="st">'n_pedidos_ano'</span>, ano, <span class="at">wt =</span> n_pedidos_ano_prazo) <span class="sc">%&gt;%</span> </span>
<span id="cb21-4"><a href="#cb21-4"></a>  <span class="fu">mutate</span>(<span class="at">per =</span> n_pedidos_ano_prazo <span class="sc">/</span> n_pedidos_ano) <span class="sc">%&gt;%</span> </span>
<span id="cb21-5"><a href="#cb21-5"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(ano, <span class="sc">-</span>ano), <span class="at">y =</span> per, <span class="at">fill =</span> dias_corridos_fx, <span class="at">group =</span> dias_corridos_fx)) <span class="sc">+</span></span>
<span id="cb21-6"><a href="#cb21-6"></a>  <span class="fu">geom_col</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>, <span class="at">width =</span> .<span class="dv">7</span>,</span>
<span id="cb21-7"><a href="#cb21-7"></a>           <span class="at">position =</span> <span class="fu">position_dodge</span>(.<span class="dv">7</span>)) <span class="sc">+</span></span>
<span id="cb21-8"><a href="#cb21-8"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb21-9"><a href="#cb21-9"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">my_lbl</span>(per)), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">size =</span> <span class="fl">2.5</span>) <span class="sc">+</span></span>
<span id="cb21-10"><a href="#cb21-10"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> cores) <span class="sc">+</span></span>
<span id="cb21-11"><a href="#cb21-11"></a>  <span class="fu">scale_y_percent</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">36</span>), <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">15</span>, .<span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb21-12"><a href="#cb21-12"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> dias_corridos_fx, <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">scales =</span> <span class="st">"free_x"</span>) <span class="sc">+</span></span>
<span id="cb21-13"><a href="#cb21-13"></a>  <span class="fu">labs</span>(</span>
<span id="cb21-14"><a href="#cb21-14"></a>    <span class="at">fill =</span> <span class="st">"Dias corridos"</span>,</span>
<span id="cb21-15"><a href="#cb21-15"></a>    <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb21-16"><a href="#cb21-16"></a>    <span class="at">y =</span> <span class="st">"% de pedidos atendidos no prazo de referência"</span></span>
<span id="cb21-17"><a href="#cb21-17"></a>  ) <span class="sc">+</span></span>
<span id="cb21-18"><a href="#cb21-18"></a>  <span class="fu">theme</span>(</span>
<span id="cb21-19"><a href="#cb21-19"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="dv">0</span>)</span>
<span id="cb21-20"><a href="#cb21-20"></a>  )</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="0-monitoramento_files/figure-html/plot-frequencia-dias-corridos-1.png" class="img-fluid" width="576"></p>
</div>
</div>
<p></p>
</section><section id="tempo-médio-de-resposta-por-ano" class="level3"><h3 class="anchored" data-anchor-id="tempo-médio-de-resposta-por-ano">Tempo médio de resposta por ano</h3>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>my_lbl_days <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">str_glue</span>(<span class="st">"{round(x)} dias"</span>)</span>
<span id="cb22-2"><a href="#cb22-2"></a></span>
<span id="cb22-3"><a href="#cb22-3"></a>pedidos_prazo <span class="sc">%&gt;%</span> </span>
<span id="cb22-4"><a href="#cb22-4"></a>  <span class="fu">group_by</span>(<span class="at">ano =</span> <span class="fu">year</span>(data_pedido)) <span class="sc">%&gt;%</span> </span>
<span id="cb22-5"><a href="#cb22-5"></a>  <span class="fu">summarise</span>(<span class="at">media_dias_corridos_por_ano =</span> <span class="fu">mean</span>(dias_corridos), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb22-6"><a href="#cb22-6"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ano, <span class="at">y =</span> media_dias_corridos_por_ano)) <span class="sc">+</span></span>
<span id="cb22-7"><a href="#cb22-7"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> cores_tb[[<span class="st">"azul"</span>]]) <span class="sc">+</span></span>
<span id="cb22-8"><a href="#cb22-8"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">my_lbl_days</span>(media_dias_corridos_por_ano)), <span class="at">vjust =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb22-9"><a href="#cb22-9"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">2012</span><span class="sc">:</span><span class="dv">2022</span>) <span class="sc">+</span></span>
<span id="cb22-10"><a href="#cb22-10"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">25</span>, <span class="dv">5</span>), <span class="at">labels =</span> <span class="fu">str_glue</span>(<span class="st">"{seq(0, 25, 5)} dias"</span>),</span>
<span id="cb22-11"><a href="#cb22-11"></a>                     <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">24</span>)) <span class="sc">+</span></span>
<span id="cb22-12"><a href="#cb22-12"></a>  <span class="fu">labs</span>(</span>
<span id="cb22-13"><a href="#cb22-13"></a>    <span class="at">x =</span> <span class="st">"Ano de registro do pedido"</span>,</span>
<span id="cb22-14"><a href="#cb22-14"></a>    <span class="at">y =</span> <span class="st">"Média de dias corridos para resposta do pedido"</span></span>
<span id="cb22-15"><a href="#cb22-15"></a>  )</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="0-monitoramento_files/figure-html/plot-tempo-medio-de-resposta-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p></p>
</section></section><section id="recursos" class="level2"><h2 class="anchored" data-anchor-id="recursos">Recursos</h2>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a>pedidos_e_recursos <span class="ot">&lt;-</span> recursos_cgu <span class="sc">%&gt;%</span></span>
<span id="cb23-2"><a href="#cb23-2"></a>  <span class="fu">arrange</span>(<span class="fu">as.integer</span>(id_pedido), instancia) <span class="sc">%&gt;%</span> </span>
<span id="cb23-3"><a href="#cb23-3"></a>  <span class="fu">group_by</span>(id_pedido) <span class="sc">%&gt;%</span> </span>
<span id="cb23-4"><a href="#cb23-4"></a>  <span class="fu">filter</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="fu">max</span>(<span class="fu">row_number</span>())) <span class="sc">%&gt;%</span> </span>
<span id="cb23-5"><a href="#cb23-5"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb23-6"><a href="#cb23-6"></a>  <span class="fu">right_join</span>(pedidos_cgu) <span class="sc">%&gt;%</span> </span>
<span id="cb23-7"><a href="#cb23-7"></a>  <span class="fu">arrange</span>(<span class="fu">as.integer</span>(id_pedido)) <span class="sc">%&gt;%</span> </span>
<span id="cb23-8"><a href="#cb23-8"></a>  <span class="fu">transmute</span>(id_recurso, id_pedido, </span>
<span id="cb23-9"><a href="#cb23-9"></a>            <span class="at">ano_pedido =</span> <span class="fu">year</span>(mes_pedido),</span>
<span id="cb23-10"><a href="#cb23-10"></a>            orgao,</span>
<span id="cb23-11"><a href="#cb23-11"></a>            <span class="at">entrou_com_recurso =</span> <span class="sc">!</span><span class="fu">is.na</span>(id_recurso),</span>
<span id="cb23-12"><a href="#cb23-12"></a>            tipo_recurso,</span>
<span id="cb23-13"><a href="#cb23-13"></a>            tipo_resposta,</span>
<span id="cb23-14"><a href="#cb23-14"></a>            decisao</span>
<span id="cb23-15"><a href="#cb23-15"></a>            )</span>
<span id="cb23-16"><a href="#cb23-16"></a><span class="co">#&gt; Joining, by = "id_pedido"</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p></p>
<section id="de-pedidos-que-entraram-ou-não-com-recurso" class="level3"><h3 class="anchored" data-anchor-id="de-pedidos-que-entraram-ou-não-com-recurso">% de pedidos que entraram ou não com recurso</h3>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>pedidos_e_recursos <span class="sc">%&gt;%</span> </span>
<span id="cb24-2"><a href="#cb24-2"></a>  <span class="fu">count</span>(ano_pedido, entrou_com_recurso, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-3"><a href="#cb24-3"></a>  <span class="fu">add_count</span>(<span class="at">name =</span> <span class="st">"total"</span>, ano_pedido, <span class="at">wt =</span> n) <span class="sc">%&gt;%</span> </span>
<span id="cb24-4"><a href="#cb24-4"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ano_pedido, <span class="at">y =</span> n <span class="sc">/</span> total, <span class="at">fill =</span> <span class="fu">reorder</span>(entrou_com_recurso, n))) <span class="sc">+</span></span>
<span id="cb24-5"><a href="#cb24-5"></a>  ggchicklet<span class="sc">::</span><span class="fu">geom_chicklet</span>(<span class="at">alpha =</span> .<span class="dv">9</span>) <span class="sc">+</span></span>
<span id="cb24-6"><a href="#cb24-6"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> . <span class="sc">%&gt;%</span> <span class="fu">filter</span>(entrou_com_recurso), <span class="at">size =</span> <span class="fl">3.3</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>, <span class="at">vjust =</span> <span class="dv">1</span>,</span>
<span id="cb24-7"><a href="#cb24-7"></a>            <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">my_lbl</span>(n <span class="sc">/</span> total)), <span class="at">color =</span> cores_tb[[<span class="st">"cinza_quase_branco"</span>]]) <span class="sc">+</span></span>
<span id="cb24-8"><a href="#cb24-8"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(cores_aep[[<span class="st">"rosa"</span>]], cores_tb[[<span class="st">"azul"</span>]]), </span>
<span id="cb24-9"><a href="#cb24-9"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Houve recurso"</span>, <span class="st">"Não houve recurso"</span>), <span class="at">name =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb24-10"><a href="#cb24-10"></a>  <span class="fu">scale_y_percent</span>(<span class="at">name =</span> <span class="st">"% de pedidos de acesso a informação"</span>, <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb24-11"><a href="#cb24-11"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">2012</span><span class="sc">:</span><span class="dv">2022</span>), <span class="at">name =</span> <span class="cn">NULL</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="0-monitoramento_files/figure-html/plot-perc-pedidos-com-e-sem-recurso-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p></p>
</section><section id="total-de-pedidos-que-entraram-com-recurso" class="level3"><h3 class="anchored" data-anchor-id="total-de-pedidos-que-entraram-com-recurso">Total de pedidos que entraram com recurso</h3>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a>pedidos_e_recursos <span class="sc">%&gt;%</span></span>
<span id="cb25-2"><a href="#cb25-2"></a>  <span class="fu">count</span>(ano_pedido, entrou_com_recurso, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-3"><a href="#cb25-3"></a>  <span class="fu">add_count</span>(<span class="at">name =</span> <span class="st">"total"</span>, ano_pedido, <span class="at">wt =</span> n) <span class="sc">%&gt;%</span> </span>
<span id="cb25-4"><a href="#cb25-4"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ano_pedido, <span class="at">y =</span> n, <span class="at">fill =</span> <span class="fu">reorder</span>(entrou_com_recurso, n))) <span class="sc">+</span></span>
<span id="cb25-5"><a href="#cb25-5"></a>  ggchicklet<span class="sc">::</span><span class="fu">geom_chicklet</span>() <span class="sc">+</span></span>
<span id="cb25-6"><a href="#cb25-6"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(cores_aep[[<span class="st">"rosa"</span>]], cores_tb[[<span class="st">"azul"</span>]]), </span>
<span id="cb25-7"><a href="#cb25-7"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Houve recurso"</span>, <span class="st">"Não houve recurso"</span>), <span class="at">name =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb25-8"><a href="#cb25-8"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">2012</span><span class="sc">:</span><span class="dv">2022</span>), <span class="at">name =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb25-9"><a href="#cb25-9"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_number</span>(), <span class="at">name =</span> <span class="st">"Quantidade de pedidos"</span>, <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="0-monitoramento_files/figure-html/plot-total-recursos-ano-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p></p>
</section><section id="evolução-do-de-recursos-impetrados-por-ano" class="level3"><h3 class="anchored" data-anchor-id="evolução-do-de-recursos-impetrados-por-ano">Evolução do % de recursos impetrados por ano</h3>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>pedidos_e_recursos <span class="sc">%&gt;%</span> </span>
<span id="cb26-2"><a href="#cb26-2"></a>  <span class="fu">count</span>(ano_pedido, entrou_com_recurso, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-3"><a href="#cb26-3"></a>  <span class="fu">add_count</span>(<span class="at">name =</span> <span class="st">"total"</span>, ano_pedido, <span class="at">wt =</span> n) <span class="sc">%&gt;%</span></span>
<span id="cb26-4"><a href="#cb26-4"></a>  <span class="fu">filter</span>(entrou_com_recurso) <span class="sc">%&gt;%</span> </span>
<span id="cb26-5"><a href="#cb26-5"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ano_pedido, <span class="at">y =</span> n <span class="sc">/</span> total, <span class="at">group =</span> <span class="fu">reorder</span>(entrou_com_recurso, n))) <span class="sc">+</span></span>
<span id="cb26-6"><a href="#cb26-6"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb26-7"><a href="#cb26-7"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> cores_aep[[<span class="st">"rosa"</span>]], <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb26-8"><a href="#cb26-8"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">my_lbl</span>(n <span class="sc">/</span> total)), <span class="at">color =</span> cores_aep[[<span class="st">"rosa"</span>]], <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb26-9"><a href="#cb26-9"></a>  <span class="fu">scale_y_percent</span>(<span class="at">name =</span> <span class="st">"% de pedidos de acesso a informação"</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.11</span>)) <span class="sc">+</span></span>
<span id="cb26-10"><a href="#cb26-10"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">2012</span><span class="sc">:</span><span class="dv">2022</span>), <span class="at">name =</span> <span class="cn">NULL</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="0-monitoramento_files/figure-html/plor-perc-recursos-ano-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p></p>
</section><section id="órgãos-campeões-de-recursos-impetrados-2012---2022-15-primeiros" class="level3"><h3 class="anchored" data-anchor-id="órgãos-campeões-de-recursos-impetrados-2012---2022-15-primeiros">Órgãos campeões de recursos impetrados (2012 - 2022, 15 primeiros)</h3>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>pedidos_e_recursos <span class="sc">%&gt;%</span> </span>
<span id="cb27-2"><a href="#cb27-2"></a>  <span class="fu">filter</span>(entrou_com_recurso) <span class="sc">%&gt;%</span> </span>
<span id="cb27-3"><a href="#cb27-3"></a>  <span class="fu">count</span>(orgao, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb27-4"><a href="#cb27-4"></a>  <span class="fu">slice_max</span>(<span class="at">order_by =</span> n, <span class="at">n =</span> <span class="dv">15</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb27-5"><a href="#cb27-5"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> n, <span class="at">x =</span> <span class="fu">reorder</span>(orgao, <span class="sc">-</span>n))) <span class="sc">+</span></span>
<span id="cb27-6"><a href="#cb27-6"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb27-7"><a href="#cb27-7"></a>  ggchicklet<span class="sc">::</span><span class="fu">geom_chicklet</span>(<span class="at">fill =</span> cores_aep[[<span class="st">"laranja"</span>]]) <span class="sc">+</span></span>
<span id="cb27-8"><a href="#cb27-8"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> scales<span class="sc">::</span><span class="fu">number</span>(n, <span class="at">accuracy =</span> <span class="dv">1</span>)), <span class="at">check_overlap =</span> T,</span>
<span id="cb27-9"><a href="#cb27-9"></a>            <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span>  <span class="dv">3</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>) <span class="sc">+</span></span>
<span id="cb27-10"><a href="#cb27-10"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">name =</span> <span class="st">"Órgão"</span>, <span class="at">labels =</span> <span class="cn">NULL</span>) <span class="sc">+</span> </span>
<span id="cb27-11"><a href="#cb27-11"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">labels =</span> <span class="fu">number_format</span>(), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">8500</span>), </span>
<span id="cb27-12"><a href="#cb27-12"></a>                     <span class="at">name =</span> <span class="st">"Quantidade de recursos impetrados"</span>) <span class="sc">+</span></span>
<span id="cb27-13"><a href="#cb27-13"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> <span class="fu">reorder</span>(orgao, <span class="sc">-</span>n), <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb27-14"><a href="#cb27-14"></a>  <span class="fu">theme</span>(<span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">face =</span> <span class="st">"italic"</span>),</span>
<span id="cb27-15"><a href="#cb27-15"></a>        <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb27-16"><a href="#cb27-16"></a>        <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb27-17"><a href="#cb27-17"></a>        <span class="at">panel.grid.major.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb27-18"><a href="#cb27-18"></a>        <span class="at">panel.grid.minor.y =</span> <span class="fu">element_blank</span>())</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="0-monitoramento_files/figure-html/plot-orgaos-campeoes-recursos-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p></p>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>cores_tipo_resposta2 <span class="ot">&lt;-</span> cores_tipo_resposta <span class="sc">%&gt;%</span> </span>
<span id="cb28-2"><a href="#cb28-2"></a>  <span class="fu">enframe</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb28-3"><a href="#cb28-3"></a>  <span class="fu">mutate</span>(</span>
<span id="cb28-4"><a href="#cb28-4"></a>    <span class="at">value =</span> <span class="fu">case_when</span>(</span>
<span id="cb28-5"><a href="#cb28-5"></a>      name <span class="sc">==</span> <span class="st">"Deferido"</span> <span class="sc">~</span> <span class="st">"cyan4"</span>,</span>
<span id="cb28-6"><a href="#cb28-6"></a>      name <span class="sc">==</span> <span class="st">"Parcialmente deferido"</span> <span class="sc">~</span> cores_tb[[<span class="st">"azul"</span>]],</span>
<span id="cb28-7"><a href="#cb28-7"></a>      name <span class="sc">==</span> <span class="st">"Perda de objeto parcial"</span> <span class="sc">~</span> cores_tb[[<span class="st">"cinza_escuro"</span>]],</span>
<span id="cb28-8"><a href="#cb28-8"></a>      name <span class="sc">==</span> <span class="st">"Perda de objeto"</span> <span class="sc">~</span> cores_aep[[<span class="st">"cinza"</span>]],</span>
<span id="cb28-9"><a href="#cb28-9"></a>      name <span class="sc">==</span> <span class="st">"Não conhecimento"</span> <span class="sc">~</span> cores_aep[[<span class="st">"laranja"</span>]],</span>
<span id="cb28-10"><a href="#cb28-10"></a>      name <span class="sc">==</span> <span class="st">"Acolhimento"</span> <span class="sc">~</span> cores_tb[[<span class="st">"cinza_quase_branco"</span>]],</span>
<span id="cb28-11"><a href="#cb28-11"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> value</span>
<span id="cb28-12"><a href="#cb28-12"></a>    )</span>
<span id="cb28-13"><a href="#cb28-13"></a>  ) <span class="sc">%&gt;%</span> <span class="fu">deframe</span>()</span>
<span id="cb28-14"><a href="#cb28-14"></a></span>
<span id="cb28-15"><a href="#cb28-15"></a>plot_tipo_resposta <span class="ot">&lt;-</span> <span class="cf">function</span>(df, instancia_recursal) {</span>
<span id="cb28-16"><a href="#cb28-16"></a>  </span>
<span id="cb28-17"><a href="#cb28-17"></a>  recursos_cgu <span class="sc">%&gt;%</span></span>
<span id="cb28-18"><a href="#cb28-18"></a>  <span class="fu">count</span>(<span class="at">ano_recurso =</span> <span class="fu">year</span>(data_recurso), instancia, tipo_resposta) <span class="sc">%&gt;%</span> </span>
<span id="cb28-19"><a href="#cb28-19"></a>  <span class="fu">filter</span>(instancia <span class="sc">==</span> instancia_recursal) <span class="sc">%&gt;%</span></span>
<span id="cb28-20"><a href="#cb28-20"></a>  <span class="fu">add_count</span>(ano_recurso, <span class="at">wt =</span> n) <span class="sc">%&gt;%</span> </span>
<span id="cb28-21"><a href="#cb28-21"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ano_recurso, <span class="at">y =</span> n <span class="sc">/</span> nn, <span class="at">color =</span> tipo_resposta)) <span class="sc">+</span></span>
<span id="cb28-22"><a href="#cb28-22"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb28-23"><a href="#cb28-23"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb28-24"><a href="#cb28-24"></a>  <span class="fu">scale_y_percent</span>() <span class="sc">+</span></span>
<span id="cb28-25"><a href="#cb28-25"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> cores_tipo_resposta2, <span class="at">name =</span> <span class="st">"Tipo de resposta:"</span>) <span class="sc">+</span></span>
<span id="cb28-26"><a href="#cb28-26"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">2012</span><span class="sc">:</span><span class="dv">2022</span>)</span>
<span id="cb28-27"><a href="#cb28-27"></a>  </span>
<span id="cb28-28"><a href="#cb28-28"></a>} </span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="tipo-de-resposta-dada-aos-recursos-em-primeira-instância" class="level3"><h3 class="anchored" data-anchor-id="tipo-de-resposta-dada-aos-recursos-em-primeira-instância">Tipo de resposta dada aos recursos em primeira instância</h3>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="fu">plot_tipo_resposta</span>(recursos_cgu, <span class="st">"Primeira Instância"</span>)</span>
<span id="cb29-2"><a href="#cb29-2"></a><span class="co">#&gt; Storing counts in `nn`, as `n` already present in input</span></span>
<span id="cb29-3"><a href="#cb29-3"></a><span class="co">#&gt; ℹ Use `name = "new_name"` to pick a new name.</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="0-monitoramento_files/figure-html/plot-tipo-resposta-1a-instancia-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p></p>
</section><section id="tipo-de-resposta-dada-aos-recursos-em-segunda-instância" class="level3"><h3 class="anchored" data-anchor-id="tipo-de-resposta-dada-aos-recursos-em-segunda-instância">Tipo de resposta dada aos recursos em segunda instância</h3>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a><span class="fu">plot_tipo_resposta</span>(recursos_cgu, <span class="st">"Segunda Instância"</span>)</span>
<span id="cb30-2"><a href="#cb30-2"></a><span class="co">#&gt; Storing counts in `nn`, as `n` already present in input</span></span>
<span id="cb30-3"><a href="#cb30-3"></a><span class="co">#&gt; ℹ Use `name = "new_name"` to pick a new name.</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="0-monitoramento_files/figure-html/plot-tipo-resposta-2a-instancia-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p></p>
</section><section id="tipo-de-resposta-dada-aos-recursos-para-a-cmri" class="level3"><h3 class="anchored" data-anchor-id="tipo-de-resposta-dada-aos-recursos-para-a-cmri">Tipo de resposta dada aos recursos para a CMRI</h3>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="fu">plot_tipo_resposta</span>(recursos_cgu, <span class="st">"CMRI"</span>)</span>
<span id="cb31-2"><a href="#cb31-2"></a><span class="co">#&gt; Storing counts in `nn`, as `n` already present in input</span></span>
<span id="cb31-3"><a href="#cb31-3"></a><span class="co">#&gt; ℹ Use `name = "new_name"` to pick a new name.</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="0-monitoramento_files/figure-html/plot-tipo-resposta-cmri-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p></p>
</section><section id="tipo-de-resposta-dada-aos-recursos-para-a-cgu" class="level3"><h3 class="anchored" data-anchor-id="tipo-de-resposta-dada-aos-recursos-para-a-cgu">Tipo de resposta dada aos recursos para a CGU</h3>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="fu">plot_tipo_resposta</span>(recursos_cgu, <span class="st">"CGU"</span>)</span>
<span id="cb32-2"><a href="#cb32-2"></a><span class="co">#&gt; Storing counts in `nn`, as `n` already present in input</span></span>
<span id="cb32-3"><a href="#cb32-3"></a><span class="co">#&gt; ℹ Use `name = "new_name"` to pick a new name.</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="0-monitoramento_files/figure-html/plot-tipo-resposta-cgu-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<!-- -->

</section></section></main><!-- /main column --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiada");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Código fonte</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb33" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb33-1"><a href="#cb33-1"></a><span class="co">---</span></span>
<span id="cb33-2"><a href="#cb33-2"></a><span class="an">title:</span><span class="co"> "Números da Lei de Acesso a Informação no Brasil"</span></span>
<span id="cb33-3"><a href="#cb33-3"></a><span class="an">lang:</span><span class="co"> pt-BR</span></span>
<span id="cb33-4"><a href="#cb33-4"></a><span class="an">format:</span></span>
<span id="cb33-5"><a href="#cb33-5"></a><span class="co">  html:</span></span>
<span id="cb33-6"><a href="#cb33-6"></a><span class="co">    anchor-sections: true</span></span>
<span id="cb33-7"><a href="#cb33-7"></a><span class="co">    code-fold: true</span></span>
<span id="cb33-8"><a href="#cb33-8"></a><span class="co">    code-tools: true</span></span>
<span id="cb33-9"><a href="#cb33-9"></a><span class="co">    code-link: true</span></span>
<span id="cb33-10"><a href="#cb33-10"></a><span class="co">    code-line-numbers: true</span></span>
<span id="cb33-11"><a href="#cb33-11"></a><span class="co">    code-summary: "Código"</span></span>
<span id="cb33-12"><a href="#cb33-12"></a><span class="co">    toc: true</span></span>
<span id="cb33-13"><a href="#cb33-13"></a><span class="co">    toc-title: "Índice"</span></span>
<span id="cb33-14"><a href="#cb33-14"></a><span class="co">    toc-depth: 4</span></span>
<span id="cb33-15"><a href="#cb33-15"></a><span class="co">    footnotes-hover: true</span></span>
<span id="cb33-16"><a href="#cb33-16"></a><span class="co">    smooth-scroll: true</span></span>
<span id="cb33-17"><a href="#cb33-17"></a><span class="co">    search: true</span></span>
<span id="cb33-18"><a href="#cb33-18"></a><span class="co">    comments:</span></span>
<span id="cb33-19"><a href="#cb33-19"></a><span class="co">      hypothesis: true</span></span>
<span id="cb33-20"><a href="#cb33-20"></a><span class="an">knitr:</span></span>
<span id="cb33-21"><a href="#cb33-21"></a><span class="co">  opts_chunk: </span></span>
<span id="cb33-22"><a href="#cb33-22"></a><span class="co">    collapse: true</span></span>
<span id="cb33-23"><a href="#cb33-23"></a><span class="co">    comment: "#&gt;" </span></span>
<span id="cb33-24"><a href="#cb33-24"></a><span class="an">editor_options:</span><span class="co"> </span></span>
<span id="cb33-25"><a href="#cb33-25"></a><span class="co">  chunk_output_type: console</span></span>
<span id="cb33-26"><a href="#cb33-26"></a><span class="an">execute:</span><span class="co"> </span></span>
<span id="cb33-27"><a href="#cb33-27"></a><span class="co">  cache: false</span></span>
<span id="cb33-28"><a href="#cb33-28"></a><span class="co">---</span></span>
<span id="cb33-29"><a href="#cb33-29"></a></span>
<span id="cb33-30"><a href="#cb33-30"></a><span class="kw">&lt;style&gt;</span></span>
<span id="cb33-31"><a href="#cb33-31"></a><span class="fu">.nav-tabs</span> <span class="fu">.nav-link</span> {</span>
<span id="cb33-32"><a href="#cb33-32"></a>    <span class="kw">margin-bottom</span>: <span class="dv">-1</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb33-33"><a href="#cb33-33"></a>    <span class="kw">background</span>: <span class="dv">none</span><span class="op">;</span></span>
<span id="cb33-34"><a href="#cb33-34"></a>    <span class="kw">border</span>: <span class="dv">1</span><span class="dt">px</span> <span class="dv">solid</span> <span class="dv">transparent</span><span class="op">;</span></span>
<span id="cb33-35"><a href="#cb33-35"></a>    <span class="kw">border-top-left-radius</span>: <span class="dv">.25</span><span class="dt">rem</span><span class="op">;</span></span>
<span id="cb33-36"><a href="#cb33-36"></a>    <span class="kw">border-top-right-radius</span>: <span class="dv">.25</span><span class="dt">rem</span><span class="op">;</span></span>
<span id="cb33-37"><a href="#cb33-37"></a>    <span class="kw">color</span>: <span class="cn">#fcaa27</span><span class="op">;</span></span>
<span id="cb33-38"><a href="#cb33-38"></a>    <span class="kw">font-size</span>: <span class="dv">0.875</span><span class="dt">em</span><span class="op">;</span></span>
<span id="cb33-39"><a href="#cb33-39"></a>}</span>
<span id="cb33-40"><a href="#cb33-40"></a></span>
<span id="cb33-41"><a href="#cb33-41"></a><span class="fu">.nav-tabs</span> <span class="fu">.nav-link.active</span><span class="op">,</span> <span class="fu">.nav-tabs</span> <span class="fu">.nav-item.show</span> <span class="fu">.nav-link</span> {</span>
<span id="cb33-42"><a href="#cb33-42"></a>    <span class="kw">color</span>: <span class="cn">#495057</span><span class="op">;</span></span>
<span id="cb33-43"><a href="#cb33-43"></a>    <span class="kw">background-color</span>: <span class="cn">#fff</span><span class="op">;</span></span>
<span id="cb33-44"><a href="#cb33-44"></a>    <span class="kw">border-color</span>: <span class="cn">#dee2e6</span> <span class="cn">#dee2e6</span> <span class="cn">#fff</span><span class="op">;</span></span>
<span id="cb33-45"><a href="#cb33-45"></a>    <span class="kw">color</span>: <span class="cn">#d81755</span><span class="op">;</span></span>
<span id="cb33-46"><a href="#cb33-46"></a>    <span class="kw">font-size</span>: <span class="dv">1</span><span class="dt">em</span><span class="op">;</span></span>
<span id="cb33-47"><a href="#cb33-47"></a>}</span>
<span id="cb33-48"><a href="#cb33-48"></a><span class="kw">&lt;/style&gt;</span></span>
<span id="cb33-49"><a href="#cb33-49"></a></span>
<span id="cb33-50"><a href="#cb33-50"></a></span>
<span id="cb33-51"><a href="#cb33-51"></a><span class="in">```{r libs}</span></span>
<span id="cb33-52"><a href="#cb33-52"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb33-53"><a href="#cb33-53"></a><span class="fu">library</span>(here)</span>
<span id="cb33-54"><a href="#cb33-54"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb33-55"><a href="#cb33-55"></a><span class="fu">library</span>(scales)</span>
<span id="cb33-56"><a href="#cb33-56"></a><span class="fu">library</span>(hrbrthemes)</span>
<span id="cb33-57"><a href="#cb33-57"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb33-58"><a href="#cb33-58"></a><span class="fu">library</span>(glue)</span>
<span id="cb33-59"><a href="#cb33-59"></a><span class="in">```</span></span>
<span id="cb33-60"><a href="#cb33-60"></a></span>
<span id="cb33-61"><a href="#cb33-61"></a><span class="in">```{r conf}</span></span>
<span id="cb33-62"><a href="#cb33-62"></a><span class="co"># aplica identidade visual da TB/AeP:</span></span>
<span id="cb33-63"><a href="#cb33-63"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">"src/0-plot-aesthetics.R"</span>), <span class="at">encoding =</span> <span class="st">"UTF-8"</span>)</span>
<span id="cb33-64"><a href="#cb33-64"></a><span class="co"># helper</span></span>
<span id="cb33-65"><a href="#cb33-65"></a><span class="st">`</span><span class="at">%notin%</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) <span class="sc">!</span>(x <span class="sc">%in%</span> y)</span>
<span id="cb33-66"><a href="#cb33-66"></a><span class="in">```</span></span>
<span id="cb33-67"><a href="#cb33-67"></a></span>
<span id="cb33-68"><a href="#cb33-68"></a><span class="in">```{r data-pedidos-cgu}</span></span>
<span id="cb33-69"><a href="#cb33-69"></a>pedidos_cgu <span class="ot">&lt;-</span> <span class="st">"data/base-cgu.rds"</span> <span class="sc">%&gt;%</span></span>
<span id="cb33-70"><a href="#cb33-70"></a>  <span class="fu">here</span>() <span class="sc">%&gt;%</span></span>
<span id="cb33-71"><a href="#cb33-71"></a>  <span class="fu">readRDS</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb33-72"><a href="#cb33-72"></a>  <span class="fu">filter</span>(base <span class="sc">==</span> <span class="st">"Pedidos"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb33-73"><a href="#cb33-73"></a>  <span class="fu">select</span>(datasets) <span class="sc">%&gt;%</span> </span>
<span id="cb33-74"><a href="#cb33-74"></a>  <span class="fu">unnest</span>(<span class="fu">c</span>(datasets)) <span class="sc">%&gt;%</span></span>
<span id="cb33-75"><a href="#cb33-75"></a>  <span class="fu">filter</span>(</span>
<span id="cb33-76"><a href="#cb33-76"></a>    <span class="sc">!</span><span class="fu">is.na</span>(decisao),</span>
<span id="cb33-77"><a href="#cb33-77"></a>    <span class="sc">!</span><span class="fu">is.na</span>(data_resposta),</span>
<span id="cb33-78"><a href="#cb33-78"></a>    esfera <span class="sc">==</span> <span class="st">"Federal"</span>,</span>
<span id="cb33-79"><a href="#cb33-79"></a>    <span class="sc">!</span><span class="fu">str_detect</span>(orgao, <span class="st">"refeitura|Órgão para Teste"</span>)</span>
<span id="cb33-80"><a href="#cb33-80"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb33-81"><a href="#cb33-81"></a>  <span class="fu">transmute</span>(</span>
<span id="cb33-82"><a href="#cb33-82"></a>    id_pedido,</span>
<span id="cb33-83"><a href="#cb33-83"></a>    <span class="at">mes_pedido =</span> data_registro,</span>
<span id="cb33-84"><a href="#cb33-84"></a>    <span class="at">mes_resposta =</span> data_resposta,</span>
<span id="cb33-85"><a href="#cb33-85"></a>    <span class="at">data_pedido =</span> <span class="fu">dmy</span>(ts_registro),</span>
<span id="cb33-86"><a href="#cb33-86"></a>    <span class="at">data_resposta =</span> <span class="fu">dmy</span>(ts_resposta),</span>
<span id="cb33-87"><a href="#cb33-87"></a>    <span class="at">prazo =</span> <span class="fu">dmy</span>(prazo),</span>
<span id="cb33-88"><a href="#cb33-88"></a>    decisao,</span>
<span id="cb33-89"><a href="#cb33-89"></a>    orgao</span>
<span id="cb33-90"><a href="#cb33-90"></a>  )</span>
<span id="cb33-91"><a href="#cb33-91"></a><span class="in">```</span></span>
<span id="cb33-92"><a href="#cb33-92"></a></span>
<span id="cb33-93"><a href="#cb33-93"></a><span class="in">```{r data-recursos-cgu}</span></span>
<span id="cb33-94"><a href="#cb33-94"></a>recursos_cgu <span class="ot">&lt;-</span> <span class="st">"data/base-cgu.rds"</span> <span class="sc">%&gt;%</span></span>
<span id="cb33-95"><a href="#cb33-95"></a>  <span class="fu">here</span>() <span class="sc">%&gt;%</span></span>
<span id="cb33-96"><a href="#cb33-96"></a>  <span class="fu">readRDS</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb33-97"><a href="#cb33-97"></a>  <span class="fu">filter</span>(base <span class="sc">==</span> <span class="st">"Recursos"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb33-98"><a href="#cb33-98"></a>  <span class="fu">select</span>(datasets) <span class="sc">%&gt;%</span> </span>
<span id="cb33-99"><a href="#cb33-99"></a>  <span class="fu">unnest</span>(<span class="fu">c</span>(datasets)) <span class="sc">%&gt;%</span></span>
<span id="cb33-100"><a href="#cb33-100"></a>  <span class="fu">filter</span>(</span>
<span id="cb33-101"><a href="#cb33-101"></a>    <span class="sc">!</span><span class="fu">is.na</span>(instancia),</span>
<span id="cb33-102"><a href="#cb33-102"></a>    <span class="sc">!</span><span class="fu">is.na</span>(data_resposta),</span>
<span id="cb33-103"><a href="#cb33-103"></a>    esfera <span class="sc">==</span> <span class="st">"Federal"</span>,</span>
<span id="cb33-104"><a href="#cb33-104"></a>    <span class="sc">!</span><span class="fu">str_detect</span>(orgao, <span class="st">"refeitura|Órgão para Teste"</span>),</span>
<span id="cb33-105"><a href="#cb33-105"></a>    instancia <span class="sc">!=</span> <span class="st">"Pedido de Revisão"</span></span>
<span id="cb33-106"><a href="#cb33-106"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb33-107"><a href="#cb33-107"></a>  <span class="fu">mutate</span>(<span class="at">instancia =</span> <span class="fu">ordered</span>(instancia, <span class="at">levels =</span> <span class="fu">names</span>(cores_instancia))) <span class="sc">%&gt;%</span> </span>
<span id="cb33-108"><a href="#cb33-108"></a>  <span class="fu">transmute</span>(</span>
<span id="cb33-109"><a href="#cb33-109"></a>    id_recurso,</span>
<span id="cb33-110"><a href="#cb33-110"></a>    id_pedido,</span>
<span id="cb33-111"><a href="#cb33-111"></a>    <span class="at">mes_recurso =</span> data_registro,</span>
<span id="cb33-112"><a href="#cb33-112"></a>    <span class="at">mes_resposta_recurso =</span> data_resposta,</span>
<span id="cb33-113"><a href="#cb33-113"></a>    <span class="at">data_recurso =</span> <span class="fu">dmy</span>(ts_registro),</span>
<span id="cb33-114"><a href="#cb33-114"></a>    <span class="at">data_resposta_recurso =</span> <span class="fu">dmy</span>(ts_resposta),</span>
<span id="cb33-115"><a href="#cb33-115"></a>    instancia,</span>
<span id="cb33-116"><a href="#cb33-116"></a>    tipo_recurso,</span>
<span id="cb33-117"><a href="#cb33-117"></a>    tipo_resposta</span>
<span id="cb33-118"><a href="#cb33-118"></a>  )</span>
<span id="cb33-119"><a href="#cb33-119"></a><span class="in">```</span></span>
<span id="cb33-120"><a href="#cb33-120"></a></span>
<span id="cb33-121"><a href="#cb33-121"></a><span class="kw">&lt;/br&gt;&lt;/br&gt;</span></span>
<span id="cb33-122"><a href="#cb33-122"></a></span>
<span id="cb33-123"><a href="#cb33-123"></a><span class="fu">## Total de manifestações registradas no FalaBr (2012-2022)</span></span>
<span id="cb33-124"><a href="#cb33-124"></a></span>
<span id="cb33-125"><a href="#cb33-125"></a><span class="in">```{r plot-total-de-manifestacoes-registradas-no-falabr-2012-2022, fig.width=11, fig.height = 5}</span></span>
<span id="cb33-126"><a href="#cb33-126"></a>pedidos_cgu <span class="sc">%&gt;%</span> </span>
<span id="cb33-127"><a href="#cb33-127"></a>  <span class="fu">mutate</span>(<span class="at">is_pedido_de_informacao =</span> <span class="fu">case_when</span>(</span>
<span id="cb33-128"><a href="#cb33-128"></a>    decisao <span class="sc">%notin%</span> <span class="fu">c</span>(</span>
<span id="cb33-129"><a href="#cb33-129"></a>      <span class="st">"Pergunta Duplicada/Repetida"</span>,</span>
<span id="cb33-130"><a href="#cb33-130"></a>      <span class="st">"Não se trata de solicitação de informação"</span> </span>
<span id="cb33-131"><a href="#cb33-131"></a>    ) <span class="sc">~</span> <span class="st">"Pedidos de acesso a informação via LAI"</span>,</span>
<span id="cb33-132"><a href="#cb33-132"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> decisao</span>
<span id="cb33-133"><a href="#cb33-133"></a>  ) <span class="sc">%&gt;%</span> <span class="fu">str_wrap</span>(<span class="dv">25</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb33-134"><a href="#cb33-134"></a>  <span class="fu">count</span>(mes_pedido, is_pedido_de_informacao, <span class="at">name =</span> <span class="st">"qt"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb33-135"><a href="#cb33-135"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(</span>
<span id="cb33-136"><a href="#cb33-136"></a>    <span class="at">x =</span> mes_pedido,</span>
<span id="cb33-137"><a href="#cb33-137"></a>    <span class="at">y =</span> qt,</span>
<span id="cb33-138"><a href="#cb33-138"></a>    <span class="at">fill =</span> is_pedido_de_informacao,</span>
<span id="cb33-139"><a href="#cb33-139"></a>    <span class="at">color =</span> is_pedido_de_informacao</span>
<span id="cb33-140"><a href="#cb33-140"></a>  )) <span class="sc">+</span></span>
<span id="cb33-141"><a href="#cb33-141"></a>  <span class="fu">geom_vline</span>(</span>
<span id="cb33-142"><a href="#cb33-142"></a>    <span class="at">xintercept =</span> <span class="fu">seq</span>(<span class="fu">ymd</span>(<span class="st">'2013-01-01'</span>), <span class="fu">ymd</span>(<span class="st">'2022-01-01'</span>), <span class="at">by =</span> <span class="st">'year'</span>),</span>
<span id="cb33-143"><a href="#cb33-143"></a>    <span class="at">lty =</span> <span class="dv">3</span></span>
<span id="cb33-144"><a href="#cb33-144"></a>  ) <span class="sc">+</span></span>
<span id="cb33-145"><a href="#cb33-145"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb33-146"><a href="#cb33-146"></a>  <span class="fu">geom_label</span>(</span>
<span id="cb33-147"><a href="#cb33-147"></a>    <span class="fu">aes</span>(<span class="at">label =</span> qt),</span>
<span id="cb33-148"><a href="#cb33-148"></a>    <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb33-149"><a href="#cb33-149"></a>    <span class="at">size =</span> <span class="dv">3</span>, </span>
<span id="cb33-150"><a href="#cb33-150"></a>    <span class="at">nudge_y =</span> <span class="dv">250</span>,</span>
<span id="cb33-151"><a href="#cb33-151"></a>    <span class="at">alpha =</span> .<span class="dv">6</span>,</span>
<span id="cb33-152"><a href="#cb33-152"></a>    <span class="at">label.size =</span> <span class="cn">NA</span>,</span>
<span id="cb33-153"><a href="#cb33-153"></a>    <span class="at">data =</span> . <span class="sc">%&gt;%</span> </span>
<span id="cb33-154"><a href="#cb33-154"></a>      <span class="fu">group_by</span>(is_pedido_de_informacao) <span class="sc">%&gt;%</span> </span>
<span id="cb33-155"><a href="#cb33-155"></a>      <span class="fu">filter</span>(qt <span class="sc">==</span> <span class="fu">max</span>(qt)) <span class="sc">%&gt;%</span> </span>
<span id="cb33-156"><a href="#cb33-156"></a>      <span class="fu">ungroup</span>(),</span>
<span id="cb33-157"><a href="#cb33-157"></a>      <span class="at">show.legend =</span> F</span>
<span id="cb33-158"><a href="#cb33-158"></a>  ) <span class="sc">+</span></span>
<span id="cb33-159"><a href="#cb33-159"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb33-160"><a href="#cb33-160"></a>    <span class="at">color =</span> <span class="st">"gray20"</span>,</span>
<span id="cb33-161"><a href="#cb33-161"></a>    <span class="at">data =</span> . <span class="sc">%&gt;%</span> </span>
<span id="cb33-162"><a href="#cb33-162"></a>      <span class="fu">group_by</span>(is_pedido_de_informacao) <span class="sc">%&gt;%</span> </span>
<span id="cb33-163"><a href="#cb33-163"></a>      <span class="fu">filter</span>(qt <span class="sc">==</span> <span class="fu">max</span>(qt)) <span class="sc">%&gt;%</span> </span>
<span id="cb33-164"><a href="#cb33-164"></a>      <span class="fu">ungroup</span>(),</span>
<span id="cb33-165"><a href="#cb33-165"></a>    <span class="at">show.legend =</span> <span class="cn">FALSE</span></span>
<span id="cb33-166"><a href="#cb33-166"></a>  ) <span class="sc">+</span></span>
<span id="cb33-167"><a href="#cb33-167"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">number_format</span>()) <span class="sc">+</span></span>
<span id="cb33-168"><a href="#cb33-168"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> cores_lai) <span class="sc">+</span></span>
<span id="cb33-169"><a href="#cb33-169"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> cores_lai, <span class="at">breaks =</span> <span class="fu">names</span>(cores_lai)[<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">2</span>)]) <span class="sc">+</span></span>
<span id="cb33-170"><a href="#cb33-170"></a>  <span class="fu">scale_x_date</span>(</span>
<span id="cb33-171"><a href="#cb33-171"></a>    <span class="at">breaks =</span> <span class="fu">breaks_pretty</span>(<span class="dv">24</span>), </span>
<span id="cb33-172"><a href="#cb33-172"></a>    <span class="at">labels =</span> <span class="fu">label_date_short</span>(),</span>
<span id="cb33-173"><a href="#cb33-173"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="fu">ymd</span>(<span class="st">'2012-01-01'</span>), <span class="fu">ymd</span>(<span class="st">'2023-01-01'</span>)),</span>
<span id="cb33-174"><a href="#cb33-174"></a>    <span class="at">expand =</span> <span class="fu">c</span>(<span class="fl">0.</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb33-175"><a href="#cb33-175"></a>  <span class="fu">labs</span>(</span>
<span id="cb33-176"><a href="#cb33-176"></a>    <span class="at">y =</span> <span class="st">"Número de manifestações"</span>,</span>
<span id="cb33-177"><a href="#cb33-177"></a>    <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb33-178"><a href="#cb33-178"></a>    <span class="at">fill =</span> <span class="cn">NULL</span>,</span>
<span id="cb33-179"><a href="#cb33-179"></a>    <span class="at">color =</span> <span class="cn">NULL</span>,</span>
<span id="cb33-180"><a href="#cb33-180"></a>    <span class="at">title =</span> <span class="cn">NULL</span></span>
<span id="cb33-181"><a href="#cb33-181"></a>  ) <span class="sc">+</span></span>
<span id="cb33-182"><a href="#cb33-182"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb33-183"><a href="#cb33-183"></a>        <span class="at">legend.justification =</span> <span class="st">"left"</span>,</span>
<span id="cb33-184"><a href="#cb33-184"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">2</span>, <span class="dv">5</span>, <span class="st">"pt"</span>)),</span>
<span id="cb33-185"><a href="#cb33-185"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">vjust =</span> <span class="dv">1</span>)</span>
<span id="cb33-186"><a href="#cb33-186"></a>        )</span>
<span id="cb33-187"><a href="#cb33-187"></a><span class="in">```</span></span>
<span id="cb33-188"><a href="#cb33-188"></a></span>
<span id="cb33-189"><a href="#cb33-189"></a><span class="kw">&lt;/br&gt;&lt;/br&gt;</span></span>
<span id="cb33-190"><a href="#cb33-190"></a></span>
<span id="cb33-191"><a href="#cb33-191"></a><span class="fu">## Número de órgãos do governo Federal acionados pela LAI (2012-2022)</span></span>
<span id="cb33-192"><a href="#cb33-192"></a></span>
<span id="cb33-193"><a href="#cb33-193"></a><span class="in">```{r plot-orgaos-requisitados-pela-lai}</span></span>
<span id="cb33-194"><a href="#cb33-194"></a>pedidos_cgu <span class="sc">%&gt;%</span> </span>
<span id="cb33-195"><a href="#cb33-195"></a>  <span class="fu">count</span>(<span class="at">ano =</span> <span class="fu">year</span>(mes_pedido), orgao) <span class="sc">%&gt;%</span> </span>
<span id="cb33-196"><a href="#cb33-196"></a>  <span class="fu">count</span>(ano) <span class="sc">%&gt;%</span> </span>
<span id="cb33-197"><a href="#cb33-197"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.character</span>(ano), <span class="at">y =</span> n)) <span class="sc">+</span></span>
<span id="cb33-198"><a href="#cb33-198"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> cores_aep[[<span class="st">"laranja"</span>]], <span class="at">alpha =</span> .<span class="dv">9</span>) <span class="sc">+</span></span>
<span id="cb33-199"><a href="#cb33-199"></a>  <span class="fu">geom_hline</span>(<span class="fu">aes</span>(<span class="at">yintercept =</span> <span class="fu">n_distinct</span>(pedidos_cgu<span class="sc">$</span>orgao))) <span class="sc">+</span></span>
<span id="cb33-200"><a href="#cb33-200"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb33-201"><a href="#cb33-201"></a>    <span class="fu">aes</span>(</span>
<span id="cb33-202"><a href="#cb33-202"></a>      <span class="at">y =</span> <span class="fu">n_distinct</span>(pedidos_cgu<span class="sc">$</span>orgao) <span class="sc">+</span> <span class="dv">10</span>,</span>
<span id="cb33-203"><a href="#cb33-203"></a>      <span class="at">x =</span> <span class="st">"2016"</span>,</span>
<span id="cb33-204"><a href="#cb33-204"></a>      <span class="at">label =</span> <span class="fu">glue</span>(<span class="st">"Total de órgãos no Executivo Federal: {n_distinct(pedidos_cgu$orgao)}"</span>)</span>
<span id="cb33-205"><a href="#cb33-205"></a>    ),</span>
<span id="cb33-206"><a href="#cb33-206"></a>    <span class="at">check_overlap =</span> T</span>
<span id="cb33-207"><a href="#cb33-207"></a>  ) <span class="sc">+</span></span>
<span id="cb33-208"><a href="#cb33-208"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> n), <span class="at">color =</span> <span class="st">"gray30"</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb33-209"><a href="#cb33-209"></a>  <span class="fu">labs</span>(</span>
<span id="cb33-210"><a href="#cb33-210"></a>    <span class="at">x =</span> <span class="st">"Ano"</span>,</span>
<span id="cb33-211"><a href="#cb33-211"></a>    <span class="at">y =</span> <span class="st">"Quantidade de órgãos"</span></span>
<span id="cb33-212"><a href="#cb33-212"></a>  ) <span class="sc">+</span></span>
<span id="cb33-213"><a href="#cb33-213"></a>  <span class="fu">theme</span>(</span>
<span id="cb33-214"><a href="#cb33-214"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>)</span>
<span id="cb33-215"><a href="#cb33-215"></a>  )</span>
<span id="cb33-216"><a href="#cb33-216"></a><span class="in">```</span></span>
<span id="cb33-217"><a href="#cb33-217"></a></span>
<span id="cb33-218"><a href="#cb33-218"></a><span class="kw">&lt;/br&gt;&lt;/br&gt;</span></span>
<span id="cb33-219"><a href="#cb33-219"></a></span>
<span id="cb33-220"><a href="#cb33-220"></a><span class="fu">## Taxa de atendimento de pedidos de acesso a informação (2012-2022)</span></span>
<span id="cb33-221"><a href="#cb33-221"></a></span>
<span id="cb33-222"><a href="#cb33-222"></a><span class="in">```{r data-decisao}</span></span>
<span id="cb33-223"><a href="#cb33-223"></a>decisao <span class="ot">&lt;-</span> pedidos_cgu <span class="sc">%&gt;%</span> </span>
<span id="cb33-224"><a href="#cb33-224"></a>  <span class="fu">filter</span>(decisao <span class="sc">%notin%</span> <span class="fu">c</span>(</span>
<span id="cb33-225"><a href="#cb33-225"></a>    <span class="st">"Pergunta Duplicada/Repetida"</span>,</span>
<span id="cb33-226"><a href="#cb33-226"></a>    <span class="st">"Não se trata de solicitação de informação"</span></span>
<span id="cb33-227"><a href="#cb33-227"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb33-228"><a href="#cb33-228"></a>  <span class="fu">count</span>(mes_pedido, decisao, <span class="at">name =</span> <span class="st">"qt"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-229"><a href="#cb33-229"></a>  <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb33-230"><a href="#cb33-230"></a>  <span class="fu">mutate</span>(<span class="at">decisao =</span> <span class="fu">fct_reorder</span>(decisao, qt, <span class="at">.desc =</span> T))</span>
<span id="cb33-231"><a href="#cb33-231"></a><span class="in">```</span></span>
<span id="cb33-232"><a href="#cb33-232"></a></span>
<span id="cb33-233"><a href="#cb33-233"></a><span class="in">```{r function-plot_decisao}</span></span>
<span id="cb33-234"><a href="#cb33-234"></a><span class="co"># plot esquerdo ----------------------------------------------------------------</span></span>
<span id="cb33-235"><a href="#cb33-235"></a>plot_decisao <span class="ot">&lt;-</span> <span class="cf">function</span>(decisao_escolhida) {</span>
<span id="cb33-236"><a href="#cb33-236"></a>  </span>
<span id="cb33-237"><a href="#cb33-237"></a>  p1 <span class="ot">&lt;-</span> decisao <span class="sc">%&gt;%</span></span>
<span id="cb33-238"><a href="#cb33-238"></a>    <span class="fu">add_count</span>(mes_pedido, <span class="at">wt =</span> qt, <span class="at">name =</span> <span class="st">"qt_mes"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-239"><a href="#cb33-239"></a>    <span class="fu">mutate</span>(<span class="at">per =</span> qt <span class="sc">/</span> qt_mes) <span class="sc">%&gt;%</span> </span>
<span id="cb33-240"><a href="#cb33-240"></a>    <span class="fu">filter</span>(decisao <span class="sc">==</span> decisao_escolhida) <span class="sc">%&gt;%</span> </span>
<span id="cb33-241"><a href="#cb33-241"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> mes_pedido, <span class="at">y =</span> per)) <span class="sc">+</span></span>
<span id="cb33-242"><a href="#cb33-242"></a>    <span class="fu">geom_rect</span>(</span>
<span id="cb33-243"><a href="#cb33-243"></a>      <span class="at">data =</span> . <span class="sc">%&gt;%</span></span>
<span id="cb33-244"><a href="#cb33-244"></a>        <span class="fu">filter</span>(mes_pedido <span class="sc">==</span> <span class="fu">min</span>(mes_pedido) <span class="sc">|</span> mes_pedido <span class="sc">==</span> <span class="fu">max</span>(mes_pedido)),</span>
<span id="cb33-245"><a href="#cb33-245"></a>      <span class="fu">aes</span>(</span>
<span id="cb33-246"><a href="#cb33-246"></a>        <span class="at">xmin =</span> <span class="fu">floor_date</span>(<span class="fu">min</span>(mes_pedido), <span class="st">"year"</span>),</span>
<span id="cb33-247"><a href="#cb33-247"></a>        <span class="at">xmax =</span> <span class="fu">ceiling_date</span>(<span class="fu">max</span>(mes_pedido), <span class="st">"year"</span>),</span>
<span id="cb33-248"><a href="#cb33-248"></a>        <span class="at">ymin =</span> <span class="sc">-</span><span class="cn">Inf</span>,</span>
<span id="cb33-249"><a href="#cb33-249"></a>        <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb33-250"><a href="#cb33-250"></a>        <span class="at">fill =</span> decisao</span>
<span id="cb33-251"><a href="#cb33-251"></a>      ),</span>
<span id="cb33-252"><a href="#cb33-252"></a>      <span class="at">alpha =</span> .<span class="dv">2</span>,</span>
<span id="cb33-253"><a href="#cb33-253"></a>      <span class="at">show.legend =</span> F</span>
<span id="cb33-254"><a href="#cb33-254"></a>    ) <span class="sc">+</span></span>
<span id="cb33-255"><a href="#cb33-255"></a>    <span class="fu">geom_line</span>(<span class="at">show.legend =</span> F, <span class="at">size =</span> .<span class="dv">7</span>) <span class="sc">+</span></span>
<span id="cb33-256"><a href="#cb33-256"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">seq</span>(<span class="fu">ymd</span>(<span class="st">'2013-01-01'</span>), <span class="fu">ymd</span>(<span class="st">'2022-01-01'</span>), <span class="at">by =</span> <span class="st">'year'</span>), <span class="at">lty =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb33-257"><a href="#cb33-257"></a>    ggforce<span class="sc">::</span><span class="fu">geom_mark_circle</span>(</span>
<span id="cb33-258"><a href="#cb33-258"></a>      <span class="fu">aes</span>(<span class="at">filter =</span> mes_pedido <span class="sc">==</span> <span class="fu">ymd</span>(<span class="st">"2018-10-01"</span>) <span class="sc">&amp;</span> decisao <span class="sc">==</span> <span class="st">"Acesso Concedido"</span>,</span>
<span id="cb33-259"><a href="#cb33-259"></a>          <span class="at">label =</span> <span class="st">"Máximas anuais"</span>),</span>
<span id="cb33-260"><a href="#cb33-260"></a>      <span class="at">color =</span> <span class="st">"gray20"</span>,</span>
<span id="cb33-261"><a href="#cb33-261"></a>      <span class="at">fill =</span> <span class="cn">NA</span>,</span>
<span id="cb33-262"><a href="#cb33-262"></a>      <span class="at">radius =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">"mm"</span>),</span>
<span id="cb33-263"><a href="#cb33-263"></a>      <span class="at">expand =</span> <span class="dv">0</span>,</span>
<span id="cb33-264"><a href="#cb33-264"></a>      <span class="at">con.cap =</span> <span class="dv">0</span>,</span>
<span id="cb33-265"><a href="#cb33-265"></a>      <span class="at">label.fill =</span> <span class="fu">alpha</span>(cores_decisao[[<span class="st">"Acesso Concedido"</span>]], .<span class="dv">5</span>),</span>
<span id="cb33-266"><a href="#cb33-266"></a>      <span class="at">label.fontsize =</span> <span class="dv">10</span>,</span>
<span id="cb33-267"><a href="#cb33-267"></a>      <span class="at">label.fontface =</span> <span class="st">"plain"</span>,</span>
<span id="cb33-268"><a href="#cb33-268"></a>      <span class="at">label.buffer =</span> <span class="fu">unit</span>(<span class="dv">10</span>, <span class="st">"mm"</span>),</span>
<span id="cb33-269"><a href="#cb33-269"></a>      <span class="at">label.margin =</span> <span class="fu">margin</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="st">"mm"</span>)</span>
<span id="cb33-270"><a href="#cb33-270"></a>    ) <span class="sc">+</span></span>
<span id="cb33-271"><a href="#cb33-271"></a>    ggrepel<span class="sc">::</span><span class="fu">geom_label_repel</span>(</span>
<span id="cb33-272"><a href="#cb33-272"></a>      <span class="at">data =</span> . <span class="sc">%&gt;%</span></span>
<span id="cb33-273"><a href="#cb33-273"></a>        <span class="fu">group_by</span>(decisao, <span class="fu">year</span>(mes_pedido)) <span class="sc">%&gt;%</span></span>
<span id="cb33-274"><a href="#cb33-274"></a>        <span class="fu">arrange</span>(<span class="fu">year</span>(mes_pedido), decisao, <span class="sc">-</span>per) <span class="sc">%&gt;%</span></span>
<span id="cb33-275"><a href="#cb33-275"></a>        <span class="fu">filter</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-276"><a href="#cb33-276"></a>        <span class="fu">ungroup</span>(),</span>
<span id="cb33-277"><a href="#cb33-277"></a>      <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">my_lbl</span>(per), <span class="at">fill =</span> decisao, <span class="at">color =</span> decisao),</span>
<span id="cb33-278"><a href="#cb33-278"></a>      <span class="at">min.segment.length =</span> <span class="fl">0.01</span>,</span>
<span id="cb33-279"><a href="#cb33-279"></a>      <span class="at">size =</span> <span class="fl">3.5</span>,</span>
<span id="cb33-280"><a href="#cb33-280"></a>      <span class="at">label.padding =</span> <span class="fu">unit</span>(<span class="fl">0.1</span>, <span class="st">"lines"</span>),</span>
<span id="cb33-281"><a href="#cb33-281"></a>      <span class="at">label.size =</span> <span class="cn">NA</span>,</span>
<span id="cb33-282"><a href="#cb33-282"></a>      <span class="at">show.legend =</span> F</span>
<span id="cb33-283"><a href="#cb33-283"></a>    ) <span class="sc">+</span></span>
<span id="cb33-284"><a href="#cb33-284"></a>    <span class="fu">geom_point</span>(</span>
<span id="cb33-285"><a href="#cb33-285"></a>      <span class="at">data =</span> . <span class="sc">%&gt;%</span></span>
<span id="cb33-286"><a href="#cb33-286"></a>        <span class="fu">group_by</span>(decisao, <span class="fu">year</span>(mes_pedido)) <span class="sc">%&gt;%</span></span>
<span id="cb33-287"><a href="#cb33-287"></a>        <span class="fu">arrange</span>(<span class="fu">year</span>(mes_pedido), decisao, <span class="sc">-</span>per) <span class="sc">%&gt;%</span></span>
<span id="cb33-288"><a href="#cb33-288"></a>        <span class="fu">filter</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-289"><a href="#cb33-289"></a>        <span class="fu">ungroup</span>()</span>
<span id="cb33-290"><a href="#cb33-290"></a>    ) <span class="sc">+</span></span>
<span id="cb33-291"><a href="#cb33-291"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> cores_decisao) <span class="sc">+</span></span>
<span id="cb33-292"><a href="#cb33-292"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> cores_decisao3) <span class="sc">+</span></span>
<span id="cb33-293"><a href="#cb33-293"></a>    <span class="fu">scale_y_percent</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb33-294"><a href="#cb33-294"></a>    <span class="co"># scale_x_date(</span></span>
<span id="cb33-295"><a href="#cb33-295"></a>    <span class="co">#   breaks = scales::date_breaks("6 months"),</span></span>
<span id="cb33-296"><a href="#cb33-296"></a>    <span class="co">#   date_labels = "%b",</span></span>
<span id="cb33-297"><a href="#cb33-297"></a>    <span class="co">#   expand = c(0, 0)</span></span>
<span id="cb33-298"><a href="#cb33-298"></a>    <span class="co"># ) +</span></span>
<span id="cb33-299"><a href="#cb33-299"></a>    <span class="fu">scale_x_date</span>(</span>
<span id="cb33-300"><a href="#cb33-300"></a>      <span class="at">breaks =</span> <span class="fu">breaks_pretty</span>(<span class="dv">24</span>), </span>
<span id="cb33-301"><a href="#cb33-301"></a>      <span class="at">labels =</span> <span class="fu">label_date_short</span>(),</span>
<span id="cb33-302"><a href="#cb33-302"></a>      <span class="at">limits =</span> <span class="fu">c</span>(<span class="fu">ymd</span>(<span class="st">'2012-01-01'</span>), <span class="fu">ymd</span>(<span class="st">'2023-01-01'</span>)),</span>
<span id="cb33-303"><a href="#cb33-303"></a>      <span class="at">expand =</span> <span class="fu">c</span>(<span class="fl">0.</span>, <span class="dv">0</span>)</span>
<span id="cb33-304"><a href="#cb33-304"></a>    ) <span class="sc">+</span></span>
<span id="cb33-305"><a href="#cb33-305"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb33-306"><a href="#cb33-306"></a>    <span class="fu">theme</span>(</span>
<span id="cb33-307"><a href="#cb33-307"></a>      <span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb33-308"><a href="#cb33-308"></a>      <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(), </span>
<span id="cb33-309"><a href="#cb33-309"></a>      <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb33-310"><a href="#cb33-310"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb33-311"><a href="#cb33-311"></a>      <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb33-312"><a href="#cb33-312"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb33-313"><a href="#cb33-313"></a>      <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">angle =</span> <span class="dv">0</span>, <span class="at">hjust =</span> <span class="dv">0</span>)</span>
<span id="cb33-314"><a href="#cb33-314"></a>    ) <span class="sc">+</span></span>
<span id="cb33-315"><a href="#cb33-315"></a>    <span class="fu">labs</span>(</span>
<span id="cb33-316"><a href="#cb33-316"></a>      <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb33-317"><a href="#cb33-317"></a>      <span class="at">y =</span> <span class="cn">NULL</span>,</span>
<span id="cb33-318"><a href="#cb33-318"></a>      <span class="at">title =</span> <span class="cn">NULL</span>,</span>
<span id="cb33-319"><a href="#cb33-319"></a>      <span class="at">subtitle =</span> <span class="st">"Taxa mensal"</span>,</span>
<span id="cb33-320"><a href="#cb33-320"></a>      <span class="at">color =</span> <span class="cn">NULL</span>,</span>
<span id="cb33-321"><a href="#cb33-321"></a>      <span class="at">fill =</span> <span class="cn">NULL</span></span>
<span id="cb33-322"><a href="#cb33-322"></a>    )</span>
<span id="cb33-323"><a href="#cb33-323"></a>    </span>
<span id="cb33-324"><a href="#cb33-324"></a>  p2 <span class="ot">&lt;-</span> decisao <span class="sc">%&gt;%</span></span>
<span id="cb33-325"><a href="#cb33-325"></a>    <span class="fu">count</span>(<span class="at">ano =</span> <span class="fu">year</span>(mes_pedido), decisao, <span class="at">wt =</span> qt, <span class="at">name =</span> <span class="st">"qt"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-326"><a href="#cb33-326"></a>    <span class="fu">add_count</span>(ano, <span class="at">wt =</span> qt, <span class="at">name =</span> <span class="st">"qt_ano"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-327"><a href="#cb33-327"></a>    <span class="fu">mutate</span>(<span class="at">perc_ano =</span> qt <span class="sc">/</span> qt_ano) <span class="sc">%&gt;%</span></span>
<span id="cb33-328"><a href="#cb33-328"></a>    <span class="fu">filter</span>(decisao <span class="sc">==</span> decisao_escolhida) <span class="sc">%&gt;%</span> </span>
<span id="cb33-329"><a href="#cb33-329"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> perc_ano, <span class="at">y =</span> <span class="fu">reorder</span>(ano, <span class="sc">-</span>ano), <span class="at">fill =</span> decisao, <span class="at">color =</span> decisao)) <span class="sc">+</span></span>
<span id="cb33-330"><a href="#cb33-330"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span> <span class="fu">reorder</span>(decisao, <span class="sc">-</span>perc_ano), <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">scales =</span> <span class="st">"free_x"</span>) <span class="sc">+</span></span>
<span id="cb33-331"><a href="#cb33-331"></a>    <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">1</span>), <span class="at">alpha =</span> .<span class="dv">3</span>, <span class="at">fill =</span> <span class="st">"gray97"</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb33-332"><a href="#cb33-332"></a>    <span class="fu">geom_col</span>(<span class="at">alpha =</span> .<span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb33-333"><a href="#cb33-333"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">my_lbl</span>(perc_ano)), </span>
<span id="cb33-334"><a href="#cb33-334"></a>               <span class="at">size =</span> <span class="dv">4</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="sc">-</span>.<span class="dv">05</span>, <span class="at">check_overlap =</span> T) <span class="sc">+</span></span>
<span id="cb33-335"><a href="#cb33-335"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb33-336"><a href="#cb33-336"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> cores_decisao) <span class="sc">+</span></span>
<span id="cb33-337"><a href="#cb33-337"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> cores_decisao2) <span class="sc">+</span></span>
<span id="cb33-338"><a href="#cb33-338"></a>    <span class="fu">scale_x_percent</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">3</span>, .<span class="dv">6</span>, .<span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="cb33-339"><a href="#cb33-339"></a>    <span class="fu">scale_y_discrete</span>(<span class="at">labels =</span> <span class="fu">glue</span>(<span class="st">"{2022:2012}"</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb33-340"><a href="#cb33-340"></a>    <span class="co">#coord_flip() +</span></span>
<span id="cb33-341"><a href="#cb33-341"></a>    <span class="fu">theme</span>(</span>
<span id="cb33-342"><a href="#cb33-342"></a>      <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(),</span>
<span id="cb33-343"><a href="#cb33-343"></a>      <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"white"</span>),</span>
<span id="cb33-344"><a href="#cb33-344"></a>      <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb33-345"><a href="#cb33-345"></a>      <span class="at">panel.grid.minor.y =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"white"</span>),</span>
<span id="cb33-346"><a href="#cb33-346"></a>      <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb33-347"><a href="#cb33-347"></a>      <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"transparent"</span>),</span>
<span id="cb33-348"><a href="#cb33-348"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">vjust =</span> <span class="dv">2</span>),</span>
<span id="cb33-349"><a href="#cb33-349"></a>      <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">hjust =</span> <span class="dv">3</span>)</span>
<span id="cb33-350"><a href="#cb33-350"></a>    ) <span class="sc">+</span></span>
<span id="cb33-351"><a href="#cb33-351"></a>    <span class="fu">labs</span>(</span>
<span id="cb33-352"><a href="#cb33-352"></a>      <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb33-353"><a href="#cb33-353"></a>      <span class="at">y =</span> <span class="cn">NULL</span>,</span>
<span id="cb33-354"><a href="#cb33-354"></a>      <span class="at">fill =</span> <span class="cn">NULL</span>,</span>
<span id="cb33-355"><a href="#cb33-355"></a>      <span class="at">subtitle =</span> <span class="st">"Taxa anual"</span></span>
<span id="cb33-356"><a href="#cb33-356"></a>    )</span>
<span id="cb33-357"><a href="#cb33-357"></a>  </span>
<span id="cb33-358"><a href="#cb33-358"></a>  comb <span class="ot">&lt;-</span> p1 <span class="sc">+</span> p2 <span class="sc">&amp;</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) </span>
<span id="cb33-359"><a href="#cb33-359"></a>  </span>
<span id="cb33-360"><a href="#cb33-360"></a>  comb <span class="ot">&lt;-</span> comb <span class="sc">+</span></span>
<span id="cb33-361"><a href="#cb33-361"></a>    <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">widths =</span> <span class="fu">c</span>(<span class="fl">2.8</span>, <span class="fl">1.2</span>))</span>
<span id="cb33-362"><a href="#cb33-362"></a>  </span>
<span id="cb33-363"><a href="#cb33-363"></a>  <span class="fu">return</span>(comb)</span>
<span id="cb33-364"><a href="#cb33-364"></a>  </span>
<span id="cb33-365"><a href="#cb33-365"></a>}</span>
<span id="cb33-366"><a href="#cb33-366"></a></span>
<span id="cb33-367"><a href="#cb33-367"></a><span class="in">```</span></span>
<span id="cb33-368"><a href="#cb33-368"></a></span>
<span id="cb33-369"><a href="#cb33-369"></a>A **taxa de atendimento** é a proporção de uma decisão de acesso em relação à todos os pedidos de acesso a informação.</span>
<span id="cb33-370"><a href="#cb33-370"></a></span>
<span id="cb33-371"><a href="#cb33-371"></a><span class="kw">&lt;/br&gt;&lt;/br&gt;</span></span>
<span id="cb33-372"><a href="#cb33-372"></a></span>
<span id="cb33-373"><a href="#cb33-373"></a><span class="fu">### Taxa de Acessos Concedidos</span></span>
<span id="cb33-374"><a href="#cb33-374"></a></span>
<span id="cb33-375"><a href="#cb33-375"></a><span class="in">```{r plot-acesso-concedido, fig.width=11}</span></span>
<span id="cb33-376"><a href="#cb33-376"></a><span class="fu">plot_decisao</span>(<span class="st">"Acesso Concedido"</span>) </span>
<span id="cb33-377"><a href="#cb33-377"></a><span class="in">```</span></span>
<span id="cb33-378"><a href="#cb33-378"></a></span>
<span id="cb33-379"><a href="#cb33-379"></a><span class="kw">&lt;/br&gt;&lt;/br&gt;</span></span>
<span id="cb33-380"><a href="#cb33-380"></a></span>
<span id="cb33-381"><a href="#cb33-381"></a><span class="fu">### Taxa de Acessos Negados</span></span>
<span id="cb33-382"><a href="#cb33-382"></a></span>
<span id="cb33-383"><a href="#cb33-383"></a><span class="in">```{r plot-acesso-negado, fig.width=11}</span></span>
<span id="cb33-384"><a href="#cb33-384"></a><span class="fu">plot_decisao</span>(<span class="st">"Acesso Negado"</span>) </span>
<span id="cb33-385"><a href="#cb33-385"></a><span class="in">```</span></span>
<span id="cb33-386"><a href="#cb33-386"></a></span>
<span id="cb33-387"><a href="#cb33-387"></a><span class="kw">&lt;/br&gt;&lt;/br&gt;</span></span>
<span id="cb33-388"><a href="#cb33-388"></a></span>
<span id="cb33-389"><a href="#cb33-389"></a><span class="fu">### Taxa de Acessos Parcialmente Concedido</span></span>
<span id="cb33-390"><a href="#cb33-390"></a></span>
<span id="cb33-391"><a href="#cb33-391"></a><span class="in">```{r plot-acesso-parcial, fig.width=11}</span></span>
<span id="cb33-392"><a href="#cb33-392"></a><span class="fu">plot_decisao</span>(<span class="st">"Acesso Parcialmente Concedido"</span>) </span>
<span id="cb33-393"><a href="#cb33-393"></a><span class="in">```</span></span>
<span id="cb33-394"><a href="#cb33-394"></a></span>
<span id="cb33-395"><a href="#cb33-395"></a><span class="kw">&lt;/br&gt;&lt;/br&gt;</span></span>
<span id="cb33-396"><a href="#cb33-396"></a></span>
<span id="cb33-397"><a href="#cb33-397"></a><span class="fu">### Taxa para a decisão "Órgão não tem competência para responder sobre o assunto"</span></span>
<span id="cb33-398"><a href="#cb33-398"></a></span>
<span id="cb33-399"><a href="#cb33-399"></a><span class="in">```{r plot-orgao-sem-competencia, fig.width=11}</span></span>
<span id="cb33-400"><a href="#cb33-400"></a><span class="fu">plot_decisao</span>(<span class="st">"Órgão não tem competência para responder sobre o assunto"</span>) </span>
<span id="cb33-401"><a href="#cb33-401"></a><span class="in">```</span></span>
<span id="cb33-402"><a href="#cb33-402"></a></span>
<span id="cb33-403"><a href="#cb33-403"></a><span class="kw">&lt;/br&gt;&lt;/br&gt;</span></span>
<span id="cb33-404"><a href="#cb33-404"></a></span>
<span id="cb33-405"><a href="#cb33-405"></a><span class="fu">### Taxa de resposta de "Informação Inexistente"</span></span>
<span id="cb33-406"><a href="#cb33-406"></a></span>
<span id="cb33-407"><a href="#cb33-407"></a><span class="in">```{r plot-informacao-inexistente, fig.width=10}</span></span>
<span id="cb33-408"><a href="#cb33-408"></a><span class="fu">plot_decisao</span>(<span class="st">"Informação Inexistente"</span>) </span>
<span id="cb33-409"><a href="#cb33-409"></a><span class="in">```</span></span>
<span id="cb33-410"><a href="#cb33-410"></a></span>
<span id="cb33-411"><a href="#cb33-411"></a><span class="kw">&lt;/br&gt;&lt;/br&gt;</span></span>
<span id="cb33-412"><a href="#cb33-412"></a></span>
<span id="cb33-413"><a href="#cb33-413"></a><span class="fu">## Taxas de respostas por decisão de acesso - mesmo período - (2012-2022)</span></span>
<span id="cb33-414"><a href="#cb33-414"></a></span>
<span id="cb33-415"><a href="#cb33-415"></a><span class="in">```{r plot-taxa-de-resposta-mesmo-periodo, fig.width = 10, fig.height=7}</span></span>
<span id="cb33-416"><a href="#cb33-416"></a>decisao <span class="sc">%&gt;%</span></span>
<span id="cb33-417"><a href="#cb33-417"></a>  <span class="fu">mutate</span>(<span class="at">mesmo_periodo =</span> <span class="fu">month</span>(mes_pedido) <span class="sc">&lt;=</span> <span class="fu">month</span>(<span class="fu">today</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb33-418"><a href="#cb33-418"></a>  <span class="fu">add_count</span>(mes_pedido, mesmo_periodo, <span class="at">wt =</span> qt, <span class="at">name =</span> <span class="st">"qt_mes"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-419"><a href="#cb33-419"></a>  <span class="fu">mutate</span>(<span class="at">perc =</span> qt <span class="sc">/</span> qt_mes) <span class="sc">%&gt;%</span></span>
<span id="cb33-420"><a href="#cb33-420"></a>  <span class="co"># filter(decisao == "Acesso Negado") %&gt;%</span></span>
<span id="cb33-421"><a href="#cb33-421"></a>  <span class="fu">filter</span>(decisao <span class="sc">%in%</span> <span class="fu">c</span>(</span>
<span id="cb33-422"><a href="#cb33-422"></a>    <span class="st">"Acesso Negado"</span>,</span>
<span id="cb33-423"><a href="#cb33-423"></a>    <span class="st">"Acesso Parcialmente Concedido"</span></span>
<span id="cb33-424"><a href="#cb33-424"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb33-425"><a href="#cb33-425"></a>  <span class="fu">group_by</span>(<span class="at">ano =</span> <span class="fu">year</span>(mes_pedido), mesmo_periodo, decisao) <span class="sc">%&gt;%</span></span>
<span id="cb33-426"><a href="#cb33-426"></a>  <span class="fu">mutate</span>(<span class="at">media_perc =</span> <span class="fu">if_else</span>(mesmo_periodo, <span class="fu">mean</span>(perc), <span class="cn">NA_real_</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb33-427"><a href="#cb33-427"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb33-428"><a href="#cb33-428"></a>  <span class="fu">mutate</span>(</span>
<span id="cb33-429"><a href="#cb33-429"></a>   <span class="at">decisao2 =</span> <span class="fu">if_else</span>(mesmo_periodo, <span class="fu">as.character</span>(decisao), <span class="st">""</span>)</span>
<span id="cb33-430"><a href="#cb33-430"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb33-431"><a href="#cb33-431"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> mes_pedido, <span class="at">y =</span> perc, <span class="at">fill =</span> decisao2)) <span class="sc">+</span></span>
<span id="cb33-432"><a href="#cb33-432"></a>  <span class="fu">geom_vline</span>(</span>
<span id="cb33-433"><a href="#cb33-433"></a>    <span class="at">xintercept =</span> <span class="fu">seq</span>(<span class="fu">ymd</span>(<span class="st">"2013-01-01"</span>), <span class="fu">ymd</span>(<span class="st">"2022-01-01"</span>), <span class="at">by =</span> <span class="st">"year"</span>),</span>
<span id="cb33-434"><a href="#cb33-434"></a>    <span class="at">lty =</span> <span class="dv">3</span></span>
<span id="cb33-435"><a href="#cb33-435"></a>  ) <span class="sc">+</span></span>
<span id="cb33-436"><a href="#cb33-436"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb33-437"><a href="#cb33-437"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> media_perc), <span class="at">shape =</span> <span class="dv">95</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb33-438"><a href="#cb33-438"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb33-439"><a href="#cb33-439"></a>    <span class="at">data =</span> . <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">month</span>(mes_pedido) <span class="sc">==</span> <span class="fu">month</span>(<span class="fu">today</span>())),</span>
<span id="cb33-440"><a href="#cb33-440"></a>    <span class="at">check_overlap =</span> <span class="cn">TRUE</span>,</span>
<span id="cb33-441"><a href="#cb33-441"></a>    <span class="at">fontface =</span> <span class="st">"bold"</span>,</span>
<span id="cb33-442"><a href="#cb33-442"></a>    <span class="at">size =</span> <span class="fl">3.5</span>,</span>
<span id="cb33-443"><a href="#cb33-443"></a>    <span class="fu">aes</span>(</span>
<span id="cb33-444"><a href="#cb33-444"></a>      <span class="at">y =</span> media_perc,</span>
<span id="cb33-445"><a href="#cb33-445"></a>      <span class="at">label =</span> <span class="fu">my_lbl</span>(media_perc)</span>
<span id="cb33-446"><a href="#cb33-446"></a>      ),</span>
<span id="cb33-447"><a href="#cb33-447"></a>    <span class="at">nudge_y =</span> .<span class="dv">006</span>,</span>
<span id="cb33-448"><a href="#cb33-448"></a>    <span class="at">hjust =</span> .<span class="dv">5</span>,</span>
<span id="cb33-449"><a href="#cb33-449"></a>  ) <span class="sc">+</span></span>
<span id="cb33-450"><a href="#cb33-450"></a>  <span class="fu">geom_curve</span>(</span>
<span id="cb33-451"><a href="#cb33-451"></a>    <span class="at">data =</span> . <span class="sc">%&gt;%</span> <span class="fu">filter</span>(decisao2 <span class="sc">==</span> <span class="st">"Acesso Parcialmente Concedido"</span>),</span>
<span id="cb33-452"><a href="#cb33-452"></a>    <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">ymd</span>(<span class="st">"2019-03-01"</span>),</span>
<span id="cb33-453"><a href="#cb33-453"></a>        <span class="at">y =</span> <span class="fl">0.115</span>, </span>
<span id="cb33-454"><a href="#cb33-454"></a>        <span class="at">xend =</span> <span class="fu">ymd</span>(<span class="st">"2019-03-01"</span>),</span>
<span id="cb33-455"><a href="#cb33-455"></a>        <span class="at">yend =</span> <span class="fl">0.075</span>),</span>
<span id="cb33-456"><a href="#cb33-456"></a>    <span class="at">colour =</span> <span class="st">"black"</span>,</span>
<span id="cb33-457"><a href="#cb33-457"></a>    <span class="at">size =</span> <span class="fl">0.6</span>,</span>
<span id="cb33-458"><a href="#cb33-458"></a>    <span class="at">curvature =</span> .<span class="dv">35</span>,</span>
<span id="cb33-459"><a href="#cb33-459"></a>    <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.2</span>, <span class="st">"cm"</span>))</span>
<span id="cb33-460"><a href="#cb33-460"></a>  ) <span class="sc">+</span></span>
<span id="cb33-461"><a href="#cb33-461"></a>  <span class="fu">geom_label</span>(</span>
<span id="cb33-462"><a href="#cb33-462"></a>    <span class="at">data =</span> . <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mes_pedido <span class="sc">==</span> <span class="fu">ymd</span>(<span class="st">"2019-04-01"</span>) <span class="sc">&amp;</span> decisao2 <span class="sc">==</span> <span class="st">"Acesso Parcialmente Concedido"</span>),</span>
<span id="cb33-463"><a href="#cb33-463"></a>    <span class="fu">aes</span>(<span class="at">label =</span> <span class="st">"Média anual</span><span class="sc">\n</span><span class="st">(mesmo período)"</span>, <span class="at">y =</span> .<span class="dv">125</span>, <span class="at">x =</span> mes_pedido),</span>
<span id="cb33-464"><a href="#cb33-464"></a>    <span class="at">fill =</span> <span class="st">"white"</span>,</span>
<span id="cb33-465"><a href="#cb33-465"></a>    <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb33-466"><a href="#cb33-466"></a>    <span class="at">label.size =</span> <span class="cn">NA</span></span>
<span id="cb33-467"><a href="#cb33-467"></a>  ) <span class="sc">+</span></span>
<span id="cb33-468"><a href="#cb33-468"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"gray70"</span>, cores_decisao[<span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">4</span>)])) <span class="sc">+</span></span>
<span id="cb33-469"><a href="#cb33-469"></a>  <span class="fu">facet_wrap</span>(. <span class="sc">~</span> <span class="fu">reorder</span>(decisao, <span class="sc">-</span>perc), <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">scales =</span> <span class="st">"free_x"</span>) <span class="sc">+</span></span>
<span id="cb33-470"><a href="#cb33-470"></a>  hrbrthemes<span class="sc">::</span><span class="fu">scale_y_percent</span>() <span class="sc">+</span></span>
<span id="cb33-471"><a href="#cb33-471"></a>  <span class="fu">scale_x_date</span>(</span>
<span id="cb33-472"><a href="#cb33-472"></a>    <span class="at">breaks =</span> <span class="fu">breaks_pretty</span>(<span class="dv">36</span>), </span>
<span id="cb33-473"><a href="#cb33-473"></a>    <span class="at">labels =</span> <span class="fu">label_date_short</span>(),</span>
<span id="cb33-474"><a href="#cb33-474"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="fu">ymd</span>(<span class="st">'2012-01-01'</span>), <span class="fu">ymd</span>(<span class="st">'2023-01-01'</span>)),</span>
<span id="cb33-475"><a href="#cb33-475"></a>    <span class="at">expand =</span> <span class="fu">c</span>(<span class="fl">0.</span>, <span class="dv">0</span>)</span>
<span id="cb33-476"><a href="#cb33-476"></a>  ) <span class="sc">+</span></span>
<span id="cb33-477"><a href="#cb33-477"></a>  <span class="fu">theme</span>(</span>
<span id="cb33-478"><a href="#cb33-478"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb33-479"><a href="#cb33-479"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb33-480"><a href="#cb33-480"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>)</span>
<span id="cb33-481"><a href="#cb33-481"></a>  ) <span class="sc">+</span></span>
<span id="cb33-482"><a href="#cb33-482"></a>  <span class="fu">labs</span>(</span>
<span id="cb33-483"><a href="#cb33-483"></a>    <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb33-484"><a href="#cb33-484"></a>    <span class="at">y =</span> <span class="cn">NULL</span>,</span>
<span id="cb33-485"><a href="#cb33-485"></a>    <span class="at">title =</span> <span class="cn">NULL</span>,</span>
<span id="cb33-486"><a href="#cb33-486"></a>    <span class="at">subtitle =</span> <span class="st">"Como % do total de pedidos de acesso a informação"</span></span>
<span id="cb33-487"><a href="#cb33-487"></a>  )</span>
<span id="cb33-488"><a href="#cb33-488"></a><span class="in">```</span></span>
<span id="cb33-489"><a href="#cb33-489"></a></span>
<span id="cb33-490"><a href="#cb33-490"></a><span class="kw">&lt;/br&gt;&lt;/br&gt;</span></span>
<span id="cb33-491"><a href="#cb33-491"></a></span>
<span id="cb33-492"><a href="#cb33-492"></a><span class="fu">## Negativas de acesso</span></span>
<span id="cb33-493"><a href="#cb33-493"></a></span>
<span id="cb33-494"><a href="#cb33-494"></a><span class="fu">### Metodologia (taxa geral e interna de acessos negados)</span></span>
<span id="cb33-495"><a href="#cb33-495"></a></span>
<span id="cb33-496"><a href="#cb33-496"></a>Pedidos de acesso a informação são solicitações no FalaBr que <span class="kw">&lt;u&gt;</span>não<span class="kw">&lt;/u&gt;</span> foram classificadas como: "Pergunta Duplicada/Repetida", "Não se trata de solicitação de informação".</span>
<span id="cb33-497"><a href="#cb33-497"></a></span>
<span id="cb33-498"><a href="#cb33-498"></a>As negativas de acesso são abordadas de duas formas:</span>
<span id="cb33-499"><a href="#cb33-499"></a></span>
<span id="cb33-500"><a href="#cb33-500"></a><span class="ss">-   </span>Taxa geral de negativas por órgão:</span>
<span id="cb33-501"><a href="#cb33-501"></a></span>
<span id="cb33-502"><a href="#cb33-502"></a>$$</span>
<span id="cb33-503"><a href="#cb33-503"></a>Taxa\:geral\:\:de\:negativas\:por\:órgão = \frac{{Total\:Acessos\:Negados\:no\:órgão}_{mês}}{{Total\:Acessos\:Negados\:no\:FalaBr}_{mês}} \times 100</span>
<span id="cb33-504"><a href="#cb33-504"></a>$$</span>
<span id="cb33-505"><a href="#cb33-505"></a></span>
<span id="cb33-506"><a href="#cb33-506"></a><span class="ss">-   </span>Taxa interna de negativas por órgão</span>
<span id="cb33-507"><a href="#cb33-507"></a></span>
<span id="cb33-508"><a href="#cb33-508"></a>$$</span>
<span id="cb33-509"><a href="#cb33-509"></a>Taxa\:interna\:de\:negativas\:por\:órgão = \frac{{Total\:Acessos\:Negados\:no\:órgão}_{mês}}{{Total\:pedidos\:recebidos\:pelo\:órgão}_{mês}} \times 100</span>
<span id="cb33-510"><a href="#cb33-510"></a>$$</span>
<span id="cb33-511"><a href="#cb33-511"></a></span>
<span id="cb33-512"><a href="#cb33-512"></a><span class="in">```{r data-taxas-acessos-negados}</span></span>
<span id="cb33-513"><a href="#cb33-513"></a>taxas <span class="ot">&lt;-</span> pedidos_cgu <span class="sc">%&gt;%</span></span>
<span id="cb33-514"><a href="#cb33-514"></a>  <span class="fu">select</span>(id_pedido, mes_pedido, decisao, orgao) <span class="sc">%&gt;%</span> </span>
<span id="cb33-515"><a href="#cb33-515"></a>  <span class="fu">filter</span>(decisao <span class="sc">%notin%</span> <span class="fu">c</span>(</span>
<span id="cb33-516"><a href="#cb33-516"></a>    <span class="st">"Pergunta Duplicada/Repetida"</span>,</span>
<span id="cb33-517"><a href="#cb33-517"></a>    <span class="st">"Não se trata de solicitação de informação"</span></span>
<span id="cb33-518"><a href="#cb33-518"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb33-519"><a href="#cb33-519"></a>  <span class="fu">mutate</span>(<span class="at">orgao =</span> <span class="fu">str_wrap</span>(orgao, <span class="dv">40</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb33-520"><a href="#cb33-520"></a>  <span class="co"># contagem de pedidos anuais</span></span>
<span id="cb33-521"><a href="#cb33-521"></a>  <span class="fu">add_count</span>(<span class="at">name =</span> <span class="st">"n_ano"</span>, <span class="at">ano =</span> <span class="fu">year</span>(mes_pedido)) <span class="sc">%&gt;%</span> </span>
<span id="cb33-522"><a href="#cb33-522"></a>  <span class="fu">add_count</span>(<span class="at">name =</span> <span class="st">"n_ano_orgao"</span>, ano, orgao) <span class="sc">%&gt;%</span> </span>
<span id="cb33-523"><a href="#cb33-523"></a>  <span class="fu">add_count</span>(<span class="at">name =</span> <span class="st">"n_ano_decisao"</span>, ano, decisao) <span class="sc">%&gt;%</span> </span>
<span id="cb33-524"><a href="#cb33-524"></a>  <span class="fu">add_count</span>(<span class="at">name =</span> <span class="st">"n_ano_decisao_orgao"</span>, ano, decisao, orgao) <span class="sc">%&gt;%</span> </span>
<span id="cb33-525"><a href="#cb33-525"></a>  <span class="co"># contagem de pedidos mensais</span></span>
<span id="cb33-526"><a href="#cb33-526"></a>  <span class="fu">add_count</span>(<span class="at">name =</span> <span class="st">"n_mes"</span>, mes_pedido) <span class="sc">%&gt;%</span> </span>
<span id="cb33-527"><a href="#cb33-527"></a>  <span class="fu">add_count</span>(<span class="at">name =</span> <span class="st">"n_mes_orgao"</span>, mes_pedido, orgao) <span class="sc">%&gt;%</span> </span>
<span id="cb33-528"><a href="#cb33-528"></a>  <span class="fu">add_count</span>(<span class="at">name =</span> <span class="st">"n_mes_decisao"</span>, mes_pedido, decisao) <span class="sc">%&gt;%</span> </span>
<span id="cb33-529"><a href="#cb33-529"></a>  <span class="fu">add_count</span>(<span class="at">name =</span> <span class="st">"n_mes_decisao_orgao"</span>, mes_pedido, decisao, orgao) <span class="sc">%&gt;%</span> </span>
<span id="cb33-530"><a href="#cb33-530"></a>  <span class="fu">group_by</span>(</span>
<span id="cb33-531"><a href="#cb33-531"></a>    ano,</span>
<span id="cb33-532"><a href="#cb33-532"></a>    mes_pedido,</span>
<span id="cb33-533"><a href="#cb33-533"></a>    decisao,</span>
<span id="cb33-534"><a href="#cb33-534"></a>    orgao,</span>
<span id="cb33-535"><a href="#cb33-535"></a>    n_ano,</span>
<span id="cb33-536"><a href="#cb33-536"></a>    n_ano_decisao,</span>
<span id="cb33-537"><a href="#cb33-537"></a>    n_ano_orgao,</span>
<span id="cb33-538"><a href="#cb33-538"></a>    n_ano_decisao_orgao,</span>
<span id="cb33-539"><a href="#cb33-539"></a>    n_mes,</span>
<span id="cb33-540"><a href="#cb33-540"></a>    n_mes_decisao,</span>
<span id="cb33-541"><a href="#cb33-541"></a>    n_mes_orgao,</span>
<span id="cb33-542"><a href="#cb33-542"></a>    n_mes_decisao_orgao</span>
<span id="cb33-543"><a href="#cb33-543"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb33-544"><a href="#cb33-544"></a>  <span class="fu">summarise</span>(<span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb33-545"><a href="#cb33-545"></a><span class="in">```</span></span>
<span id="cb33-546"><a href="#cb33-546"></a></span>
<span id="cb33-547"><a href="#cb33-547"></a><span class="kw">&lt;/br&gt;&lt;/br&gt;</span></span>
<span id="cb33-548"><a href="#cb33-548"></a></span>
<span id="cb33-549"><a href="#cb33-549"></a><span class="fu">### Órgãos que mais negaram informações - mês a mês (2012-2022)</span></span>
<span id="cb33-550"><a href="#cb33-550"></a></span>
<span id="cb33-551"><a href="#cb33-551"></a><span class="in">```{r plot-acessos-negados-geral, fig.height=10, fig.width=11}</span></span>
<span id="cb33-552"><a href="#cb33-552"></a>month.abb2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) month.abb[<span class="fu">month</span>(x)]</span>
<span id="cb33-553"><a href="#cb33-553"></a></span>
<span id="cb33-554"><a href="#cb33-554"></a>taxas <span class="sc">%&gt;%</span> </span>
<span id="cb33-555"><a href="#cb33-555"></a>  <span class="fu">filter</span>(decisao <span class="sc">==</span> <span class="st">"Acesso Negado"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb33-556"><a href="#cb33-556"></a>  <span class="fu">transmute</span>(</span>
<span id="cb33-557"><a href="#cb33-557"></a>    mes_pedido,</span>
<span id="cb33-558"><a href="#cb33-558"></a>    orgao,</span>
<span id="cb33-559"><a href="#cb33-559"></a>    <span class="at">per =</span> n_mes_decisao_orgao <span class="sc">/</span> n_mes_decisao</span>
<span id="cb33-560"><a href="#cb33-560"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb33-561"><a href="#cb33-561"></a>  <span class="fu">group_by</span>(mes_pedido) <span class="sc">%&gt;%</span> </span>
<span id="cb33-562"><a href="#cb33-562"></a>  <span class="fu">slice_max</span>(<span class="at">order_by =</span> per, <span class="at">n =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb33-563"><a href="#cb33-563"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb33-564"><a href="#cb33-564"></a>  <span class="fu">mutate</span>(<span class="at">mes =</span> <span class="fu">month.abb2</span>(mes_pedido)) <span class="sc">%&gt;%</span></span>
<span id="cb33-565"><a href="#cb33-565"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> mes_pedido, <span class="at">y =</span> per, <span class="at">color =</span> orgao)) <span class="sc">+</span></span>
<span id="cb33-566"><a href="#cb33-566"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(</span>
<span id="cb33-567"><a href="#cb33-567"></a>    <span class="at">y =</span> <span class="dv">0</span>,</span>
<span id="cb33-568"><a href="#cb33-568"></a>    <span class="at">yend =</span> per,</span>
<span id="cb33-569"><a href="#cb33-569"></a>    <span class="at">x =</span> mes_pedido,</span>
<span id="cb33-570"><a href="#cb33-570"></a>    <span class="at">xend =</span> mes_pedido),</span>
<span id="cb33-571"><a href="#cb33-571"></a>    <span class="at">color =</span> <span class="st">"gray60"</span></span>
<span id="cb33-572"><a href="#cb33-572"></a>  ) <span class="sc">+</span></span>
<span id="cb33-573"><a href="#cb33-573"></a>  <span class="fu">geom_vline</span>(</span>
<span id="cb33-574"><a href="#cb33-574"></a>    <span class="at">xintercept =</span> <span class="fu">seq</span>(<span class="fu">ymd</span>(<span class="st">'2013-01-01'</span>), <span class="fu">ymd</span>(<span class="st">'2022-01-01'</span>), <span class="at">by =</span> <span class="st">'year'</span>),</span>
<span id="cb33-575"><a href="#cb33-575"></a>    <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"gray80"</span></span>
<span id="cb33-576"><a href="#cb33-576"></a>  ) <span class="sc">+</span></span>
<span id="cb33-577"><a href="#cb33-577"></a>  <span class="fu">scale_y_percent</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.7</span>)) <span class="sc">+</span></span>
<span id="cb33-578"><a href="#cb33-578"></a>  <span class="fu">scale_x_date</span>(</span>
<span id="cb33-579"><a href="#cb33-579"></a>    <span class="at">breaks =</span> <span class="fu">breaks_pretty</span>(<span class="dv">24</span>), </span>
<span id="cb33-580"><a href="#cb33-580"></a>    <span class="at">labels =</span> <span class="fu">label_date_short</span>(),</span>
<span id="cb33-581"><a href="#cb33-581"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="fu">ymd</span>(<span class="st">'2012-01-01'</span>), <span class="fu">ymd</span>(<span class="st">'2022-12-01'</span>)),</span>
<span id="cb33-582"><a href="#cb33-582"></a>    <span class="at">expand =</span> <span class="fu">c</span>(<span class="fl">0.</span>, <span class="dv">0</span>)</span>
<span id="cb33-583"><a href="#cb33-583"></a>  ) <span class="sc">+</span></span>
<span id="cb33-584"><a href="#cb33-584"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>, <span class="at">alpha =</span> .<span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb33-585"><a href="#cb33-585"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb33-586"><a href="#cb33-586"></a>    <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">str_extract</span>(orgao, <span class="st">"^[:upper:]+(?= )|^GSI-PR"</span>),</span>
<span id="cb33-587"><a href="#cb33-587"></a>        <span class="at">y =</span> per),</span>
<span id="cb33-588"><a href="#cb33-588"></a>    <span class="at">size =</span> <span class="fl">2.7</span>,</span>
<span id="cb33-589"><a href="#cb33-589"></a>    <span class="at">angle =</span> <span class="dv">90</span>,</span>
<span id="cb33-590"><a href="#cb33-590"></a>    <span class="at">fontface =</span> <span class="st">"bold"</span>,</span>
<span id="cb33-591"><a href="#cb33-591"></a>    <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb33-592"><a href="#cb33-592"></a>    <span class="at">hjust =</span> <span class="dv">0</span>,</span>
<span id="cb33-593"><a href="#cb33-593"></a>    <span class="at">check_overlap =</span> T</span>
<span id="cb33-594"><a href="#cb33-594"></a>  ) <span class="sc">+</span></span>
<span id="cb33-595"><a href="#cb33-595"></a>  <span class="fu">theme</span>(</span>
<span id="cb33-596"><a href="#cb33-596"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb33-597"><a href="#cb33-597"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">0</span>, <span class="st">"pt"</span>)),</span>
<span id="cb33-598"><a href="#cb33-598"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb33-599"><a href="#cb33-599"></a>    <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> .<span class="dv">7</span>),</span>
<span id="cb33-600"><a href="#cb33-600"></a>    <span class="co"># axis.text = element_text(size = 11),</span></span>
<span id="cb33-601"><a href="#cb33-601"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb33-602"><a href="#cb33-602"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>),</span>
<span id="cb33-603"><a href="#cb33-603"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>)</span>
<span id="cb33-604"><a href="#cb33-604"></a>  ) <span class="sc">+</span></span>
<span id="cb33-605"><a href="#cb33-605"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">title.position =</span> <span class="st">"top"</span>)) <span class="sc">+</span></span>
<span id="cb33-606"><a href="#cb33-606"></a>  <span class="fu">labs</span>(</span>
<span id="cb33-607"><a href="#cb33-607"></a>    <span class="at">color =</span> <span class="st">"Sigla do órgão que mais negou acesso a informação no mês:"</span>,</span>
<span id="cb33-608"><a href="#cb33-608"></a>    <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb33-609"><a href="#cb33-609"></a>    <span class="at">y =</span> <span class="st">"% do total de acessos negados</span><span class="sc">\n</span><span class="st">entre todos os pedidos no FalaBr"</span></span>
<span id="cb33-610"><a href="#cb33-610"></a>  )</span>
<span id="cb33-611"><a href="#cb33-611"></a><span class="in">```</span></span>
<span id="cb33-612"><a href="#cb33-612"></a></span>
<span id="cb33-613"><a href="#cb33-613"></a><span class="kw">&lt;/br&gt;&lt;/br&gt;</span></span>
<span id="cb33-614"><a href="#cb33-614"></a></span>
<span id="cb33-615"><a href="#cb33-615"></a><span class="fu">### Poucos órgãos são responsáveis por mais da metade das negativas do FalaBr</span></span>
<span id="cb33-616"><a href="#cb33-616"></a></span>
<span id="cb33-617"><a href="#cb33-617"></a><span class="in">```{r plot-metade-das-negativas, fig.height=7, fig.width=9}</span></span>
<span id="cb33-618"><a href="#cb33-618"></a>top_opacos <span class="ot">&lt;-</span> taxas <span class="sc">%&gt;%</span> </span>
<span id="cb33-619"><a href="#cb33-619"></a>  <span class="fu">filter</span>(decisao <span class="sc">==</span> <span class="st">"Acesso Negado"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-620"><a href="#cb33-620"></a>  <span class="fu">distinct</span>(</span>
<span id="cb33-621"><a href="#cb33-621"></a>    ano,</span>
<span id="cb33-622"><a href="#cb33-622"></a>    orgao,</span>
<span id="cb33-623"><a href="#cb33-623"></a>    n_ano_decisao,</span>
<span id="cb33-624"><a href="#cb33-624"></a>    n_ano_decisao_orgao,</span>
<span id="cb33-625"><a href="#cb33-625"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb33-626"><a href="#cb33-626"></a>  <span class="fu">arrange</span>(ano, <span class="sc">-</span>n_ano_decisao_orgao) <span class="sc">%&gt;%</span> </span>
<span id="cb33-627"><a href="#cb33-627"></a>  <span class="fu">mutate</span>(<span class="at">per =</span> n_ano_decisao_orgao <span class="sc">/</span> n_ano_decisao) <span class="sc">%&gt;%</span></span>
<span id="cb33-628"><a href="#cb33-628"></a>  <span class="fu">group_by</span>(ano) <span class="sc">%&gt;%</span> </span>
<span id="cb33-629"><a href="#cb33-629"></a>  <span class="fu">mutate</span>(</span>
<span id="cb33-630"><a href="#cb33-630"></a>    <span class="at">ord =</span> <span class="fu">row_number</span>(),</span>
<span id="cb33-631"><a href="#cb33-631"></a>    <span class="at">per_acum =</span> <span class="fu">cumsum</span>(per),</span>
<span id="cb33-632"><a href="#cb33-632"></a>    <span class="at">cutoff =</span> <span class="fu">lag</span>(per_acum <span class="sc">&lt;=</span> .<span class="dv">5</span>),</span>
<span id="cb33-633"><a href="#cb33-633"></a>    <span class="at">cutoff =</span> <span class="fu">if_else</span>(<span class="fu">is.na</span>(cutoff) <span class="sc">|</span> cutoff, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>)</span>
<span id="cb33-634"><a href="#cb33-634"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb33-635"><a href="#cb33-635"></a>  <span class="fu">filter</span>(cutoff) <span class="sc">%&gt;%</span> </span>
<span id="cb33-636"><a href="#cb33-636"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb33-637"><a href="#cb33-637"></a>  <span class="fu">mutate</span>(<span class="at">sigla =</span> <span class="fu">str_extract</span>(orgao, <span class="st">"^[:upper:]+(?= )|^GSI-PR"</span>))</span>
<span id="cb33-638"><a href="#cb33-638"></a></span>
<span id="cb33-639"><a href="#cb33-639"></a>top_opacos_pqn <span class="ot">&lt;-</span> top_opacos <span class="sc">%&gt;%</span> </span>
<span id="cb33-640"><a href="#cb33-640"></a>  <span class="fu">filter</span>(per <span class="sc">&lt;=</span> .<span class="dv">05</span>, ano <span class="sc">&gt;</span> <span class="dv">2016</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-641"><a href="#cb33-641"></a>  <span class="fu">arrange</span>(ano, <span class="sc">-</span>per) <span class="sc">%&gt;%</span> </span>
<span id="cb33-642"><a href="#cb33-642"></a>  <span class="fu">group_by</span>(ano) <span class="sc">%&gt;%</span> </span>
<span id="cb33-643"><a href="#cb33-643"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb33-644"><a href="#cb33-644"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb33-645"><a href="#cb33-645"></a>  <span class="fu">mutate</span>(</span>
<span id="cb33-646"><a href="#cb33-646"></a>    <span class="at">sigla =</span> <span class="fu">map</span>(data, pull, sigla),</span>
<span id="cb33-647"><a href="#cb33-647"></a>    <span class="at">sigla =</span> <span class="fu">paste</span>(sigla),</span>
<span id="cb33-648"><a href="#cb33-648"></a>    <span class="at">sigla =</span> <span class="fu">str_remove_all</span>(sigla, <span class="st">"^c</span><span class="sc">\\</span><span class="st">(|</span><span class="sc">\\\"</span><span class="st">|</span><span class="sc">\\</span><span class="st">)"</span> ),</span>
<span id="cb33-649"><a href="#cb33-649"></a>    <span class="at">sigla =</span> <span class="fu">str_replace_all</span>(sigla, <span class="st">", "</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>),</span>
<span id="cb33-650"><a href="#cb33-650"></a>    <span class="co"># orgao = map(data, pull, orgao),</span></span>
<span id="cb33-651"><a href="#cb33-651"></a>    <span class="co"># orgao = paste(orgao),</span></span>
<span id="cb33-652"><a href="#cb33-652"></a>    <span class="co"># orgao = str_remove_all(orgao, "^c\\(|\\\"|\\)" ),</span></span>
<span id="cb33-653"><a href="#cb33-653"></a>    <span class="co"># orgao = str_replace_all(orgao, ", ", ",\n"),</span></span>
<span id="cb33-654"><a href="#cb33-654"></a>    <span class="at">orgao =</span> <span class="st">"menores"</span>,</span>
<span id="cb33-655"><a href="#cb33-655"></a>    <span class="at">per =</span> <span class="fu">map</span>(data, select, per),</span>
<span id="cb33-656"><a href="#cb33-656"></a>    <span class="at">per =</span> <span class="fu">map_dbl</span>(per, sum),</span>
<span id="cb33-657"><a href="#cb33-657"></a>    <span class="at">qtd_orgaos =</span> <span class="fu">map_int</span>(data, nrow)</span>
<span id="cb33-658"><a href="#cb33-658"></a>  ) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>data) </span>
<span id="cb33-659"><a href="#cb33-659"></a></span>
<span id="cb33-660"><a href="#cb33-660"></a>top_opacos2 <span class="ot">&lt;-</span> top_opacos <span class="sc">%&gt;%</span> </span>
<span id="cb33-661"><a href="#cb33-661"></a>  <span class="fu">filter</span>(per <span class="sc">&gt;</span> .<span class="dv">05</span> <span class="sc">|</span> ano <span class="sc">&lt;</span> <span class="dv">2017</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb33-662"><a href="#cb33-662"></a>  <span class="fu">mutate</span>(<span class="at">qtd_orgaos =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb33-663"><a href="#cb33-663"></a>  <span class="fu">bind_rows</span>(top_opacos_pqn)</span>
<span id="cb33-664"><a href="#cb33-664"></a></span>
<span id="cb33-665"><a href="#cb33-665"></a><span class="co">#' paleta de cores</span></span>
<span id="cb33-666"><a href="#cb33-666"></a>pal <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb33-667"><a href="#cb33-667"></a>  cores_tb[[<span class="st">"laranja"</span>]],</span>
<span id="cb33-668"><a href="#cb33-668"></a>  <span class="st">"#0c93a8"</span>,</span>
<span id="cb33-669"><a href="#cb33-669"></a>  cores_tb[[<span class="st">"azul"</span>]],</span>
<span id="cb33-670"><a href="#cb33-670"></a>  cores_aep[[<span class="st">"marrom"</span>]],</span>
<span id="cb33-671"><a href="#cb33-671"></a>  cores_aep[[<span class="st">"cinza"</span>]],</span>
<span id="cb33-672"><a href="#cb33-672"></a>  cores_aep[[<span class="st">"laranja"</span>]],</span>
<span id="cb33-673"><a href="#cb33-673"></a>  <span class="st">"ivory"</span>,</span>
<span id="cb33-674"><a href="#cb33-674"></a>  cores_aep[[<span class="st">"rosa"</span>]]</span>
<span id="cb33-675"><a href="#cb33-675"></a>)</span>
<span id="cb33-676"><a href="#cb33-676"></a></span>
<span id="cb33-677"><a href="#cb33-677"></a><span class="co">#' paleta de cores associada aos órgãos</span></span>
<span id="cb33-678"><a href="#cb33-678"></a>cores <span class="ot">&lt;-</span> top_opacos2 <span class="sc">%&gt;%</span></span>
<span id="cb33-679"><a href="#cb33-679"></a>  <span class="fu">select</span>(orgao, per) <span class="sc">%&gt;%</span></span>
<span id="cb33-680"><a href="#cb33-680"></a>  <span class="fu">group_by</span>(orgao) <span class="sc">%&gt;%</span></span>
<span id="cb33-681"><a href="#cb33-681"></a>  <span class="fu">summarise</span>(<span class="at">per =</span> <span class="fu">sum</span>(per), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-682"><a href="#cb33-682"></a>  <span class="fu">arrange</span>(per) <span class="sc">%&gt;%</span></span>
<span id="cb33-683"><a href="#cb33-683"></a>  <span class="fu">mutate</span>(<span class="at">cor =</span> <span class="fu">colorRampPalette</span>(pal)(<span class="dv">13</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb33-684"><a href="#cb33-684"></a>  <span class="fu">select</span>(<span class="sc">-</span>per) <span class="sc">%&gt;%</span></span>
<span id="cb33-685"><a href="#cb33-685"></a>  <span class="fu">deframe</span>()</span>
<span id="cb33-686"><a href="#cb33-686"></a></span>
<span id="cb33-687"><a href="#cb33-687"></a>top_opacos2 <span class="sc">%&gt;%</span></span>
<span id="cb33-688"><a href="#cb33-688"></a>  <span class="fu">mutate</span>(<span class="at">sigla =</span> <span class="fu">if_else</span>(orgao <span class="sc">!=</span> <span class="st">"menores"</span>, </span>
<span id="cb33-689"><a href="#cb33-689"></a>                         <span class="fu">glue</span>(<span class="st">"{sigla}</span><span class="sc">\n</span><span class="st"> {my_lbl(per)}"</span>),</span>
<span id="cb33-690"><a href="#cb33-690"></a>                         <span class="fu">glue</span>(<span class="st">"(&lt; 5%)</span><span class="sc">\n</span><span class="st">{sigla}</span><span class="sc">\n</span><span class="st">soma: {my_lbl(per)}"</span>)</span>
<span id="cb33-691"><a href="#cb33-691"></a>                         )) <span class="sc">%&gt;%</span> </span>
<span id="cb33-692"><a href="#cb33-692"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ano, <span class="at">y =</span> per, <span class="at">fill =</span> <span class="fu">fct_reorder2</span>(orgao, <span class="sc">-</span>per, <span class="sc">-</span>ano))) <span class="sc">+</span></span>
<span id="cb33-693"><a href="#cb33-693"></a>  <span class="fu">geom_col</span>(<span class="at">color =</span> <span class="st">"gray60"</span>) <span class="sc">+</span> </span>
<span id="cb33-694"><a href="#cb33-694"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> sigla), </span>
<span id="cb33-695"><a href="#cb33-695"></a>            <span class="at">size =</span> <span class="fl">2.7</span>, <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> .<span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb33-696"><a href="#cb33-696"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb33-697"><a href="#cb33-697"></a>  <span class="fu">labs</span>(</span>
<span id="cb33-698"><a href="#cb33-698"></a>    <span class="at">fill =</span> <span class="st">"Sigla do órgão"</span>,</span>
<span id="cb33-699"><a href="#cb33-699"></a>    <span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span></span>
<span id="cb33-700"><a href="#cb33-700"></a>  ) <span class="sc">+</span></span>
<span id="cb33-701"><a href="#cb33-701"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">2012</span><span class="sc">:</span><span class="dv">2022</span>) <span class="sc">+</span></span>
<span id="cb33-702"><a href="#cb33-702"></a>  <span class="co">#scale_fill_ordinal() +</span></span>
<span id="cb33-703"><a href="#cb33-703"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> cores) <span class="sc">+</span></span>
<span id="cb33-704"><a href="#cb33-704"></a>  hrbrthemes<span class="sc">::</span><span class="fu">scale_y_percent</span>() <span class="sc">+</span></span>
<span id="cb33-705"><a href="#cb33-705"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">title.position =</span> <span class="st">"top"</span>, <span class="at">reverse =</span> T)) <span class="sc">+</span></span>
<span id="cb33-706"><a href="#cb33-706"></a>  <span class="fu">theme</span>(</span>
<span id="cb33-707"><a href="#cb33-707"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb33-708"><a href="#cb33-708"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">0</span>, <span class="st">"pt"</span>))</span>
<span id="cb33-709"><a href="#cb33-709"></a>  )</span>
<span id="cb33-710"><a href="#cb33-710"></a><span class="in">```</span></span>
<span id="cb33-711"><a href="#cb33-711"></a></span>
<span id="cb33-712"><a href="#cb33-712"></a><span class="kw">&lt;/br&gt;&lt;/br&gt;</span></span>
<span id="cb33-713"><a href="#cb33-713"></a></span>
<span id="cb33-714"><a href="#cb33-714"></a><span class="fu">### Mediana da taxa interna de acessos negados por órgão (2012-2022)</span></span>
<span id="cb33-715"><a href="#cb33-715"></a></span>
<span id="cb33-716"><a href="#cb33-716"></a><span class="in">```{r plot-mediana-acessos-negados-interno}</span></span>
<span id="cb33-717"><a href="#cb33-717"></a>taxas <span class="sc">%&gt;%</span> </span>
<span id="cb33-718"><a href="#cb33-718"></a>  <span class="co">#filter(decisao == "Acesso Negado") %&gt;% </span></span>
<span id="cb33-719"><a href="#cb33-719"></a>  <span class="fu">mutate</span>(</span>
<span id="cb33-720"><a href="#cb33-720"></a>    <span class="at">taxa_decisao_interna =</span> n_ano_decisao_orgao <span class="sc">/</span> n_ano_orgao,</span>
<span id="cb33-721"><a href="#cb33-721"></a>    <span class="at">taxa_decisao_relativa =</span> n_ano_decisao_orgao <span class="sc">/</span> n_ano_decisao</span>
<span id="cb33-722"><a href="#cb33-722"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb33-723"><a href="#cb33-723"></a>  <span class="fu">group_by</span>(ano, decisao) <span class="sc">%&gt;%</span></span>
<span id="cb33-724"><a href="#cb33-724"></a>  <span class="fu">summarise</span>(<span class="at">taxa_decisao_mediana =</span> <span class="fu">median</span>(taxa_decisao_interna)) <span class="sc">%&gt;%</span></span>
<span id="cb33-725"><a href="#cb33-725"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb33-726"><a href="#cb33-726"></a>  <span class="fu">filter</span>(decisao <span class="sc">==</span> <span class="st">"Acesso Negado"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb33-727"><a href="#cb33-727"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ano, <span class="at">y =</span> taxa_decisao_mediana)) <span class="sc">+</span></span>
<span id="cb33-728"><a href="#cb33-728"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"gray60"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb33-729"><a href="#cb33-729"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> cores_aep[[<span class="st">"rosa"</span>]], <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb33-730"><a href="#cb33-730"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">my_lbl</span>(taxa_decisao_mediana)), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">color =</span> cores_aep[[<span class="st">'rosa'</span>]]) <span class="sc">+</span></span>
<span id="cb33-731"><a href="#cb33-731"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">2012</span><span class="sc">:</span><span class="dv">2022</span>) <span class="sc">+</span></span>
<span id="cb33-732"><a href="#cb33-732"></a>  <span class="fu">scale_y_percent</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb33-733"><a href="#cb33-733"></a>  <span class="fu">labs</span>(</span>
<span id="cb33-734"><a href="#cb33-734"></a>    <span class="at">y =</span> <span class="st">"Acessos negados por órgão - mediana anual</span><span class="sc">\n</span><span class="st">como % do total de pedidos de um órgão"</span>,</span>
<span id="cb33-735"><a href="#cb33-735"></a>    <span class="at">x =</span> <span class="cn">NULL</span></span>
<span id="cb33-736"><a href="#cb33-736"></a>  )</span>
<span id="cb33-737"><a href="#cb33-737"></a><span class="in">```</span></span>
<span id="cb33-738"><a href="#cb33-738"></a></span>
<span id="cb33-739"><a href="#cb33-739"></a><span class="kw">&lt;/br&gt;&lt;/br&gt;</span></span>
<span id="cb33-740"><a href="#cb33-740"></a></span>
<span id="cb33-741"><a href="#cb33-741"></a><span class="fu">### Distribuição das taxas internas de acessos negados por órgão</span></span>
<span id="cb33-742"><a href="#cb33-742"></a></span>
<span id="cb33-743"><a href="#cb33-743"></a><span class="in">```{r plot-distribuicao-acessos-negados, fig.height=6}</span></span>
<span id="cb33-744"><a href="#cb33-744"></a>taxas <span class="sc">%&gt;%</span> </span>
<span id="cb33-745"><a href="#cb33-745"></a>  <span class="fu">filter</span>(decisao <span class="sc">==</span> <span class="st">"Acesso Negado"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb33-746"><a href="#cb33-746"></a>  <span class="fu">mutate</span>(</span>
<span id="cb33-747"><a href="#cb33-747"></a>    <span class="at">taxa_decisao_interna =</span> n_ano_decisao_orgao <span class="sc">/</span> n_ano_orgao,</span>
<span id="cb33-748"><a href="#cb33-748"></a>    <span class="at">taxa_decisao_relativa =</span> n_ano_decisao_orgao <span class="sc">/</span> n_ano_decisao</span>
<span id="cb33-749"><a href="#cb33-749"></a>  ) <span class="sc">%&gt;%</span> <span class="co">#glimpse() </span></span>
<span id="cb33-750"><a href="#cb33-750"></a>  <span class="fu">group_by</span>(ano, decisao) <span class="sc">%&gt;%</span> </span>
<span id="cb33-751"><a href="#cb33-751"></a>  <span class="fu">mutate</span>(<span class="at">taxa_decisao_mediana =</span> <span class="fu">median</span>(taxa_decisao_interna)) <span class="sc">%&gt;%</span> </span>
<span id="cb33-752"><a href="#cb33-752"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb33-753"><a href="#cb33-753"></a>  <span class="fu">select</span>(ano, decisao, orgao, <span class="fu">contains</span>(<span class="st">"taxa"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb33-754"><a href="#cb33-754"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb33-755"><a href="#cb33-755"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ano, </span>
<span id="cb33-756"><a href="#cb33-756"></a>             <span class="at">y =</span> taxa_decisao_interna,</span>
<span id="cb33-757"><a href="#cb33-757"></a>             <span class="at">color =</span> decisao)) <span class="sc">+</span></span>
<span id="cb33-758"><a href="#cb33-758"></a>  ggbeeswarm<span class="sc">::</span><span class="fu">geom_quasirandom</span>(<span class="at">alpha =</span> .<span class="dv">6</span>, <span class="at">show.legend =</span> F) <span class="sc">+</span></span>
<span id="cb33-759"><a href="#cb33-759"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb33-760"><a href="#cb33-760"></a>    <span class="fu">aes</span>(</span>
<span id="cb33-761"><a href="#cb33-761"></a>      <span class="at">x =</span> ano,</span>
<span id="cb33-762"><a href="#cb33-762"></a>      <span class="at">y =</span> taxa_decisao_mediana,</span>
<span id="cb33-763"><a href="#cb33-763"></a>      ),</span>
<span id="cb33-764"><a href="#cb33-764"></a>    <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb33-765"><a href="#cb33-765"></a>    <span class="at">inherit.aes =</span> F,</span>
<span id="cb33-766"><a href="#cb33-766"></a>    <span class="at">shape =</span> <span class="dv">45</span>,</span>
<span id="cb33-767"><a href="#cb33-767"></a>    <span class="at">size =</span> <span class="dv">15</span></span>
<span id="cb33-768"><a href="#cb33-768"></a>  ) <span class="sc">+</span></span>
<span id="cb33-769"><a href="#cb33-769"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb33-770"><a href="#cb33-770"></a>    <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">str_extract</span>(orgao, <span class="st">"^[:upper:]+(?= )|^GSI-PR|^CEITEC</span><span class="sc">\\</span><span class="st">/S</span><span class="sc">\\</span><span class="st">.A</span><span class="sc">\\</span><span class="st">."</span>)),</span>
<span id="cb33-771"><a href="#cb33-771"></a>    <span class="at">data =</span> . <span class="sc">%&gt;%</span> <span class="fu">filter</span>(taxa_decisao_interna <span class="sc">&gt;=</span> .<span class="dv">3</span>),</span>
<span id="cb33-772"><a href="#cb33-772"></a>    <span class="at">size =</span> <span class="fl">2.7</span>,</span>
<span id="cb33-773"><a href="#cb33-773"></a>    <span class="at">angle =</span> <span class="dv">45</span>,</span>
<span id="cb33-774"><a href="#cb33-774"></a>    <span class="at">hjust =</span> <span class="dv">0</span></span>
<span id="cb33-775"><a href="#cb33-775"></a>  ) <span class="sc">+</span></span>
<span id="cb33-776"><a href="#cb33-776"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> cores_decisao, <span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb33-777"><a href="#cb33-777"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> decisao, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb33-778"><a href="#cb33-778"></a>  <span class="fu">scale_y_percent</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb33-779"><a href="#cb33-779"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">2012</span><span class="sc">:</span><span class="dv">2021</span>) <span class="sc">+</span></span>
<span id="cb33-780"><a href="#cb33-780"></a>  <span class="fu">theme</span>(<span class="at">strip.text =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb33-781"><a href="#cb33-781"></a>  <span class="fu">labs</span>(</span>
<span id="cb33-782"><a href="#cb33-782"></a>    <span class="at">subtitle =</span> <span class="st">"Cada ponto representa um órgão - média anual"</span>,</span>
<span id="cb33-783"><a href="#cb33-783"></a>    <span class="at">y =</span> <span class="st">"Acessos negados por órgão</span><span class="sc">\n</span><span class="st">como % do total de pedidos de um órgão"</span>,</span>
<span id="cb33-784"><a href="#cb33-784"></a>    <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb33-785"><a href="#cb33-785"></a>    <span class="at">color =</span> <span class="cn">NULL</span></span>
<span id="cb33-786"><a href="#cb33-786"></a>  )</span>
<span id="cb33-787"><a href="#cb33-787"></a><span class="in">```</span></span>
<span id="cb33-788"><a href="#cb33-788"></a></span>
<span id="cb33-789"><a href="#cb33-789"></a><span class="kw">&lt;/br&gt;&lt;/br&gt;</span></span>
<span id="cb33-790"><a href="#cb33-790"></a></span>
<span id="cb33-791"><a href="#cb33-791"></a><span class="fu">## Tempo de resposta dos pedidos</span></span>
<span id="cb33-792"><a href="#cb33-792"></a></span>
<span id="cb33-793"><a href="#cb33-793"></a><span class="in">```{r data-tempo-resposta}</span></span>
<span id="cb33-794"><a href="#cb33-794"></a>cores <span class="ot">&lt;-</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(</span>
<span id="cb33-795"><a href="#cb33-795"></a>  cores_aep[[<span class="st">"marrom"</span>]],</span>
<span id="cb33-796"><a href="#cb33-796"></a>  cores_aep[[<span class="st">"rosa"</span>]],</span>
<span id="cb33-797"><a href="#cb33-797"></a>  cores_aep[[<span class="st">"laranja"</span>]],</span>
<span id="cb33-798"><a href="#cb33-798"></a>  cores_tb[[<span class="st">"laranja"</span>]],</span>
<span id="cb33-799"><a href="#cb33-799"></a>  cores_tb[[<span class="st">"azul"</span>]]</span>
<span id="cb33-800"><a href="#cb33-800"></a>  ))(<span class="dv">8</span>)</span>
<span id="cb33-801"><a href="#cb33-801"></a></span>
<span id="cb33-802"><a href="#cb33-802"></a>pedidos_prazo <span class="ot">&lt;-</span> pedidos_cgu <span class="sc">%&gt;%</span> </span>
<span id="cb33-803"><a href="#cb33-803"></a>  <span class="fu">filter</span>(</span>
<span id="cb33-804"><a href="#cb33-804"></a>    decisao <span class="sc">%notin%</span> <span class="fu">c</span>(</span>
<span id="cb33-805"><a href="#cb33-805"></a>      <span class="st">"Pergunta Duplicada/Repetida"</span>,</span>
<span id="cb33-806"><a href="#cb33-806"></a>      <span class="st">"Não se trata de solicitação de informação"</span> </span>
<span id="cb33-807"><a href="#cb33-807"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb33-808"><a href="#cb33-808"></a>  <span class="fu">transmute</span>(</span>
<span id="cb33-809"><a href="#cb33-809"></a>    id_pedido, </span>
<span id="cb33-810"><a href="#cb33-810"></a>    orgao,</span>
<span id="cb33-811"><a href="#cb33-811"></a>    data_pedido,</span>
<span id="cb33-812"><a href="#cb33-812"></a>    data_resposta,</span>
<span id="cb33-813"><a href="#cb33-813"></a>    prazo,</span>
<span id="cb33-814"><a href="#cb33-814"></a>    <span class="at">dias_corridos =</span> data_resposta <span class="sc">-</span> data_pedido,</span>
<span id="cb33-815"><a href="#cb33-815"></a>    <span class="at">dias_corridos_fx =</span> <span class="fu">case_when</span>(</span>
<span id="cb33-816"><a href="#cb33-816"></a>      dias_corridos <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span>  <span class="st">" 0 dias corridos"</span>,</span>
<span id="cb33-817"><a href="#cb33-817"></a>      dias_corridos <span class="sc">&lt;=</span> <span class="dv">5</span> <span class="sc">~</span>  <span class="st">" 1 até 5 dias"</span>,</span>
<span id="cb33-818"><a href="#cb33-818"></a>      dias_corridos <span class="sc">&lt;=</span> <span class="dv">10</span> <span class="sc">~</span> <span class="st">" 6 até 10 dias"</span>,</span>
<span id="cb33-819"><a href="#cb33-819"></a>      dias_corridos <span class="sc">&lt;=</span> <span class="dv">15</span> <span class="sc">~</span> <span class="st">"11 até 15 dias"</span>,</span>
<span id="cb33-820"><a href="#cb33-820"></a>      dias_corridos <span class="sc">&lt;=</span> <span class="dv">20</span> <span class="sc">~</span> <span class="st">"16 até 20 dias"</span>,</span>
<span id="cb33-821"><a href="#cb33-821"></a>      dias_corridos <span class="sc">&lt;=</span> <span class="dv">25</span> <span class="sc">~</span> <span class="st">"21 até 25 dias"</span>,</span>
<span id="cb33-822"><a href="#cb33-822"></a>      dias_corridos <span class="sc">&lt;=</span> <span class="dv">30</span> <span class="sc">~</span> <span class="st">"26 até 30 dias"</span>,</span>
<span id="cb33-823"><a href="#cb33-823"></a>      <span class="cn">TRUE</span> <span class="sc">~</span>  <span class="st">"Acima de 30 dias"</span></span>
<span id="cb33-824"><a href="#cb33-824"></a>    ),</span>
<span id="cb33-825"><a href="#cb33-825"></a>    <span class="at">dias_corridos_fx =</span> <span class="fu">ordered</span>(dias_corridos_fx, <span class="at">levels =</span> <span class="fu">c</span>(</span>
<span id="cb33-826"><a href="#cb33-826"></a>      <span class="st">" 0 dias corridos"</span>,</span>
<span id="cb33-827"><a href="#cb33-827"></a>      <span class="st">" 1 até 5 dias"</span>,</span>
<span id="cb33-828"><a href="#cb33-828"></a>      <span class="st">" 6 até 10 dias"</span>,</span>
<span id="cb33-829"><a href="#cb33-829"></a>      <span class="st">"11 até 15 dias"</span>,</span>
<span id="cb33-830"><a href="#cb33-830"></a>      <span class="st">"16 até 20 dias"</span>,</span>
<span id="cb33-831"><a href="#cb33-831"></a>      <span class="st">"21 até 25 dias"</span>,</span>
<span id="cb33-832"><a href="#cb33-832"></a>      <span class="st">"26 até 30 dias"</span>,</span>
<span id="cb33-833"><a href="#cb33-833"></a>      <span class="st">"Acima de 30 dias"</span></span>
<span id="cb33-834"><a href="#cb33-834"></a>    ))</span>
<span id="cb33-835"><a href="#cb33-835"></a>  )</span>
<span id="cb33-836"><a href="#cb33-836"></a><span class="in">```</span></span>
<span id="cb33-837"><a href="#cb33-837"></a></span>
<span id="cb33-838"><a href="#cb33-838"></a><span class="kw">&lt;/br&gt;&lt;/br&gt;</span></span>
<span id="cb33-839"><a href="#cb33-839"></a></span>
<span id="cb33-840"><a href="#cb33-840"></a><span class="fu">### Frequência de dias corridos para resposta à LAI (2012-2022)</span></span>
<span id="cb33-841"><a href="#cb33-841"></a></span>
<span id="cb33-842"><a href="#cb33-842"></a><span class="in">```{r plot-frequencia-dias-corridos, fig.height=10, fig.width=6}</span></span>
<span id="cb33-843"><a href="#cb33-843"></a>pedidos_prazo <span class="sc">%&gt;%</span> </span>
<span id="cb33-844"><a href="#cb33-844"></a>  <span class="fu">count</span>(<span class="at">name =</span> <span class="st">'n_pedidos_ano_prazo'</span>, dias_corridos_fx, <span class="at">ano =</span> <span class="fu">year</span>(data_pedido), <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-845"><a href="#cb33-845"></a>  <span class="fu">add_count</span>(<span class="at">name =</span> <span class="st">'n_pedidos_ano'</span>, ano, <span class="at">wt =</span> n_pedidos_ano_prazo) <span class="sc">%&gt;%</span> </span>
<span id="cb33-846"><a href="#cb33-846"></a>  <span class="fu">mutate</span>(<span class="at">per =</span> n_pedidos_ano_prazo <span class="sc">/</span> n_pedidos_ano) <span class="sc">%&gt;%</span> </span>
<span id="cb33-847"><a href="#cb33-847"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(ano, <span class="sc">-</span>ano), <span class="at">y =</span> per, <span class="at">fill =</span> dias_corridos_fx, <span class="at">group =</span> dias_corridos_fx)) <span class="sc">+</span></span>
<span id="cb33-848"><a href="#cb33-848"></a>  <span class="fu">geom_col</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>, <span class="at">width =</span> .<span class="dv">7</span>,</span>
<span id="cb33-849"><a href="#cb33-849"></a>           <span class="at">position =</span> <span class="fu">position_dodge</span>(.<span class="dv">7</span>)) <span class="sc">+</span></span>
<span id="cb33-850"><a href="#cb33-850"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb33-851"><a href="#cb33-851"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">my_lbl</span>(per)), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">size =</span> <span class="fl">2.5</span>) <span class="sc">+</span></span>
<span id="cb33-852"><a href="#cb33-852"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> cores) <span class="sc">+</span></span>
<span id="cb33-853"><a href="#cb33-853"></a>  <span class="fu">scale_y_percent</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">36</span>), <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">15</span>, .<span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb33-854"><a href="#cb33-854"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> dias_corridos_fx, <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">scales =</span> <span class="st">"free_x"</span>) <span class="sc">+</span></span>
<span id="cb33-855"><a href="#cb33-855"></a>  <span class="fu">labs</span>(</span>
<span id="cb33-856"><a href="#cb33-856"></a>    <span class="at">fill =</span> <span class="st">"Dias corridos"</span>,</span>
<span id="cb33-857"><a href="#cb33-857"></a>    <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb33-858"><a href="#cb33-858"></a>    <span class="at">y =</span> <span class="st">"% de pedidos atendidos no prazo de referência"</span></span>
<span id="cb33-859"><a href="#cb33-859"></a>  ) <span class="sc">+</span></span>
<span id="cb33-860"><a href="#cb33-860"></a>  <span class="fu">theme</span>(</span>
<span id="cb33-861"><a href="#cb33-861"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="dv">0</span>)</span>
<span id="cb33-862"><a href="#cb33-862"></a>  )</span>
<span id="cb33-863"><a href="#cb33-863"></a><span class="in">```</span></span>
<span id="cb33-864"><a href="#cb33-864"></a></span>
<span id="cb33-865"><a href="#cb33-865"></a><span class="kw">&lt;/br&gt;&lt;/br&gt;</span></span>
<span id="cb33-866"><a href="#cb33-866"></a></span>
<span id="cb33-867"><a href="#cb33-867"></a><span class="fu">### Tempo médio de resposta por ano</span></span>
<span id="cb33-868"><a href="#cb33-868"></a></span>
<span id="cb33-869"><a href="#cb33-869"></a><span class="in">```{r plot-tempo-medio-de-resposta}</span></span>
<span id="cb33-870"><a href="#cb33-870"></a>my_lbl_days <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">str_glue</span>(<span class="st">"{round(x)} dias"</span>)</span>
<span id="cb33-871"><a href="#cb33-871"></a></span>
<span id="cb33-872"><a href="#cb33-872"></a>pedidos_prazo <span class="sc">%&gt;%</span> </span>
<span id="cb33-873"><a href="#cb33-873"></a>  <span class="fu">group_by</span>(<span class="at">ano =</span> <span class="fu">year</span>(data_pedido)) <span class="sc">%&gt;%</span> </span>
<span id="cb33-874"><a href="#cb33-874"></a>  <span class="fu">summarise</span>(<span class="at">media_dias_corridos_por_ano =</span> <span class="fu">mean</span>(dias_corridos), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb33-875"><a href="#cb33-875"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ano, <span class="at">y =</span> media_dias_corridos_por_ano)) <span class="sc">+</span></span>
<span id="cb33-876"><a href="#cb33-876"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> cores_tb[[<span class="st">"azul"</span>]]) <span class="sc">+</span></span>
<span id="cb33-877"><a href="#cb33-877"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">my_lbl_days</span>(media_dias_corridos_por_ano)), <span class="at">vjust =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb33-878"><a href="#cb33-878"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">2012</span><span class="sc">:</span><span class="dv">2022</span>) <span class="sc">+</span></span>
<span id="cb33-879"><a href="#cb33-879"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">25</span>, <span class="dv">5</span>), <span class="at">labels =</span> <span class="fu">str_glue</span>(<span class="st">"{seq(0, 25, 5)} dias"</span>),</span>
<span id="cb33-880"><a href="#cb33-880"></a>                     <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">24</span>)) <span class="sc">+</span></span>
<span id="cb33-881"><a href="#cb33-881"></a>  <span class="fu">labs</span>(</span>
<span id="cb33-882"><a href="#cb33-882"></a>    <span class="at">x =</span> <span class="st">"Ano de registro do pedido"</span>,</span>
<span id="cb33-883"><a href="#cb33-883"></a>    <span class="at">y =</span> <span class="st">"Média de dias corridos para resposta do pedido"</span></span>
<span id="cb33-884"><a href="#cb33-884"></a>  )</span>
<span id="cb33-885"><a href="#cb33-885"></a><span class="in">```</span></span>
<span id="cb33-886"><a href="#cb33-886"></a></span>
<span id="cb33-887"><a href="#cb33-887"></a><span class="kw">&lt;/br&gt;&lt;/br&gt;</span></span>
<span id="cb33-888"><a href="#cb33-888"></a></span>
<span id="cb33-889"><a href="#cb33-889"></a><span class="fu">## Recursos</span></span>
<span id="cb33-890"><a href="#cb33-890"></a></span>
<span id="cb33-891"><a href="#cb33-891"></a><span class="in">```{r data-pedidos-e-recursos}</span></span>
<span id="cb33-892"><a href="#cb33-892"></a>pedidos_e_recursos <span class="ot">&lt;-</span> recursos_cgu <span class="sc">%&gt;%</span></span>
<span id="cb33-893"><a href="#cb33-893"></a>  <span class="fu">arrange</span>(<span class="fu">as.integer</span>(id_pedido), instancia) <span class="sc">%&gt;%</span> </span>
<span id="cb33-894"><a href="#cb33-894"></a>  <span class="fu">group_by</span>(id_pedido) <span class="sc">%&gt;%</span> </span>
<span id="cb33-895"><a href="#cb33-895"></a>  <span class="fu">filter</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="fu">max</span>(<span class="fu">row_number</span>())) <span class="sc">%&gt;%</span> </span>
<span id="cb33-896"><a href="#cb33-896"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb33-897"><a href="#cb33-897"></a>  <span class="fu">right_join</span>(pedidos_cgu) <span class="sc">%&gt;%</span> </span>
<span id="cb33-898"><a href="#cb33-898"></a>  <span class="fu">arrange</span>(<span class="fu">as.integer</span>(id_pedido)) <span class="sc">%&gt;%</span> </span>
<span id="cb33-899"><a href="#cb33-899"></a>  <span class="fu">transmute</span>(id_recurso, id_pedido, </span>
<span id="cb33-900"><a href="#cb33-900"></a>            <span class="at">ano_pedido =</span> <span class="fu">year</span>(mes_pedido),</span>
<span id="cb33-901"><a href="#cb33-901"></a>            orgao,</span>
<span id="cb33-902"><a href="#cb33-902"></a>            <span class="at">entrou_com_recurso =</span> <span class="sc">!</span><span class="fu">is.na</span>(id_recurso),</span>
<span id="cb33-903"><a href="#cb33-903"></a>            tipo_recurso,</span>
<span id="cb33-904"><a href="#cb33-904"></a>            tipo_resposta,</span>
<span id="cb33-905"><a href="#cb33-905"></a>            decisao</span>
<span id="cb33-906"><a href="#cb33-906"></a>            )</span>
<span id="cb33-907"><a href="#cb33-907"></a><span class="in">```</span></span>
<span id="cb33-908"><a href="#cb33-908"></a></span>
<span id="cb33-909"><a href="#cb33-909"></a><span class="kw">&lt;/br&gt;&lt;/br&gt;</span></span>
<span id="cb33-910"><a href="#cb33-910"></a></span>
<span id="cb33-911"><a href="#cb33-911"></a><span class="fu">### % de pedidos que entraram ou não com recurso</span></span>
<span id="cb33-912"><a href="#cb33-912"></a></span>
<span id="cb33-913"><a href="#cb33-913"></a><span class="in">```{r plot-perc-pedidos-com-e-sem-recurso}</span></span>
<span id="cb33-914"><a href="#cb33-914"></a>pedidos_e_recursos <span class="sc">%&gt;%</span> </span>
<span id="cb33-915"><a href="#cb33-915"></a>  <span class="fu">count</span>(ano_pedido, entrou_com_recurso, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-916"><a href="#cb33-916"></a>  <span class="fu">add_count</span>(<span class="at">name =</span> <span class="st">"total"</span>, ano_pedido, <span class="at">wt =</span> n) <span class="sc">%&gt;%</span> </span>
<span id="cb33-917"><a href="#cb33-917"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ano_pedido, <span class="at">y =</span> n <span class="sc">/</span> total, <span class="at">fill =</span> <span class="fu">reorder</span>(entrou_com_recurso, n))) <span class="sc">+</span></span>
<span id="cb33-918"><a href="#cb33-918"></a>  ggchicklet<span class="sc">::</span><span class="fu">geom_chicklet</span>(<span class="at">alpha =</span> .<span class="dv">9</span>) <span class="sc">+</span></span>
<span id="cb33-919"><a href="#cb33-919"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> . <span class="sc">%&gt;%</span> <span class="fu">filter</span>(entrou_com_recurso), <span class="at">size =</span> <span class="fl">3.3</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>, <span class="at">vjust =</span> <span class="dv">1</span>,</span>
<span id="cb33-920"><a href="#cb33-920"></a>            <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">my_lbl</span>(n <span class="sc">/</span> total)), <span class="at">color =</span> cores_tb[[<span class="st">"cinza_quase_branco"</span>]]) <span class="sc">+</span></span>
<span id="cb33-921"><a href="#cb33-921"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(cores_aep[[<span class="st">"rosa"</span>]], cores_tb[[<span class="st">"azul"</span>]]), </span>
<span id="cb33-922"><a href="#cb33-922"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Houve recurso"</span>, <span class="st">"Não houve recurso"</span>), <span class="at">name =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb33-923"><a href="#cb33-923"></a>  <span class="fu">scale_y_percent</span>(<span class="at">name =</span> <span class="st">"% de pedidos de acesso a informação"</span>, <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb33-924"><a href="#cb33-924"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">2012</span><span class="sc">:</span><span class="dv">2022</span>), <span class="at">name =</span> <span class="cn">NULL</span>)</span>
<span id="cb33-925"><a href="#cb33-925"></a><span class="in">```</span></span>
<span id="cb33-926"><a href="#cb33-926"></a></span>
<span id="cb33-927"><a href="#cb33-927"></a><span class="kw">&lt;/br&gt;&lt;/br&gt;</span></span>
<span id="cb33-928"><a href="#cb33-928"></a></span>
<span id="cb33-929"><a href="#cb33-929"></a><span class="fu">### Total de pedidos que entraram com recurso</span></span>
<span id="cb33-930"><a href="#cb33-930"></a></span>
<span id="cb33-931"><a href="#cb33-931"></a><span class="in">```{r plot-total-recursos-ano}</span></span>
<span id="cb33-932"><a href="#cb33-932"></a>pedidos_e_recursos <span class="sc">%&gt;%</span></span>
<span id="cb33-933"><a href="#cb33-933"></a>  <span class="fu">count</span>(ano_pedido, entrou_com_recurso, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-934"><a href="#cb33-934"></a>  <span class="fu">add_count</span>(<span class="at">name =</span> <span class="st">"total"</span>, ano_pedido, <span class="at">wt =</span> n) <span class="sc">%&gt;%</span> </span>
<span id="cb33-935"><a href="#cb33-935"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ano_pedido, <span class="at">y =</span> n, <span class="at">fill =</span> <span class="fu">reorder</span>(entrou_com_recurso, n))) <span class="sc">+</span></span>
<span id="cb33-936"><a href="#cb33-936"></a>  ggchicklet<span class="sc">::</span><span class="fu">geom_chicklet</span>() <span class="sc">+</span></span>
<span id="cb33-937"><a href="#cb33-937"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(cores_aep[[<span class="st">"rosa"</span>]], cores_tb[[<span class="st">"azul"</span>]]), </span>
<span id="cb33-938"><a href="#cb33-938"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Houve recurso"</span>, <span class="st">"Não houve recurso"</span>), <span class="at">name =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb33-939"><a href="#cb33-939"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">2012</span><span class="sc">:</span><span class="dv">2022</span>), <span class="at">name =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb33-940"><a href="#cb33-940"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_number</span>(), <span class="at">name =</span> <span class="st">"Quantidade de pedidos"</span>, <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb33-941"><a href="#cb33-941"></a><span class="in">```</span></span>
<span id="cb33-942"><a href="#cb33-942"></a></span>
<span id="cb33-943"><a href="#cb33-943"></a><span class="kw">&lt;/br&gt;&lt;/br&gt;</span></span>
<span id="cb33-944"><a href="#cb33-944"></a></span>
<span id="cb33-945"><a href="#cb33-945"></a><span class="fu">### Evolução do % de recursos impetrados por ano</span></span>
<span id="cb33-946"><a href="#cb33-946"></a></span>
<span id="cb33-947"><a href="#cb33-947"></a><span class="in">```{r plor-perc-recursos-ano}</span></span>
<span id="cb33-948"><a href="#cb33-948"></a>pedidos_e_recursos <span class="sc">%&gt;%</span> </span>
<span id="cb33-949"><a href="#cb33-949"></a>  <span class="fu">count</span>(ano_pedido, entrou_com_recurso, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-950"><a href="#cb33-950"></a>  <span class="fu">add_count</span>(<span class="at">name =</span> <span class="st">"total"</span>, ano_pedido, <span class="at">wt =</span> n) <span class="sc">%&gt;%</span></span>
<span id="cb33-951"><a href="#cb33-951"></a>  <span class="fu">filter</span>(entrou_com_recurso) <span class="sc">%&gt;%</span> </span>
<span id="cb33-952"><a href="#cb33-952"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ano_pedido, <span class="at">y =</span> n <span class="sc">/</span> total, <span class="at">group =</span> <span class="fu">reorder</span>(entrou_com_recurso, n))) <span class="sc">+</span></span>
<span id="cb33-953"><a href="#cb33-953"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb33-954"><a href="#cb33-954"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> cores_aep[[<span class="st">"rosa"</span>]], <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb33-955"><a href="#cb33-955"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">my_lbl</span>(n <span class="sc">/</span> total)), <span class="at">color =</span> cores_aep[[<span class="st">"rosa"</span>]], <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb33-956"><a href="#cb33-956"></a>  <span class="fu">scale_y_percent</span>(<span class="at">name =</span> <span class="st">"% de pedidos de acesso a informação"</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.11</span>)) <span class="sc">+</span></span>
<span id="cb33-957"><a href="#cb33-957"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">2012</span><span class="sc">:</span><span class="dv">2022</span>), <span class="at">name =</span> <span class="cn">NULL</span>)</span>
<span id="cb33-958"><a href="#cb33-958"></a><span class="in">```</span></span>
<span id="cb33-959"><a href="#cb33-959"></a></span>
<span id="cb33-960"><a href="#cb33-960"></a><span class="kw">&lt;/br&gt;&lt;/br&gt;</span></span>
<span id="cb33-961"><a href="#cb33-961"></a></span>
<span id="cb33-962"><a href="#cb33-962"></a><span class="fu">### Órgãos campeões de recursos impetrados (2012 - 2022, 15 primeiros)</span></span>
<span id="cb33-963"><a href="#cb33-963"></a></span>
<span id="cb33-964"><a href="#cb33-964"></a><span class="in">```{r plot-orgaos-campeoes-recursos, fig.height=10}</span></span>
<span id="cb33-965"><a href="#cb33-965"></a>pedidos_e_recursos <span class="sc">%&gt;%</span> </span>
<span id="cb33-966"><a href="#cb33-966"></a>  <span class="fu">filter</span>(entrou_com_recurso) <span class="sc">%&gt;%</span> </span>
<span id="cb33-967"><a href="#cb33-967"></a>  <span class="fu">count</span>(orgao, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb33-968"><a href="#cb33-968"></a>  <span class="fu">slice_max</span>(<span class="at">order_by =</span> n, <span class="at">n =</span> <span class="dv">15</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb33-969"><a href="#cb33-969"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> n, <span class="at">x =</span> <span class="fu">reorder</span>(orgao, <span class="sc">-</span>n))) <span class="sc">+</span></span>
<span id="cb33-970"><a href="#cb33-970"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb33-971"><a href="#cb33-971"></a>  ggchicklet<span class="sc">::</span><span class="fu">geom_chicklet</span>(<span class="at">fill =</span> cores_aep[[<span class="st">"laranja"</span>]]) <span class="sc">+</span></span>
<span id="cb33-972"><a href="#cb33-972"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> scales<span class="sc">::</span><span class="fu">number</span>(n, <span class="at">accuracy =</span> <span class="dv">1</span>)), <span class="at">check_overlap =</span> T,</span>
<span id="cb33-973"><a href="#cb33-973"></a>            <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span>  <span class="dv">3</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>) <span class="sc">+</span></span>
<span id="cb33-974"><a href="#cb33-974"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">name =</span> <span class="st">"Órgão"</span>, <span class="at">labels =</span> <span class="cn">NULL</span>) <span class="sc">+</span> </span>
<span id="cb33-975"><a href="#cb33-975"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">labels =</span> <span class="fu">number_format</span>(), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">8500</span>), </span>
<span id="cb33-976"><a href="#cb33-976"></a>                     <span class="at">name =</span> <span class="st">"Quantidade de recursos impetrados"</span>) <span class="sc">+</span></span>
<span id="cb33-977"><a href="#cb33-977"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> <span class="fu">reorder</span>(orgao, <span class="sc">-</span>n), <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb33-978"><a href="#cb33-978"></a>  <span class="fu">theme</span>(<span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">face =</span> <span class="st">"italic"</span>),</span>
<span id="cb33-979"><a href="#cb33-979"></a>        <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb33-980"><a href="#cb33-980"></a>        <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb33-981"><a href="#cb33-981"></a>        <span class="at">panel.grid.major.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb33-982"><a href="#cb33-982"></a>        <span class="at">panel.grid.minor.y =</span> <span class="fu">element_blank</span>())</span>
<span id="cb33-983"><a href="#cb33-983"></a><span class="in">```</span></span>
<span id="cb33-984"><a href="#cb33-984"></a></span>
<span id="cb33-985"><a href="#cb33-985"></a><span class="kw">&lt;/br&gt;&lt;/br&gt;</span></span>
<span id="cb33-986"><a href="#cb33-986"></a></span>
<span id="cb33-987"><a href="#cb33-987"></a><span class="in">```{r func-plot_tipo_reposta}</span></span>
<span id="cb33-988"><a href="#cb33-988"></a>cores_tipo_resposta2 <span class="ot">&lt;-</span> cores_tipo_resposta <span class="sc">%&gt;%</span> </span>
<span id="cb33-989"><a href="#cb33-989"></a>  <span class="fu">enframe</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb33-990"><a href="#cb33-990"></a>  <span class="fu">mutate</span>(</span>
<span id="cb33-991"><a href="#cb33-991"></a>    <span class="at">value =</span> <span class="fu">case_when</span>(</span>
<span id="cb33-992"><a href="#cb33-992"></a>      name <span class="sc">==</span> <span class="st">"Deferido"</span> <span class="sc">~</span> <span class="st">"cyan4"</span>,</span>
<span id="cb33-993"><a href="#cb33-993"></a>      name <span class="sc">==</span> <span class="st">"Parcialmente deferido"</span> <span class="sc">~</span> cores_tb[[<span class="st">"azul"</span>]],</span>
<span id="cb33-994"><a href="#cb33-994"></a>      name <span class="sc">==</span> <span class="st">"Perda de objeto parcial"</span> <span class="sc">~</span> cores_tb[[<span class="st">"cinza_escuro"</span>]],</span>
<span id="cb33-995"><a href="#cb33-995"></a>      name <span class="sc">==</span> <span class="st">"Perda de objeto"</span> <span class="sc">~</span> cores_aep[[<span class="st">"cinza"</span>]],</span>
<span id="cb33-996"><a href="#cb33-996"></a>      name <span class="sc">==</span> <span class="st">"Não conhecimento"</span> <span class="sc">~</span> cores_aep[[<span class="st">"laranja"</span>]],</span>
<span id="cb33-997"><a href="#cb33-997"></a>      name <span class="sc">==</span> <span class="st">"Acolhimento"</span> <span class="sc">~</span> cores_tb[[<span class="st">"cinza_quase_branco"</span>]],</span>
<span id="cb33-998"><a href="#cb33-998"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> value</span>
<span id="cb33-999"><a href="#cb33-999"></a>    )</span>
<span id="cb33-1000"><a href="#cb33-1000"></a>  ) <span class="sc">%&gt;%</span> <span class="fu">deframe</span>()</span>
<span id="cb33-1001"><a href="#cb33-1001"></a></span>
<span id="cb33-1002"><a href="#cb33-1002"></a>plot_tipo_resposta <span class="ot">&lt;-</span> <span class="cf">function</span>(df, instancia_recursal) {</span>
<span id="cb33-1003"><a href="#cb33-1003"></a>  </span>
<span id="cb33-1004"><a href="#cb33-1004"></a>  recursos_cgu <span class="sc">%&gt;%</span></span>
<span id="cb33-1005"><a href="#cb33-1005"></a>  <span class="fu">count</span>(<span class="at">ano_recurso =</span> <span class="fu">year</span>(data_recurso), instancia, tipo_resposta) <span class="sc">%&gt;%</span> </span>
<span id="cb33-1006"><a href="#cb33-1006"></a>  <span class="fu">filter</span>(instancia <span class="sc">==</span> instancia_recursal) <span class="sc">%&gt;%</span></span>
<span id="cb33-1007"><a href="#cb33-1007"></a>  <span class="fu">add_count</span>(ano_recurso, <span class="at">wt =</span> n) <span class="sc">%&gt;%</span> </span>
<span id="cb33-1008"><a href="#cb33-1008"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ano_recurso, <span class="at">y =</span> n <span class="sc">/</span> nn, <span class="at">color =</span> tipo_resposta)) <span class="sc">+</span></span>
<span id="cb33-1009"><a href="#cb33-1009"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb33-1010"><a href="#cb33-1010"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb33-1011"><a href="#cb33-1011"></a>  <span class="fu">scale_y_percent</span>() <span class="sc">+</span></span>
<span id="cb33-1012"><a href="#cb33-1012"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> cores_tipo_resposta2, <span class="at">name =</span> <span class="st">"Tipo de resposta:"</span>) <span class="sc">+</span></span>
<span id="cb33-1013"><a href="#cb33-1013"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">2012</span><span class="sc">:</span><span class="dv">2022</span>)</span>
<span id="cb33-1014"><a href="#cb33-1014"></a>  </span>
<span id="cb33-1015"><a href="#cb33-1015"></a>} </span>
<span id="cb33-1016"><a href="#cb33-1016"></a><span class="in">```</span></span>
<span id="cb33-1017"><a href="#cb33-1017"></a></span>
<span id="cb33-1018"><a href="#cb33-1018"></a><span class="fu">### Tipo de resposta dada aos recursos em primeira instância</span></span>
<span id="cb33-1019"><a href="#cb33-1019"></a></span>
<span id="cb33-1020"><a href="#cb33-1020"></a><span class="in">```{r plot-tipo-resposta-1a-instancia}</span></span>
<span id="cb33-1021"><a href="#cb33-1021"></a><span class="fu">plot_tipo_resposta</span>(recursos_cgu, <span class="st">"Primeira Instância"</span>)</span>
<span id="cb33-1022"><a href="#cb33-1022"></a><span class="in">```</span></span>
<span id="cb33-1023"><a href="#cb33-1023"></a></span>
<span id="cb33-1024"><a href="#cb33-1024"></a><span class="kw">&lt;/br&gt;&lt;/br&gt;</span></span>
<span id="cb33-1025"><a href="#cb33-1025"></a></span>
<span id="cb33-1026"><a href="#cb33-1026"></a><span class="fu">### Tipo de resposta dada aos recursos em segunda instância</span></span>
<span id="cb33-1027"><a href="#cb33-1027"></a></span>
<span id="cb33-1028"><a href="#cb33-1028"></a><span class="in">```{r plot-tipo-resposta-2a-instancia}</span></span>
<span id="cb33-1029"><a href="#cb33-1029"></a><span class="fu">plot_tipo_resposta</span>(recursos_cgu, <span class="st">"Segunda Instância"</span>)</span>
<span id="cb33-1030"><a href="#cb33-1030"></a><span class="in">```</span></span>
<span id="cb33-1031"><a href="#cb33-1031"></a></span>
<span id="cb33-1032"><a href="#cb33-1032"></a><span class="kw">&lt;/br&gt;&lt;/br&gt;</span></span>
<span id="cb33-1033"><a href="#cb33-1033"></a></span>
<span id="cb33-1034"><a href="#cb33-1034"></a><span class="fu">### Tipo de resposta dada aos recursos para a CMRI</span></span>
<span id="cb33-1035"><a href="#cb33-1035"></a></span>
<span id="cb33-1036"><a href="#cb33-1036"></a><span class="in">```{r plot-tipo-resposta-cmri}</span></span>
<span id="cb33-1037"><a href="#cb33-1037"></a><span class="fu">plot_tipo_resposta</span>(recursos_cgu, <span class="st">"CMRI"</span>)</span>
<span id="cb33-1038"><a href="#cb33-1038"></a><span class="in">```</span></span>
<span id="cb33-1039"><a href="#cb33-1039"></a></span>
<span id="cb33-1040"><a href="#cb33-1040"></a><span class="kw">&lt;/br&gt;&lt;/br&gt;</span></span>
<span id="cb33-1041"><a href="#cb33-1041"></a></span>
<span id="cb33-1042"><a href="#cb33-1042"></a><span class="fu">### Tipo de resposta dada aos recursos para a CGU</span></span>
<span id="cb33-1043"><a href="#cb33-1043"></a></span>
<span id="cb33-1044"><a href="#cb33-1044"></a><span class="in">```{r plot-tipo-resposta-cgu}</span></span>
<span id="cb33-1045"><a href="#cb33-1045"></a><span class="fu">plot_tipo_resposta</span>(recursos_cgu, <span class="st">"CGU"</span>)</span>
<span id="cb33-1046"><a href="#cb33-1046"></a><span class="in">```</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



<script src="0-monitoramento_files\libs\quarto-html\zenscroll-min.js"></script></body></html>